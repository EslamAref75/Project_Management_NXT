module.exports=[795469,a=>{"use strict";var b=a.i(295394),c=a.i(301209),d=a.i(917710),e=a.i(38032),f=a.i(106409),g=a.i(857885);function h(a,b){let c=a.getFullYear()-b.getFullYear()||a.getMonth()-b.getMonth()||a.getDate()-b.getDate()||a.getHours()-b.getHours()||a.getMinutes()-b.getMinutes()||a.getSeconds()-b.getSeconds()||a.getMilliseconds()-b.getMilliseconds();return c<0?-1:c>0?1:c}var i=a.i(759968);function j({tasks:a,forecasts:j}){let k=a.filter(a=>"completed"!==a.status&&"cancelled"!==a.status&&j[a.id]&&a.dueDate).sort((a,b)=>{let c="high"===j[a.id].riskLevel?3:"medium"===j[a.id].riskLevel?2:1;return("high"===j[b.id].riskLevel?3:"medium"===j[b.id].riskLevel?2:1)-c||new Date(a.dueDate).getTime()-new Date(b.dueDate).getTime()}).slice(0,5);return 0===k.length?(0,b.jsxs)(c.Card,{children:[(0,b.jsxs)(c.CardHeader,{className:"pb-2",children:[(0,b.jsx)(c.CardTitle,{className:"text-lg",children:"Forecast Timeline"}),(0,b.jsx)(c.CardDescription,{children:"Predicted completion dates"})]}),(0,b.jsx)(c.CardContent,{children:(0,b.jsx)("div",{className:"text-center py-6 text-muted-foreground text-sm",children:"No active tasks with forecasts available."})})]}):(0,b.jsxs)(c.Card,{children:[(0,b.jsxs)(c.CardHeader,{className:"pb-2",children:[(0,b.jsx)(c.CardTitle,{className:"text-lg",children:"Forecast Timeline"}),(0,b.jsx)(c.CardDescription,{children:"Projected delays & risks"})]}),(0,b.jsx)(c.CardContent,{className:"space-y-6 pt-4",children:k.map(a=>{let c=j[a.id],k=new Date(a.dueDate),l=new Date(c.predictedDate),m=function(a,b,c){let[d,e]=(0,f.normalizeDates)(void 0,a,b),i=h(d,e),j=Math.abs((0,g.differenceInCalendarDays)(d,e));d.setDate(d.getDate()-i*j);let k=Number(h(d,e)===-i),l=i*(j-k);return 0===l?0:l}(l,k),n=m>0;return(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,b.jsx)("span",{className:"font-medium truncate max-w-[150px]",title:a.title,children:a.title}),(0,b.jsx)("div",{className:"flex items-center gap-2",children:n?(0,b.jsxs)(d.Badge,{variant:"destructive",className:"text-[10px] h-5 px-1.5",children:["+",m,"d Late"]}):(0,b.jsx)(d.Badge,{variant:"outline",className:"text-[10px] h-5 px-1.5 bg-green-500/10 text-green-600 border-green-200",children:"On Track"})})]}),(0,b.jsxs)("div",{className:"relative h-2 bg-muted rounded-full overflow-hidden w-full",children:[(0,b.jsx)("div",{className:"absolute left-0 top-0 bottom-0 w-full bg-muted"}),(0,b.jsx)(i.TooltipProvider,{children:(0,b.jsxs)(i.Tooltip,{children:[(0,b.jsx)(i.TooltipTrigger,{asChild:!0,children:(0,b.jsx)("div",{className:"absolute top-0 bottom-0 w-1 bg-black/30 z-10 cursor-help",style:{left:"60%"}})}),(0,b.jsx)(i.TooltipContent,{children:(0,b.jsxs)("p",{children:["Due: ",(0,e.format)(k,"MMM d")]})})]})}),(0,b.jsx)(i.TooltipProvider,{children:(0,b.jsxs)(i.Tooltip,{children:[(0,b.jsx)(i.TooltipTrigger,{asChild:!0,children:(0,b.jsx)("div",{className:`absolute top-0 bottom-0 w-full rounded-l-full transition-all ${n?"bg-red-500":"bg-green-500"}`,style:{width:n?"80%":"50%",opacity:.2}})}),(0,b.jsxs)(i.TooltipContent,{children:[(0,b.jsxs)("p",{children:["Predicted: ",(0,e.format)(l,"MMM d")]}),(0,b.jsx)("p",{className:"text-[10px] opacity-80",children:c.explanation})]})]})})]}),(0,b.jsxs)("div",{className:"flex justify-between text-[10px] text-muted-foreground",children:[(0,b.jsxs)("span",{children:["Due: ",(0,e.format)(k,"MMM d")]}),(0,b.jsxs)("span",{className:n?"text-red-600 font-medium":"text-green-600",children:["Pred: ",(0,e.format)(l,"MMM d")]})]})]},a.id)})})]})}a.s(["ForecastingTimeline",()=>j],795469)},439849,a=>{"use strict";var b=a.i(295394),c=a.i(917710),d=a.i(682600),e=a.i(646579),f=a.i(126124),g=a.i(638236),h=a.i(402260),i=a.i(289788),j=a.i(631375),k=a.i(486944),l=a.i(98668),m=a.i(514750),n=a.i(38032),o=a.i(443161),p=a.i(999392),q=a.i(34123),r=a.i(313954),s=a.i(991466),t=a.i(322695),u=a.i(724627),v=a.i(493892),w=a.i(424391),x=a.i(400770),y=a.i(344770),z=a.i(489158);function A({projectId:e,isOpen:f=!0,onClose:g}){let[h,i]=(0,r.useState)([]),[j,k]=(0,r.useState)(!0),m=(0,z.useRouter)(),n=(0,r.useRef)(new Set),p=(0,r.useRef)(!1),q=async()=>{try{let{getProjectNotificationPreferences:b}=await a.A(949786),c=await b(e);if(c.success&&c.preferences&&!c.preferences.soundEnabled)return;let d=new(window.AudioContext||window.webkitAudioContext),f=d.sampleRate,g=.25*f,h=d.createBuffer(1,g,f),i=h.getChannelData(0);for(let a=0;a<g;a++){let b=a/f,c=800+200*b/.25,d=Math.min(1,b/.05),e=Math.min(1,(.25-b)/.05),g=d*e;i[a]=Math.sin(2*Math.PI*c*b)*g*.3}let j=d.createBufferSource();j.buffer=h,j.connect(d.destination),j.start(0)}catch(a){}};(0,r.useEffect)(()=>{if(!f)return void k(!1);let a=!0,b=null,c=async()=>{if(a&&"visible"===document.visibilityState){p.current||k(!0);try{let b=await (0,v.getProjectNotifications)(e,{limit:15,offset:0});if(!a)return;if(b.success&&b.notifications){let a=b.notifications.filter(a=>!a.isRead&&!n.current.has(a.id));a.length>0&&(a.some(a=>a.soundRequired||a.isUrgent)||a.length>0)&&q();let c=b.notifications.sort((a,b)=>a.isUrgent&&!b.isUrgent?-1:!a.isUrgent&&b.isUrgent?1:a.requiresAcknowledgment&&!b.requiresAcknowledgment?-1:!a.requiresAcknowledgment&&b.requiresAcknowledgment?1:new Date(b.createdAt).getTime()-new Date(a.createdAt).getTime());n.current=new Set(b.notifications.map(a=>a.id)),i(c)}}catch(a){console.error("[ProjectNotifications] Failed to load notifications:",a)}finally{p.current||(k(!1),p.current=!0)}}},d=()=>{a&&(b=setTimeout(async()=>{await c(),d()},15e3))},g=()=>{"visible"===document.visibilityState&&c()};return c(),d(),document.addEventListener("visibilitychange",g),()=>{a=!1,b&&clearTimeout(b),document.removeEventListener("visibilitychange",g)}},[e,f]);let s=async a=>{(await (0,w.markProjectNotificationAsRead)(e,a)).success&&(i(b=>b.map(b=>b.id===a?{...b,isRead:!0}:b)),m.refresh())};return(0,b.jsxs)("div",{className:"flex flex-col",children:[(0,b.jsx)("div",{className:"p-4 border-b",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("h3",{className:"font-semibold",children:"Project Notifications (Debug)"}),(0,b.jsx)(o.default,{href:`/dashboard/projects/${e}/notifications`,onClick:g,children:(0,b.jsx)(d.Button,{variant:"ghost",size:"sm",children:"View All"})})]})}),(0,b.jsx)(u.ScrollArea,{className:"h-[400px]",children:j?(0,b.jsx)("div",{className:"p-4 text-center text-sm text-muted-foreground",children:"Loading..."}):0===h.length?(0,b.jsx)("div",{className:"p-4 text-center text-sm text-muted-foreground",children:"No notifications"}):(0,b.jsx)("div",{className:"divide-y",children:h.map(a=>{let f,h;return(0,b.jsx)("div",{className:`p-4 hover:bg-muted/50 transition-colors ${a.isUrgent?"bg-red-50 dark:bg-red-950/20 border-l-4 border-red-500":!a.isRead?"bg-blue-50/50":""}`,children:(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[a.isUrgent&&(0,b.jsx)(l.AlertTriangle,{className:"h-4 w-4 text-red-600 animate-pulse"}),(0,b.jsx)(c.Badge,{variant:a.isUrgent?"destructive":"outline",className:`text-xs ${a.isUrgent?"":(a=>{switch(a){case"task":return"bg-blue-100 text-blue-800";case"dependency":return"bg-orange-100 text-orange-800";case"today_task":return"bg-green-100 text-green-800";case"project_admin":return"bg-purple-100 text-purple-800";case"comment_mention":return"bg-indigo-100 text-indigo-800";default:return"bg-gray-100 text-gray-800"}})(a.type)}`,children:a.isUrgent?"ðŸš¨ URGENT":`${a.type} [${a.entityType}]`}),!a.isRead&&!a.isUrgent&&(0,b.jsx)("div",{className:"h-2 w-2 rounded-full bg-blue-500"}),a.requiresAcknowledgment&&!a.acknowledgedAt&&(0,b.jsx)(c.Badge,{variant:"outline",className:"text-xs border-yellow-500 text-yellow-700",children:"Requires Acknowledgment"})]}),(0,b.jsxs)("a",{href:(f="task"===a.entityType||"task"===a.type,h="comment_mention"===a.entityType||"comment_mention"===a.type,(f||h)&&a.entityId?`/dashboard/projects/${e}/tasks/${a.entityId}`:`/dashboard/projects/${e}/notifications`),onClick:()=>{a.isRead||s(a.id),g?.()},className:"block hover:bg-muted/50 rounded p-1",children:[(0,b.jsxs)("p",{className:"font-medium text-sm",children:[a.title," ",a.entityId?`(ID: ${a.entityId})`:"(No ID)"]}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:a.message})]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-2",children:(0,x.formatDistanceToNow)(new Date(a.createdAt),{addSuffix:!0})})]}),!a.isRead&&!a.requiresAcknowledgment&&(0,b.jsx)(d.Button,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:b=>{b.stopPropagation(),s(a.id)},children:(0,b.jsx)(y.Check,{className:"h-4 w-4"})}),a.requiresAcknowledgment&&!a.acknowledgedAt&&(0,b.jsx)(c.Badge,{variant:"outline",className:"text-xs border-red-500 text-red-700",children:"Action Required"})]})},a.id)})})})]})}function B({projectId:a}){let[e,f]=(0,r.useState)(0),[g,h]=(0,r.useState)(!1);return(0,r.useRef)(0),(0,r.useEffect)(()=>{},[a]),(0,b.jsxs)(t.Popover,{open:g,onOpenChange:h,children:[(0,b.jsx)(t.PopoverTrigger,{asChild:!0,children:(0,b.jsxs)(d.Button,{variant:"ghost",size:"icon",className:"relative",onClick:()=>h(!g),children:[(0,b.jsx)(s.Bell,{className:"h-5 w-5"}),e>0&&(0,b.jsx)(c.Badge,{variant:"destructive",className:"absolute -top-1 -right-1 h-5 w-5 flex items-center justify-center p-0 text-xs",children:e>99?"99+":e})]})}),(0,b.jsx)(t.PopoverContent,{className:"w-96 p-0",align:"end",children:(0,b.jsx)(A,{projectId:a,isOpen:g,onClose:()=>h(!1)})})]})}a.i(843962);var C=a.i(504440),D=a.i(205172);function E({project:a,stats:s,canEdit:t,canMarkUrgent:u=!1}){let[v,w]=(0,r.useState)(!1);return(0,b.jsxs)("div",{className:"border-b pb-4 pt-4 space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:a.name}),(0,b.jsx)(c.Badge,{className:{planned:"bg-gray-100 text-gray-800",active:"bg-green-100 text-green-800",on_hold:"bg-yellow-100 text-yellow-800",completed:"bg-blue-100 text-blue-800",cancelled:"bg-red-100 text-red-800"}[a.status]||"bg-gray-100 text-gray-800",children:a.status}),"urgent"===a.priority&&(0,b.jsx)(c.Badge,{variant:"destructive",className:"animate-pulse",children:"ðŸš¨ URGENT"}),"high"===a.priority&&(0,b.jsx)(c.Badge,{variant:"outline",className:"border-orange-500 text-orange-700",children:"High Priority"})]}),a.description&&(0,b.jsx)("p",{className:"text-muted-foreground max-w-3xl",children:a.description})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(B,{projectId:a.id}),t&&(0,b.jsxs)(d.Button,{variant:"outline",size:"sm",onClick:()=>w(!0),children:[(0,b.jsx)(f.Edit,{className:"h-4 w-4 mr-2"}),"Edit"]}),(0,b.jsxs)(p.DropdownMenu,{children:[(0,b.jsx)(p.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)(d.Button,{variant:"outline",size:"icon",children:(0,b.jsx)(i.MoreVertical,{className:"h-4 w-4"})})}),(0,b.jsxs)(p.DropdownMenuContent,{align:"end",children:[(0,b.jsx)(p.DropdownMenuItem,{asChild:!0,children:(0,b.jsxs)(o.default,{href:`/dashboard/projects/${a.id}/tasks/new`,children:[(0,b.jsx)(g.Plus,{className:"h-4 w-4 mr-2"}),"Add Task"]})}),(0,b.jsx)(p.DropdownMenuItem,{asChild:!0,children:(0,b.jsxs)(o.default,{href:`/dashboard/projects/${a.id}/activity`,children:[(0,b.jsx)(h.FileText,{className:"h-4 w-4 mr-2"}),"View Activity"]})}),(0,b.jsx)(p.DropdownMenuSeparator,{}),u&&"urgent"!==a.priority&&(0,b.jsx)(p.DropdownMenuItem,{asChild:!0,children:(0,b.jsx)(C.MarkUrgentDialog,{projectId:a.id,projectName:a.name,children:(0,b.jsxs)("div",{className:"flex items-center w-full",children:[(0,b.jsx)(l.AlertTriangle,{className:"h-4 w-4 mr-2"}),"Make Urgent"]})})}),u&&"urgent"===a.priority&&(0,b.jsx)(p.DropdownMenuItem,{asChild:!0,children:(0,b.jsx)(D.RemoveUrgentDialog,{projectId:a.id,projectName:a.name,children:(0,b.jsxs)("div",{className:"flex items-center w-full",children:[(0,b.jsx)(m.CheckCircle2,{className:"h-4 w-4 mr-2"}),"Remove Urgent"]})})}),(0,b.jsx)(p.DropdownMenuItem,{disabled:!0,children:"Archive Project"})]})]})]})]}),s.total>0&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Progress"}),(0,b.jsxs)("span",{className:"font-medium",children:[s.percentage,"%"]})]}),(0,b.jsx)(e.Progress,{value:s.percentage,className:"h-2"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-6 text-sm text-muted-foreground",children:[a.startDate&&(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(j.Calendar,{className:"h-4 w-4"}),(0,b.jsxs)("span",{children:[(0,n.format)(new Date(a.startDate),"MMM d, yyyy"),a.endDate&&` - ${(0,n.format)(new Date(a.endDate),"MMM d, yyyy")}`]})]}),a.projectManager&&(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(k.Users,{className:"h-4 w-4"}),(0,b.jsxs)("span",{children:["PM: ",a.projectManager.username]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)("span",{children:[s.total," tasks"]}),(0,b.jsx)("span",{children:"â€¢"}),(0,b.jsxs)("span",{children:[s.totalComp," completed"]})]})]}),t&&(0,b.jsx)(q.ProjectEditDialog,{project:{id:a.id,name:a.name,type:a.type,projectTypeId:a.projectTypeId||null,projectStatusId:a.projectStatusId||null,description:a.description||"",scope:a.scope||"",status:a.status,startDate:a.startDate,endDate:a.endDate},open:v,onOpenChange:w})]})}a.s(["ProjectHeader",()=>E],439849)},474322,a=>{"use strict";var b=a.i(295394),c=a.i(737399),d=a.i(301209),e=a.i(515790),f=a.i(646579),g=a.i(514750),h=a.i(107346),i=a.i(146886),j=a.i(631375),k=a.i(486944),l=a.i(339770),m=a.i(38032),n=a.i(443161),o=a.i(313954),p=a.i(567343),q=a.i(210731);function r({projectId:a}){let[c,d]=(0,o.useState)([]),[e,f]=(0,o.useState)(!0);return((0,o.useEffect)(()=>{!async function(){try{let b=await (0,p.getActivityLogs)({projectId:a,limit:10});b.success&&d(b.logs||[])}catch(a){console.error("Failed to load activities:",a)}finally{f(!1)}}()},[a]),e)?(0,b.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,b.jsx)(q.Loader2,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):0===c.length?(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"No recent activity"}):(0,b.jsx)("div",{className:"space-y-3",children:c.map(a=>(0,b.jsx)("div",{className:"flex items-start gap-3 p-3 border rounded-lg",children:(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"text-sm font-medium",children:a.actionSummary}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:[a.performedBy?.username||"Unknown"," â€¢"," ",(0,m.format)(new Date(a.createdAt),"MMM d, yyyy 'at' h:mm a")]})]})},a.id))})}var s=a.i(917710);function t({project:a,blockedTasks:c}){return 0===c.length?(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"No blocked tasks"}):(0,b.jsxs)("div",{className:"space-y-3",children:[c.slice(0,5).map(c=>{let d=c.dependencies?.filter(a=>"completed"!==a.dependsOnTask.status)||[];return(0,b.jsx)(n.default,{href:`/dashboard/projects/${a.id}/tasks/${c.id}`,className:"block p-3 border rounded-lg hover:bg-muted transition-colors",children:(0,b.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,b.jsx)(i.AlertCircle,{className:"h-4 w-4 text-yellow-600"}),(0,b.jsx)("span",{className:"font-medium",children:c.title})]}),d.length>0&&(0,b.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["Waiting for: ",d.map(a=>a.dependsOnTask.title).join(", ")]})]}),(0,b.jsx)(s.Badge,{variant:"outline",className:"text-yellow-600 border-yellow-600",children:"Blocked"})]})},c.id)}),c.length>5&&(0,b.jsxs)("p",{className:"text-xs text-muted-foreground text-center",children:["+",c.length-5," more blocked tasks"]})]})}function u({project:a,stats:c,users:o}){let p=a.tasks?.filter(a=>"waiting"===a.status||!!a.dependencies&&a.dependencies.length>0&&a.dependencies.some(a=>"completed"!==a.dependsOnTask.status))||[],q=a.tasks?.filter(a=>a.dueDate&&"completed"!==a.status).sort((a,b)=>new Date(a.dueDate).getTime()-new Date(b.dueDate).getTime()).slice(0,5)||[],s=new Map;return a.tasks?.forEach(a=>{a.assignees?.forEach(a=>{s.has(a.id)||s.set(a.id,a)})}),(0,b.jsxs)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:[(0,b.jsxs)(d.Card,{className:"md:col-span-2 lg:col-span-3",children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{children:"Project Summary"}),(0,b.jsx)(d.CardDescription,{children:"Overview of project status and progress"})]}),(0,b.jsxs)(d.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:c.total}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"Total Tasks"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-green-600",children:c.totalComp}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"Completed"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:c.totalInProgress}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"In Progress"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-yellow-600",children:p.length}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"Blocked"})]})]}),c.total>0&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Overall Progress"}),(0,b.jsxs)("span",{className:"font-medium",children:[c.percentage,"%"]})]}),(0,b.jsx)(f.Progress,{value:c.percentage,className:"h-2"})]})]})]},"overview-project-summary"),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsxs)(d.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(l.TrendingUp,{className:"h-5 w-5"}),"Task Statistics"]})}),(0,b.jsx)(d.CardContent,{className:"space-y-4",children:(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(g.CheckCircle2,{className:"h-4 w-4 text-green-600"}),(0,b.jsx)("span",{className:"text-sm",children:"Completed"})]}),(0,b.jsx)("span",{className:"font-semibold",children:c.totalComp})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(h.Clock,{className:"h-4 w-4 text-blue-600"}),(0,b.jsx)("span",{className:"text-sm",children:"In Progress"})]}),(0,b.jsx)("span",{className:"font-semibold",children:c.totalInProgress})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(i.AlertCircle,{className:"h-4 w-4 text-yellow-600"}),(0,b.jsx)("span",{className:"text-sm",children:"Blocked"})]}),(0,b.jsx)("span",{className:"font-semibold",children:p.length})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(h.Clock,{className:"h-4 w-4 text-gray-600"}),(0,b.jsx)("span",{className:"text-sm",children:"Pending"})]}),(0,b.jsx)("span",{className:"font-semibold",children:c.totalPending})]})]})})]},"overview-task-stats"),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsxs)(d.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(j.Calendar,{className:"h-5 w-5"}),"Upcoming Deadlines"]})}),(0,b.jsx)(d.CardContent,{children:0===q.length?(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"No upcoming deadlines"}):(0,b.jsx)("div",{className:"space-y-3",children:q.map((c,d)=>(0,b.jsx)(n.default,{href:`/dashboard/projects/${a.id}/tasks/${c.id}`,className:"block p-2 border rounded hover:bg-muted transition-colors",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-sm font-medium truncate",children:c.title}),(0,b.jsx)("span",{className:"text-xs text-muted-foreground",children:(0,m.format)(new Date(c.dueDate),"MMM d")})]})},`deadline-${c.id}-${d}`))})})]},"overview-upcoming-deadlines"),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsxs)(d.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(k.Users,{className:"h-5 w-5"}),"Team Members"]})}),(0,b.jsx)(d.CardContent,{children:0===s.size?(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"No members assigned"}):(0,b.jsx)("div",{className:"flex flex-wrap gap-2",children:Array.from(s.values()).map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center gap-2 p-2 border rounded",children:[(0,b.jsxs)(e.Avatar,{className:"h-8 w-8",children:[(0,b.jsx)(e.AvatarImage,{src:a.avatarUrl||void 0}),(0,b.jsx)(e.AvatarFallback,{children:a.username.substring(0,2).toUpperCase()})]}),(0,b.jsx)("span",{className:"text-sm",children:a.username})]},`assignee-${a.id}-${c}`))})})]},"overview-assigned-members"),(0,b.jsxs)(d.Card,{className:"md:col-span-2",children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsxs)(d.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(i.AlertCircle,{className:"h-5 w-5 text-yellow-600"}),"Blocked Tasks"]}),(0,b.jsx)(d.CardDescription,{children:"Tasks waiting for dependencies"})]}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)(t,{project:a,blockedTasks:p})})]},"overview-blocked-tasks"),(0,b.jsxs)(d.Card,{className:"md:col-span-2 lg:col-span-3",children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{children:"Recent Activity"}),(0,b.jsx)(d.CardDescription,{children:"Last 10 actions in this project"})]}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)(r,{projectId:a.id})})]},"overview-recent-activity")]})}var v=a.i(489158),w=a.i(920931),x=a.i(732378),y=a.i(214719),z=a.i(760335),A=a.i(682600),B=a.i(97155),C=a.i(167764),D=a.i(951564),E=a.i(395301);let F=(0,E.createServerReference)("402d88094f0d43ffbbdb2cc55981130389e939c098",E.callServer,void 0,E.findSourceMapURL,"createTask");var G=a.i(638236);function H({projectId:a,users:c=[]}){let[d,e]=(0,o.useState)(!1),[f,g]=(0,o.useState)(!1),h=(0,o.useRef)(null),i=(0,v.useRouter)();async function j(b){if(b.preventDefault(),g(!0),!h.current)return;let c=new FormData(h.current);c.append("projectId",a.toString());let d=[];h.current.querySelectorAll('input[name="assigneeIds"]:checked').forEach(a=>{d.push(parseInt(a.value))}),c.set("assigneeIds",JSON.stringify(d));try{console.log("Creating task with data:",Object.fromEntries(c.entries()));let a=await F(c);console.log("Task creation result:",a),a?.success?(h.current?.reset(),e(!1),i.refresh()):(console.error("Task creation failed:",a?.error,a?.details),alert(a?.error||a?.details||"Failed to create task"))}catch(a){console.error("Task creation error:",a),alert(a?.message||"An unexpected error occurred")}finally{g(!1)}}return(0,b.jsxs)(B.Dialog,{open:d,onOpenChange:e,children:[(0,b.jsx)(B.DialogTrigger,{asChild:!0,children:(0,b.jsxs)(A.Button,{children:[(0,b.jsx)(G.Plus,{className:"mr-2 h-4 w-4"}),"Add Task"]})}),(0,b.jsxs)(B.DialogContent,{className:"sm:max-w-[500px]",children:[(0,b.jsxs)(B.DialogHeader,{children:[(0,b.jsx)(B.DialogTitle,{children:"Create Task"}),(0,b.jsx)(B.DialogDescription,{children:"Add a new task to this project."})]}),(0,b.jsxs)("form",{onSubmit:j,ref:h,children:[(0,b.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(C.Label,{htmlFor:"title",children:"Title"}),(0,b.jsx)(w.Input,{id:"title",name:"title",required:!0,placeholder:"Task title"})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(C.Label,{htmlFor:"description",children:"Description"}),(0,b.jsx)(D.Textarea,{id:"description",name:"description",placeholder:"Describe the task..."})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(C.Label,{htmlFor:"priority",children:"Priority"}),(0,b.jsxs)("select",{id:"priority",name:"priority",defaultValue:"normal",className:"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",children:[(0,b.jsx)("option",{value:"low",children:"Low"}),(0,b.jsx)("option",{value:"normal",children:"Normal"}),(0,b.jsx)("option",{value:"high",children:"High"}),(0,b.jsx)("option",{value:"urgent",children:"Urgent"})]})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(C.Label,{htmlFor:"dueDate",children:"Due Date"}),(0,b.jsx)(w.Input,{type:"date",id:"dueDate",name:"dueDate"})]})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(C.Label,{children:"Assignees"}),(0,b.jsx)("div",{className:"border rounded-md p-2 max-h-[150px] overflow-y-auto space-y-2",children:c.length>0?c.map(a=>(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)("input",{type:"checkbox",id:`assignee-${a.id}`,name:"assigneeIds",value:a.id,className:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary",onChange:a=>{}}),(0,b.jsx)(C.Label,{htmlFor:`assignee-${a.id}`,className:"text-sm font-normal cursor-pointer",children:a.username})]},a.id)):(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"No users available"})})]})]}),(0,b.jsx)(B.DialogFooter,{children:(0,b.jsxs)(A.Button,{type:"submit",disabled:f,children:[f&&(0,b.jsx)(q.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Create Task"]})})]})]})]})}function I({project:a,users:c}){let f=(0,v.useSearchParams)(),[g,h]=(0,o.useState)(f.get("search")||""),[k,l]=(0,o.useState)(f.get("status")||"all"),[p,q]=(0,o.useState)(f.get("priority")||"all"),[r,t]=(0,o.useState)(f.get("assignee")||f.get("user")||"all");(0,o.useEffect)(()=>{let a=f.get("status"),b=f.get("priority"),c=f.get("assignee")||f.get("user");a&&l(a),b&&q(b),c&&t(c)},[f]);let u=a.tasks||[],A=u.filter(a=>(!g||!!a.title.toLowerCase().includes(g.toLowerCase()))&&("all"===k||a.status===k)&&("all"===p||a.priority===p)&&("all"===r||!!a.assignees?.some(a=>a.id===parseInt(r)))&&!0),B={pending:"bg-yellow-500/10 text-yellow-500 border-yellow-500/20",in_progress:"bg-blue-500/10 text-blue-500 border-blue-500/20",review:"bg-purple-500/10 text-purple-500 border-purple-500/20",completed:"bg-green-500/10 text-green-500 border-green-500/20",waiting:"bg-orange-500/10 text-orange-500 border-orange-500/20"},C={urgent:"bg-red-500/10 text-red-500 border-red-500/20",high:"bg-orange-500/10 text-orange-500 border-orange-500/20",normal:"bg-blue-500/10 text-blue-500 border-blue-500/20",low:"bg-gray-500/10 text-gray-500 border-gray-500/20"};return(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(d.CardTitle,{children:"Tasks"}),(0,b.jsxs)(d.CardDescription,{children:[A.length," of ",u.length," tasks"]})]}),(0,b.jsx)(H,{projectId:a.id,users:c})]})}),(0,b.jsxs)(d.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex flex-wrap gap-4",children:[(0,b.jsx)("div",{className:"flex-1 min-w-[200px]",children:(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(z.Search,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),(0,b.jsx)(w.Input,{placeholder:"Search tasks...",value:g,onChange:a=>h(a.target.value),className:"pl-8"})]})}),(0,b.jsx)("div",{children:(0,b.jsxs)(x.Select,{value:k,onValueChange:l,children:[(0,b.jsx)(x.SelectTrigger,{className:"w-[150px]",children:(0,b.jsx)(x.SelectValue,{placeholder:"Status"})}),(0,b.jsxs)(x.SelectContent,{children:[(0,b.jsx)(x.SelectItem,{value:"all",children:"All Status"}),(0,b.jsx)(x.SelectItem,{value:"pending",children:"Pending"}),(0,b.jsx)(x.SelectItem,{value:"in_progress",children:"In Progress"}),(0,b.jsx)(x.SelectItem,{value:"review",children:"Review"}),(0,b.jsx)(x.SelectItem,{value:"completed",children:"Completed"}),(0,b.jsx)(x.SelectItem,{value:"waiting",children:"Waiting"})]})]})}),(0,b.jsx)("div",{children:(0,b.jsxs)(x.Select,{value:p,onValueChange:q,children:[(0,b.jsx)(x.SelectTrigger,{className:"w-[150px]",children:(0,b.jsx)(x.SelectValue,{placeholder:"Priority"})}),(0,b.jsxs)(x.SelectContent,{children:[(0,b.jsx)(x.SelectItem,{value:"all",children:"All Priorities"}),(0,b.jsx)(x.SelectItem,{value:"urgent",children:"Urgent"}),(0,b.jsx)(x.SelectItem,{value:"high",children:"High"}),(0,b.jsx)(x.SelectItem,{value:"normal",children:"Normal"}),(0,b.jsx)(x.SelectItem,{value:"low",children:"Low"})]})]})}),(0,b.jsx)("div",{children:(0,b.jsxs)(x.Select,{value:r,onValueChange:t,children:[(0,b.jsx)(x.SelectTrigger,{className:"w-[150px]",children:(0,b.jsx)(x.SelectValue,{placeholder:"Assignee"})}),(0,b.jsxs)(x.SelectContent,{children:[(0,b.jsx)(x.SelectItem,{value:"all",children:"All Users"}),c.map(a=>(0,b.jsx)(x.SelectItem,{value:a.id.toString(),children:a.username},a.id))]})]})})]}),(0,b.jsx)("div",{className:"border rounded-lg",children:(0,b.jsxs)(y.Table,{children:[(0,b.jsx)(y.TableHeader,{children:(0,b.jsxs)(y.TableRow,{children:[(0,b.jsx)(y.TableHead,{children:"Task"}),(0,b.jsx)(y.TableHead,{children:"Assignee"}),(0,b.jsx)(y.TableHead,{children:"Status"}),(0,b.jsx)(y.TableHead,{children:"Priority"}),(0,b.jsx)(y.TableHead,{children:"Due Date"}),(0,b.jsx)(y.TableHead,{children:"Dependencies"})]})}),(0,b.jsx)(y.TableBody,{children:0===A.length?(0,b.jsx)(y.TableRow,{children:(0,b.jsx)(y.TableCell,{colSpan:6,className:"text-center py-8 text-muted-foreground",children:"No tasks found"})}):A.map(c=>{let d="waiting"===c.status||c.dependencies&&c.dependencies.some(a=>"completed"!==a.dependsOnTask.status);return(0,b.jsxs)(y.TableRow,{className:"cursor-pointer hover:bg-muted/50",children:[(0,b.jsx)(y.TableCell,{children:(0,b.jsx)(n.default,{href:`/dashboard/projects/${a.id}/tasks/${c.id}`,className:"font-medium hover:underline",children:c.title})}),(0,b.jsx)(y.TableCell,{children:(0,b.jsxs)("div",{className:"flex -space-x-2",children:[c.assignees&&Array.isArray(c.assignees)&&c.assignees.slice(0,3).map((a,d)=>(0,b.jsxs)(e.Avatar,{className:"h-6 w-6 border-2 border-background",children:[(0,b.jsx)(e.AvatarImage,{src:a.avatarUrl||void 0}),(0,b.jsx)(e.AvatarFallback,{className:"text-xs",children:a.username?.substring(0,2).toUpperCase()||"??"})]},`assignee-${c.id}-${a.id}-${d}`)),c.assignees&&Array.isArray(c.assignees)&&c.assignees.length>3&&(0,b.jsxs)("div",{className:"h-6 w-6 rounded-full bg-muted border-2 border-background flex items-center justify-center text-xs",children:["+",c.assignees.length-3]},`more-assignees-${c.id}`)]})}),(0,b.jsx)(y.TableCell,{children:(0,b.jsx)(s.Badge,{className:B[c.status]||"bg-gray-500/10 text-gray-500 border-gray-500/20",children:c.status})}),(0,b.jsx)(y.TableCell,{children:(0,b.jsx)(s.Badge,{className:C[c.priority]||"bg-gray-500/10 text-gray-500 border-gray-500/20",children:c.priority})}),(0,b.jsx)(y.TableCell,{children:c.dueDate?(0,b.jsxs)("div",{className:"flex items-center gap-1 text-sm",children:[(0,b.jsx)(j.Calendar,{className:"h-3 w-3"}),(0,m.format)(new Date(c.dueDate),"MMM d, yyyy")]}):(0,b.jsx)("span",{className:"text-muted-foreground text-sm",children:"â€”"})}),(0,b.jsx)(y.TableCell,{children:d?(0,b.jsx)(i.AlertCircle,{className:"h-4 w-4 text-yellow-600"}):(0,b.jsx)("span",{className:"text-muted-foreground",children:"â€”"})})]},c.id)})})]})})]})]})}let J=(0,a.i(48978).default)(async()=>{},{loadableGenerated:{modules:[522012]},ssr:!1});function K({project:a,users:c}){return(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(d.CardTitle,{children:"Kanban Board"}),(0,b.jsx)(d.CardDescription,{children:"Drag and drop tasks to update their status"})]}),(0,b.jsx)(A.Button,{asChild:!0,children:(0,b.jsxs)(n.default,{href:`/dashboard/projects/${a.id}/tasks/new`,children:[(0,b.jsx)(G.Plus,{className:"h-4 w-4 mr-2"}),"Add Task"]})})]})}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)(J,{project:a,users:c})})]})}function L({project:a,users:c}){let f=a.projectTeams||[],g=new Map;return f.forEach(a=>{a.team.teamLead&&g.set(a.team.teamLead.id,{...a.team.teamLead,role:"Team Lead",team:a.team.name}),a.team.members?.forEach(b=>{g.has(b.user.id)||g.set(b.user.id,{...b.user,role:b.role,team:a.team.name})})}),(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsxs)(d.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(k.Users,{className:"h-5 w-5"}),"Assigned Teams"]}),(0,b.jsx)(d.CardDescription,{children:"Teams working on this project"})]}),(0,b.jsx)(d.CardContent,{children:0===f.length?(0,b.jsxs)("div",{className:"text-center py-8 border border-dashed rounded-lg",children:[(0,b.jsx)(k.Users,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),(0,b.jsx)("p",{className:"text-muted-foreground mb-4",children:"No teams assigned"}),(0,b.jsxs)(A.Button,{variant:"outline",size:"sm",children:[(0,b.jsx)(G.Plus,{className:"h-4 w-4 mr-2"}),"Assign Team"]})]}):(0,b.jsx)("div",{className:"space-y-4",children:f.map(a=>(0,b.jsxs)("div",{className:"p-4 border rounded-lg",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-semibold",children:a.team.name}),a.team.description&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.team.description})]}),(0,b.jsxs)(s.Badge,{children:[a.team._count.members," members"]})]}),a.team.teamLead&&(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Lead:"}),(0,b.jsxs)(e.Avatar,{className:"h-6 w-6",children:[(0,b.jsx)(e.AvatarImage,{src:a.team.teamLead.avatarUrl||void 0}),(0,b.jsx)(e.AvatarFallback,{className:"text-xs",children:a.team.teamLead.username.substring(0,2).toUpperCase()})]}),(0,b.jsx)("span",{className:"text-sm",children:a.team.teamLead.username})]})]},a.id))})})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{children:"All Team Members"}),(0,b.jsx)(d.CardDescription,{children:"All members from assigned teams"})]}),(0,b.jsx)(d.CardContent,{children:0===g.size?(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"No team members"}):(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Array.from(g.values()).map(a=>(0,b.jsxs)("div",{className:"flex items-center gap-3 p-3 border rounded-lg",children:[(0,b.jsxs)(e.Avatar,{children:[(0,b.jsx)(e.AvatarImage,{src:a.avatarUrl||void 0}),(0,b.jsx)(e.AvatarFallback,{children:a.username.substring(0,2).toUpperCase()})]}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"font-medium",children:a.username}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:[a.role," â€¢ ",a.team]})]})]},a.id))})})]})]})}function M({project:a,users:c}){let[e,f]=(0,o.useState)("all"),[g,h]=(0,o.useState)([]),[i,k]=(0,o.useState)(!1);return(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(d.CardTitle,{children:"Today's Tasks"}),(0,b.jsx)(d.CardDescription,{children:"Daily focus tasks for this project"})]}),(0,b.jsx)(A.Button,{asChild:!0,children:(0,b.jsxs)(n.default,{href:"/dashboard/today-tasks-assignment",children:[(0,b.jsx)(G.Plus,{className:"h-4 w-4 mr-2"}),"Manage Today's Tasks"]})})]})}),(0,b.jsxs)(d.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsxs)(x.Select,{value:e,onValueChange:f,children:[(0,b.jsx)(x.SelectTrigger,{className:"w-[200px]",children:(0,b.jsx)(x.SelectValue,{placeholder:"Filter by user"})}),(0,b.jsxs)(x.SelectContent,{children:[(0,b.jsx)(x.SelectItem,{value:"all",children:"All Users"}),c.map(a=>(0,b.jsx)(x.SelectItem,{value:a.id.toString(),children:a.username},a.id))]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,b.jsx)(j.Calendar,{className:"h-4 w-4"}),(0,m.format)(new Date,"EEEE, MMMM d, yyyy")]})]}),(0,b.jsxs)("div",{className:"text-center py-12 border border-dashed rounded-lg",children:[(0,b.jsx)(j.Calendar,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Today's Tasks view for this project"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:'Use the "Manage Today\'s Tasks" button to assign tasks'})]})]})]})}var N=a.i(904509),O=a.i(149697),O=O,P=a.i(650260),Q=a.i(869872);let R=(0,E.createServerReference)("40c036377622299eab7c3fedd2f88987461f8f0471",E.callServer,void 0,E.findSourceMapURL,"uploadProjectFile"),S=(0,E.createServerReference)("400d0b446f3a38c15d257fe7d9046d0aa056070e15",E.callServer,void 0,E.findSourceMapURL,"getProjectAttachments"),T=(0,E.createServerReference)("60c92747f45f0a848c5a9d51dc879510962f79e0b1",E.callServer,void 0,E.findSourceMapURL,"deleteAttachment");var U=a.i(231721);function V({project:a}){let{data:c}=(0,U.useSession)(),[f,g]=(0,o.useState)([]),[h,i]=(0,o.useState)(!0),[j,k]=(0,o.useState)(!1),[l,n]=(0,o.useState)(!1),p=(0,o.useRef)(null),r=(0,v.useRouter)(),t=async()=>{i(!0);let b=await S(a.id);b.success&&g(b.attachments||[]),i(!1)};(0,o.useEffect)(()=>{t()},[a.id]);let u=async b=>{let c=b.target.files?.[0];if(!c)return;k(!0);let d=new FormData;d.append("file",c),d.append("projectId",a.id.toString());let e=await R(d);k(!1),e.success?(n(!1),p.current&&(p.current.value=""),r.refresh(),t()):alert(e.error||"Failed to upload file")},x=async b=>{if(!confirm("Are you sure you want to delete this file?"))return;let c=await T(b,a.id);c.success?(r.refresh(),t()):alert(c.error||"Failed to delete file")};return h?(0,b.jsx)(d.Card,{children:(0,b.jsx)(d.CardContent,{className:"pt-6",children:(0,b.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,b.jsx)(q.Loader2,{className:"h-6 w-6 animate-spin text-muted-foreground"})})})}):(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(d.CardTitle,{children:"Files & Attachments"}),(0,b.jsxs)(d.CardDescription,{children:[f.length," file(s) in this project"]})]}),(0,b.jsxs)(B.Dialog,{open:l,onOpenChange:n,children:[(0,b.jsx)(B.DialogTrigger,{asChild:!0,children:(0,b.jsxs)(A.Button,{variant:"outline",children:[(0,b.jsx)(N.Upload,{className:"h-4 w-4 mr-2"}),"Upload File"]})}),(0,b.jsxs)(B.DialogContent,{children:[(0,b.jsxs)(B.DialogHeader,{children:[(0,b.jsx)(B.DialogTitle,{children:"Upload File"}),(0,b.jsx)(B.DialogDescription,{children:"Upload a file to this project. Files can be attached to tasks or kept at the project level."})]}),(0,b.jsxs)("div",{className:"space-y-4 py-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:"Select File"}),(0,b.jsx)(w.Input,{ref:p,type:"file",onChange:u,disabled:j,className:"cursor-pointer"})]}),j&&(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,b.jsx)(q.Loader2,{className:"h-4 w-4 animate-spin"}),"Uploading..."]})]})]})]})]})}),(0,b.jsx)(d.CardContent,{children:0===f.length?(0,b.jsxs)("div",{className:"text-center py-12 border border-dashed rounded-lg",children:[(0,b.jsx)(O.default,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"No files attached"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:"Upload files to share documents, images, and other resources"})]}):(0,b.jsx)("div",{className:"space-y-3",children:f.map(a=>{var d,f;return(0,b.jsxs)("div",{className:"flex items-center gap-3 p-4 border rounded-lg hover:bg-muted/50 transition-colors",children:[(0,b.jsx)("div",{className:"flex-shrink-0",children:(d=a.fileType)?d.startsWith("image/")?(0,b.jsx)(O.default,{className:"h-5 w-5 text-blue-500"}):d.includes("pdf")?(0,b.jsx)(O.default,{className:"h-5 w-5 text-red-500"}):d.includes("word")||d.includes("document")?(0,b.jsx)(O.default,{className:"h-5 w-5 text-blue-600"}):(0,b.jsx)(O.default,{className:"h-5 w-5 text-muted-foreground"}):(0,b.jsx)(O.default,{className:"h-5 w-5 text-muted-foreground"})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,b.jsx)("p",{className:"font-medium truncate",children:a.fileName}),a.task&&(0,b.jsxs)(s.Badge,{variant:"outline",className:"text-xs",children:["Task: ",a.task.title]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3 text-xs text-muted-foreground",children:[(0,b.jsx)("span",{children:(f=a.fileSize)?f<1024?`${f} B`:f<1048576?`${(f/1024).toFixed(1)} KB`:`${(f/1048576).toFixed(1)} MB`:"Unknown size"}),(0,b.jsx)("span",{children:"â€¢"}),(0,b.jsx)("span",{children:(0,m.format)(new Date(a.uploadedAt),"MMM d, yyyy")}),(0,b.jsx)("span",{children:"â€¢"}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsxs)(e.Avatar,{className:"h-4 w-4",children:[(0,b.jsx)(e.AvatarImage,{src:a.uploader?.avatarUrl||void 0}),(0,b.jsx)(e.AvatarFallback,{className:"text-[8px]",children:a.uploader?.username?.substring(0,2).toUpperCase()||"??"})]}),(0,b.jsx)("span",{children:a.uploader?.username||"Unknown"})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(A.Button,{variant:"ghost",size:"sm",asChild:!0,children:(0,b.jsxs)("a",{href:a.fileUrl,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1",children:[(0,b.jsx)(P.Download,{className:"h-4 w-4"}),"Download"]})}),(a.uploadedById===parseInt(c?.user?.id||"0")||c?.user?.role==="admin")&&(0,b.jsx)(A.Button,{variant:"ghost",size:"sm",onClick:()=>x(a.id),className:"text-destructive hover:text-destructive",children:(0,b.jsx)(Q.Trash2,{className:"h-4 w-4"})})]})]},a.id)})})})]})}function W({project:a}){let{data:c}=(0,U.useSession)(),e=c?.user.role==="admin";return(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(d.CardTitle,{children:"Activity Log"}),(0,b.jsx)(d.CardDescription,{children:"All actions and changes in this project"})]}),e&&(0,b.jsxs)(A.Button,{variant:"outline",size:"sm",disabled:!0,children:[(0,b.jsx)(P.Download,{className:"h-4 w-4 mr-2"}),"Export"]})]})}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)(r,{projectId:a.id})})]})}var X=a.i(712318);function Y({project:a,stats:c}){let e=(a.tasks||[]).filter(a=>"waiting"===a.status||!!a.dependencies&&a.dependencies.length>0&&a.dependencies.some(a=>"completed"!==a.dependsOnTask.status)),f=c.total>0?c.totalComp/c.total*100:0;return(0,b.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsxs)(d.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(l.TrendingUp,{className:"h-5 w-5"}),"Task Completion Rate"]})}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)("div",{className:"space-y-4",children:(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"text-3xl font-bold",children:[f.toFixed(1),"%"]}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:[c.totalComp," of ",c.total," tasks completed"]})]})})})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsxs)(d.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(h.Clock,{className:"h-5 w-5"}),"Blocked Time Analysis"]})}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)("div",{className:"space-y-4",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-3xl font-bold",children:e.length}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Tasks currently blocked by dependencies"})]})})})]}),(0,b.jsxs)(d.Card,{className:"md:col-span-2",children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsxs)(d.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(X.BarChart3,{className:"h-5 w-5"}),"Project Reports"]}),(0,b.jsx)(d.CardDescription,{children:"Detailed analytics and insights"})]}),(0,b.jsx)(d.CardContent,{children:(0,b.jsxs)("div",{className:"text-center py-12 border border-dashed rounded-lg",children:[(0,b.jsx)(X.BarChart3,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Advanced reports coming soon"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:"Burn-down charts, user productivity, and dependency impact analysis"})]})})]})]})}function Z({project:a,users:d,stats:e}){let f=(0,v.useSearchParams)(),g=(0,v.useRouter)(),h=f.get("tab")||"overview";return(0,b.jsxs)(c.Tabs,{value:h,onValueChange:a=>{let b=new URLSearchParams(f.toString());b.set("tab",a),g.push(`?${b.toString()}`,{scroll:!1})},className:"space-y-6",children:[(0,b.jsxs)(c.TabsList,{className:"grid w-full grid-cols-4 lg:grid-cols-9",children:[(0,b.jsx)(c.TabsTrigger,{value:"overview",children:"Overview"}),(0,b.jsx)(c.TabsTrigger,{value:"tasks",children:"Tasks"}),(0,b.jsx)(c.TabsTrigger,{value:"board",children:"Board"}),(0,b.jsx)(c.TabsTrigger,{value:"team",children:"Team"}),(0,b.jsx)(c.TabsTrigger,{value:"todays-tasks",children:"Today's Tasks"}),(0,b.jsx)(c.TabsTrigger,{value:"files",children:"Files"}),(0,b.jsx)(c.TabsTrigger,{value:"activity",children:"Activity"}),(0,b.jsx)(c.TabsTrigger,{value:"reports",children:"Reports"})]}),(0,b.jsx)(c.TabsContent,{value:"overview",className:"space-y-6",children:(0,b.jsx)(u,{project:a,stats:e,users:d})}),(0,b.jsx)(c.TabsContent,{value:"tasks",className:"space-y-6",children:(0,b.jsx)(I,{project:a,users:d})}),(0,b.jsx)(c.TabsContent,{value:"board",className:"space-y-6",children:(0,b.jsx)(K,{project:a,users:d})}),(0,b.jsx)(c.TabsContent,{value:"team",className:"space-y-6",children:(0,b.jsx)(L,{project:a,users:d})}),(0,b.jsx)(c.TabsContent,{value:"todays-tasks",className:"space-y-6",children:(0,b.jsx)(M,{project:a,users:d})}),(0,b.jsx)(c.TabsContent,{value:"files",className:"space-y-6",children:(0,b.jsx)(V,{project:a})}),(0,b.jsx)(c.TabsContent,{value:"activity",className:"space-y-6",children:(0,b.jsx)(W,{project:a})}),(0,b.jsx)(c.TabsContent,{value:"reports",className:"space-y-6",children:(0,b.jsx)(Y,{project:a,stats:e})})]})}a.s(["ProjectTabs",()=>Z],474322)},248724,a=>{"use strict";var b=a.i(295394),c=a.i(98668),d=a.i(514750),e=a.i(917710),f=a.i(682600),g=a.i(301209),h=a.i(997643),i=a.i(395301);let j=(0,i.createServerReference)("406dc0bd8d7e9cdb49e1d05a07a97ade94458c58d0",i.callServer,void 0,i.findSourceMapURL,"hasAcknowledgedUrgent");var k=a.i(313954),l=a.i(489158),m=a.i(400770),n=a.i(210731);function o({project:a,userId:i}){let o=(0,l.useRouter)(),[p,q]=(0,k.useState)(!1),[r,s]=(0,k.useState)(!1),[t,u]=(0,k.useState)(!0);(0,k.useEffect)(()=>{!async function(){q(await j(a.id)),u(!1)}()},[a.id]);let v=async()=>{s(!0);try{let b=await (0,h.acknowledgeUrgentProject)(a.id);b.success?(q(!0),o.refresh()):alert(b.error||"Failed to acknowledge")}catch(a){console.error("Error acknowledging:",a),alert("Failed to acknowledge urgent project")}finally{s(!1)}};return"urgent"!==a.priority?null:t?(0,b.jsx)(g.Card,{className:"border-red-500 bg-red-50 dark:bg-red-950/20 mb-6",children:(0,b.jsxs)("div",{className:"p-4 flex items-center gap-3",children:[(0,b.jsx)(n.Loader2,{className:"h-5 w-5 animate-spin text-red-600"}),(0,b.jsx)("span",{className:"text-sm text-red-600",children:"Checking acknowledgment status..."})]})}):(0,b.jsx)(g.Card,{className:"border-red-500 bg-red-50 dark:bg-red-950/20 mb-6 animate-pulse",children:(0,b.jsx)("div",{className:"p-4",children:(0,b.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,b.jsxs)("div",{className:"flex items-start gap-3 flex-1",children:[(0,b.jsx)(c.AlertTriangle,{className:"h-6 w-6 text-red-600 dark:text-red-400 flex-shrink-0 mt-0.5"}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsx)(e.Badge,{variant:"destructive",className:"text-sm font-bold",children:"ðŸš¨ URGENT PROJECT"}),a.urgentMarkedAt&&(0,b.jsxs)("span",{className:"text-xs text-muted-foreground",children:["Marked ",(0,m.formatDistanceToNow)(new Date(a.urgentMarkedAt),{addSuffix:!0})]})]}),(0,b.jsx)("p",{className:"text-sm font-medium text-red-900 dark:text-red-100 mb-1",children:a.name}),a.urgentReason&&(0,b.jsxs)("p",{className:"text-sm text-red-800 dark:text-red-200 mb-2",children:[(0,b.jsx)("strong",{children:"Reason:"})," ",a.urgentReason]}),a.urgentMarkedBy&&(0,b.jsxs)("p",{className:"text-xs text-red-700 dark:text-red-300",children:["Marked urgent by: ",a.urgentMarkedBy.username]})]})]}),!p&&(0,b.jsx)(f.Button,{onClick:v,disabled:r,variant:"default",className:"bg-red-600 hover:bg-red-700 text-white flex-shrink-0",children:r?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(n.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Acknowledging..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(d.CheckCircle2,{className:"h-4 w-4 mr-2"}),"Acknowledge"]})}),p&&(0,b.jsxs)(e.Badge,{variant:"outline",className:"bg-green-50 text-green-700 border-green-300",children:[(0,b.jsx)(d.CheckCircle2,{className:"h-3 w-3 mr-1"}),"Acknowledged"]})]})})})}a.s(["UrgentProjectBanner",()=>o],248724)}];

//# sourceMappingURL=nxt_New%20folder_Project_Management_NXT_src_components_bcf073a6._.js.map