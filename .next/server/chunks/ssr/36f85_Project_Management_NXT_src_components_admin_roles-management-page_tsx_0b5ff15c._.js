module.exports=[919967,a=>{"use strict";var b=a.i(295394),c=a.i(313954),d=a.i(301209),e=a.i(682600),f=a.i(917710),g=a.i(638236),h=a.i(126124),i=a.i(869872),j=a.i(805851),j=j,k=a.i(486944),l=a.i(97155),m=a.i(920931),n=a.i(167764),o=a.i(951564),p=a.i(877103),q=a.i(724627),r=a.i(395301);let s=(0,r.createServerReference)("4040b6468aa9508d1d4802a99825a53e6c660decfe",r.callServer,void 0,r.findSourceMapURL,"createRole");var t=a.i(489158),u=a.i(210731),v=a.i(737399);function w({open:a,onOpenChange:d,permissions:f,permissionsGrouped:g}){let h=(0,t.useRouter)(),[i,j]=(0,c.useState)(!1),[k,r]=(0,c.useState)(""),[w,x]=(0,c.useState)(""),[y,z]=(0,c.useState)([]),A=async a=>{if(a.preventDefault(),!k.trim())return;j(!0);let b=new FormData;b.append("name",k),b.append("description",w),b.append("permissionIds",JSON.stringify(y));let c=await s(b);j(!1),c?.success?(r(""),x(""),z([]),d(!1),h.refresh()):alert(c?.error||"Failed to create role")};return(0,b.jsx)(l.Dialog,{open:a,onOpenChange:d,children:(0,b.jsx)(l.DialogContent,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:(0,b.jsxs)("form",{onSubmit:A,children:[(0,b.jsxs)(l.DialogHeader,{children:[(0,b.jsx)(l.DialogTitle,{children:"Create New Role"}),(0,b.jsx)(l.DialogDescription,{children:"Define a new role and assign permissions"})]}),(0,b.jsxs)("div",{className:"space-y-4 py-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(n.Label,{htmlFor:"name",children:"Role Name *"}),(0,b.jsx)(m.Input,{id:"name",value:k,onChange:a=>r(a.target.value),placeholder:"e.g., Content Manager",required:!0})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(n.Label,{htmlFor:"description",children:"Description"}),(0,b.jsx)(o.Textarea,{id:"description",value:w,onChange:a=>x(a.target.value),placeholder:"Describe the role's purpose and responsibilities",rows:3})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(n.Label,{children:"Permissions"}),(0,b.jsxs)(v.Tabs,{defaultValue:Object.keys(g)[0],className:"w-full",children:[(0,b.jsx)(v.TabsList,{className:"flex flex-wrap h-auto w-full justify-start gap-1 p-1",children:Object.keys(g).map(a=>(0,b.jsx)(v.TabsTrigger,{value:a,className:"flex-grow-0",children:a},a))}),Object.entries(g).map(([a,c])=>(0,b.jsx)(v.TabsContent,{value:a,className:"mt-4",children:(0,b.jsx)(q.ScrollArea,{className:"h-[300px] border rounded-lg p-4",children:(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4 pb-2 border-b",children:[(0,b.jsxs)("span",{className:"font-medium",children:[a," Permissions"]}),(0,b.jsx)(e.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>{let a;(a=c.map(a=>a.id)).every(a=>y.includes(a))?z(b=>b.filter(b=>!a.includes(b))):z(b=>[...new Set([...b,...a])])},children:c.every(a=>y.includes(a.id))?"Deselect All":"Select All"})]}),c.map(a=>(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(p.Checkbox,{id:`perm-${a.id}`,checked:y.includes(a.id),onCheckedChange:()=>{var b;return b=a.id,void z(a=>a.includes(b)?a.filter(a=>a!==b):[...a,b])}}),(0,b.jsx)("label",{htmlFor:`perm-${a.id}`,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 cursor-pointer flex-1",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("code",{className:"text-xs",children:a.key}),a.description&&(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:a.description})]})})]},a.id))]})})},a))]}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground mt-2",children:[y.length," permission(s) selected"]})]})]}),(0,b.jsxs)(l.DialogFooter,{children:[(0,b.jsx)(e.Button,{type:"button",variant:"outline",onClick:()=>d(!1),children:"Cancel"}),(0,b.jsxs)(e.Button,{type:"submit",disabled:i||!k.trim(),children:[i&&(0,b.jsx)(u.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Create Role"]})]})]})})})}let x=(0,r.createServerReference)("605a370aec7719011993943417a0dd46a68cd1b815",r.callServer,void 0,r.findSourceMapURL,"updateRole");function y({open:a,onOpenChange:d,role:f,permissions:g,permissionsGrouped:h}){let i=(0,t.useRouter)(),[j,k]=(0,c.useState)(!1),[r,s]=(0,c.useState)(""),[w,y]=(0,c.useState)(""),[z,A]=(0,c.useState)([]);(0,c.useEffect)(()=>{f&&(s(f.name||""),y(f.description||""),A(f.permissions?.map(a=>a.permissionId)||[]))},[f]);let B=async a=>{if(a.preventDefault(),!r.trim()||!f)return;k(!0);let b=new FormData;b.append("name",r),b.append("description",w),b.append("permissionIds",JSON.stringify(z));let c=await x(f.id,b);k(!1),c?.success?(d(!1),i.refresh()):alert(c?.error||"Failed to update role")};return f?(0,b.jsx)(l.Dialog,{open:a,onOpenChange:d,children:(0,b.jsx)(l.DialogContent,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:(0,b.jsxs)("form",{onSubmit:B,children:[(0,b.jsxs)(l.DialogHeader,{children:[(0,b.jsx)(l.DialogTitle,{children:"Edit Role"}),(0,b.jsx)(l.DialogDescription,{children:"Update role details and permissions"})]}),(0,b.jsxs)("div",{className:"space-y-4 py-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(n.Label,{htmlFor:"name",children:"Role Name *"}),(0,b.jsx)(m.Input,{id:"name",value:r,onChange:a=>s(a.target.value),placeholder:"e.g., Content Manager",required:!0,disabled:f.isSystemRole&&"System Admin"===f.name})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(n.Label,{htmlFor:"description",children:"Description"}),(0,b.jsx)(o.Textarea,{id:"description",value:w,onChange:a=>y(a.target.value),placeholder:"Describe the role's purpose and responsibilities",rows:3})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(n.Label,{children:"Permissions"}),(0,b.jsxs)(v.Tabs,{defaultValue:Object.keys(h)[0],className:"w-full",children:[(0,b.jsx)(v.TabsList,{className:"flex flex-wrap h-auto w-full justify-start gap-1 p-1",children:Object.keys(h).map(a=>(0,b.jsx)(v.TabsTrigger,{value:a,className:"flex-grow-0",children:a},a))}),Object.entries(h).map(([a,c])=>(0,b.jsx)(v.TabsContent,{value:a,className:"mt-4",children:(0,b.jsx)(q.ScrollArea,{className:"h-[300px] border rounded-lg p-4",children:(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4 pb-2 border-b",children:[(0,b.jsxs)("span",{className:"font-medium",children:[a," Permissions"]}),(0,b.jsx)(e.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>{let a;(a=c.map(a=>a.id)).every(a=>z.includes(a))?A(b=>b.filter(b=>!a.includes(b))):A(b=>[...new Set([...b,...a])])},children:c.every(a=>z.includes(a.id))?"Deselect All":"Select All"})]}),c.map(a=>(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(p.Checkbox,{id:`perm-${a.id}`,checked:z.includes(a.id),onCheckedChange:()=>{var b;return b=a.id,void A(a=>a.includes(b)?a.filter(a=>a!==b):[...a,b])}}),(0,b.jsx)("label",{htmlFor:`perm-${a.id}`,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 cursor-pointer flex-1",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("code",{className:"text-xs",children:a.key}),a.description&&(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:a.description})]})})]},a.id))]})})},a))]}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground mt-2",children:[z.length," permission(s) selected"]})]})]}),(0,b.jsxs)(l.DialogFooter,{children:[(0,b.jsx)(e.Button,{type:"button",variant:"outline",onClick:()=>d(!1),children:"Cancel"}),(0,b.jsxs)(e.Button,{type:"submit",disabled:j||!r.trim(),children:[j&&(0,b.jsx)(u.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Update Role"]})]})]})})}):null}let z=(0,r.createServerReference)("40c034babb4ca926f97b6b4d48e79b952d57077416",r.callServer,void 0,r.findSourceMapURL,"deleteRole");var A=a.i(214719);function B({roles:a,permissions:l,permissionsGrouped:m}){let n=(0,t.useRouter)(),[o,p]=(0,c.useState)(!1),[q,r]=(0,c.useState)(!1),[s,u]=(0,c.useState)(null),v=async(a,b)=>{if(!confirm(`Are you sure you want to delete the role "${b}"? This action cannot be undone.`))return;let c=await z(a);c?.success?n.refresh():alert(c?.error||"Failed to delete role")};return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-lg font-semibold",children:"System Roles"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Manage roles and their assigned permissions"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)(e.Button,{onClick:()=>p(!0),children:[(0,b.jsx)(g.Plus,{className:"h-4 w-4 mr-2"}),"Create Role"]}),(0,b.jsx)(w,{open:o,onOpenChange:p,permissions:l,permissionsGrouped:m})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsxs)(d.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(j.default,{className:"h-5 w-5"}),"Roles"]}),(0,b.jsxs)(d.CardDescription,{children:[a.length," role(s) defined in the system"]})]}),(0,b.jsx)(d.CardContent,{children:0===a.length?(0,b.jsxs)("div",{className:"text-center py-8 border border-dashed rounded-lg",children:[(0,b.jsx)(j.default,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),(0,b.jsx)("p",{className:"text-muted-foreground mb-4",children:"No roles found"}),(0,b.jsxs)(e.Button,{onClick:()=>p(!0),children:[(0,b.jsx)(g.Plus,{className:"h-4 w-4 mr-2"}),"Create Role"]})]}):(0,b.jsxs)(A.Table,{children:[(0,b.jsx)(A.TableHeader,{children:(0,b.jsxs)(A.TableRow,{children:[(0,b.jsx)(A.TableHead,{children:"Role Name"}),(0,b.jsx)(A.TableHead,{children:"Description"}),(0,b.jsx)(A.TableHead,{children:"Type"}),(0,b.jsx)(A.TableHead,{children:"Permissions"}),(0,b.jsx)(A.TableHead,{children:"Users"}),(0,b.jsx)(A.TableHead,{className:"text-right",children:"Actions"})]})}),(0,b.jsx)(A.TableBody,{children:a.map(a=>(0,b.jsxs)(A.TableRow,{children:[(0,b.jsx)(A.TableCell,{className:"font-semibold",children:a.name}),(0,b.jsx)(A.TableCell,{className:"text-sm text-muted-foreground",children:a.description||"No description"}),(0,b.jsx)(A.TableCell,{children:(0,b.jsx)(f.Badge,{variant:a.isSystemRole?"default":"secondary",children:a.isSystemRole?"System":"Custom"})}),(0,b.jsx)(A.TableCell,{children:(0,b.jsxs)(f.Badge,{variant:"outline",children:[a._count?.permissions||0," permissions"]})}),(0,b.jsx)(A.TableCell,{children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(k.Users,{className:"h-4 w-4 text-muted-foreground"}),(0,b.jsx)("span",{children:a._count?.userRoles||0})]})}),(0,b.jsx)(A.TableCell,{className:"text-right",children:(0,b.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,b.jsx)(e.Button,{variant:"ghost",size:"icon",onClick:()=>{u(a),r(!0)},children:(0,b.jsx)(h.Edit,{className:"h-4 w-4"})}),!a.isSystemRole&&(0,b.jsx)(e.Button,{variant:"ghost",size:"icon",onClick:()=>v(a.id,a.name),children:(0,b.jsx)(i.Trash2,{className:"h-4 w-4 text-destructive"})})]})})]},a.id))})]})})]}),s&&(0,b.jsx)(y,{open:q,onOpenChange:r,role:s,permissions:l,permissionsGrouped:m})]})}a.s(["RolesManagementPage",()=>B],919967)}];

//# sourceMappingURL=36f85_Project_Management_NXT_src_components_admin_roles-management-page_tsx_0b5ff15c._.js.map