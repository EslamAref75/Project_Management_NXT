{"version":3,"sources":["../../../../../../../nxt/New%20folder/Project_Management_NXT/node_modules/date-fns/_lib/normalizeDates.js","../../../../../../../nxt/New%20folder/Project_Management_NXT/node_modules/date-fns/_lib/getTimezoneOffsetInMilliseconds.js","../../../../../../../nxt/New%20folder/Project_Management_NXT/node_modules/date-fns/differenceInCalendarDays.js","../../../../../../../nxt/New%20folder/Project_Management_NXT/node_modules/date-fns/isDate.js","../../../../../../../nxt/New%20folder/Project_Management_NXT/node_modules/date-fns/isValid.js","../../../../../../../nxt/New%20folder/Project_Management_NXT/src/lib/forecasting.ts","../../../../../../../nxt/New%20folder/Project_Management_NXT/node_modules/date-fns/addBusinessDays.js","../../../../../../../nxt/New%20folder/Project_Management_NXT/node_modules/date-fns/isSaturday.js","../../../../../../../nxt/New%20folder/Project_Management_NXT/node_modules/date-fns/isSunday.js","../../../../../../../nxt/New%20folder/Project_Management_NXT/node_modules/date-fns/isWeekend.js","../../../../../../../nxt/New%20folder/Project_Management_NXT/node_modules/date-fns/differenceInBusinessDays.js","../../../../../../../nxt/New%20folder/Project_Management_NXT/node_modules/date-fns/isSameDay.js","../../../../../../../nxt/New%20folder/Project_Management_NXT/src/app/actions/forecasting.ts","../../../../../../../nxt/New%20folder/Project_Management_NXT/src/app/actions/project-priority.ts","../../../../../../../nxt/New%20folder/Project_Management_NXT/src/lib/file-upload-validator.ts","../../../../../../../nxt/New%20folder/Project_Management_NXT/src/app/actions/activity-logs.ts","../../../../../../../nxt/New%20folder/Project_Management_NXT/.next-internal/server/app/dashboard/projects/%5Bid%5D/page/actions.js%20%28server%20actions%20loader%29","../../../../../../../nxt/New%20folder/Project_Management_NXT/src/app/actions/attachments.ts"],"sourcesContent":["import { constructFrom } from \"../constructFrom.js\";\n\nexport function normalizeDates(context, ...dates) {\n  const normalize = constructFrom.bind(\n    null,\n    context || dates.find((date) => typeof date === \"object\"),\n  );\n  return dates.map(normalize);\n}\n","import { toDate } from \"../toDate.js\";\n\n/**\n * Google Chrome as of 67.0.3396.87 introduced timezones with offset that includes seconds.\n * They usually appear for dates that denote time before the timezones were introduced\n * (e.g. for 'Europe/Prague' timezone the offset is GMT+00:57:44 before 1 October 1891\n * and GMT+01:00:00 after that date)\n *\n * Date#getTimezoneOffset returns the offset in minutes and would return 57 for the example above,\n * which would lead to incorrect calculations.\n *\n * This function returns the timezone offset in milliseconds that takes seconds in account.\n */\nexport function getTimezoneOffsetInMilliseconds(date) {\n  const _date = toDate(date);\n  const utcDate = new Date(\n    Date.UTC(\n      _date.getFullYear(),\n      _date.getMonth(),\n      _date.getDate(),\n      _date.getHours(),\n      _date.getMinutes(),\n      _date.getSeconds(),\n      _date.getMilliseconds(),\n    ),\n  );\n  utcDate.setUTCFullYear(_date.getFullYear());\n  return +date - +utcDate;\n}\n","import { getTimezoneOffsetInMilliseconds } from \"./_lib/getTimezoneOffsetInMilliseconds.js\";\nimport { normalizeDates } from \"./_lib/normalizeDates.js\";\nimport { millisecondsInDay } from \"./constants.js\";\nimport { startOfDay } from \"./startOfDay.js\";\n\n/**\n * The {@link differenceInCalendarDays} function options.\n */\n\n/**\n * @name differenceInCalendarDays\n * @category Day Helpers\n * @summary Get the number of calendar days between the given dates.\n *\n * @description\n * Get the number of calendar days between the given dates. This means that the times are removed\n * from the dates and then the difference in days is calculated.\n *\n * @param laterDate - The later date\n * @param earlierDate - The earlier date\n * @param options - The options object\n *\n * @returns The number of calendar days\n *\n * @example\n * // How many calendar days are between\n * // 2 July 2011 23:00:00 and 2 July 2012 00:00:00?\n * const result = differenceInCalendarDays(\n *   new Date(2012, 6, 2, 0, 0),\n *   new Date(2011, 6, 2, 23, 0)\n * )\n * //=> 366\n * // How many calendar days are between\n * // 2 July 2011 23:59:00 and 3 July 2011 00:01:00?\n * const result = differenceInCalendarDays(\n *   new Date(2011, 6, 3, 0, 1),\n *   new Date(2011, 6, 2, 23, 59)\n * )\n * //=> 1\n */\nexport function differenceInCalendarDays(laterDate, earlierDate, options) {\n  const [laterDate_, earlierDate_] = normalizeDates(\n    options?.in,\n    laterDate,\n    earlierDate,\n  );\n\n  const laterStartOfDay = startOfDay(laterDate_);\n  const earlierStartOfDay = startOfDay(earlierDate_);\n\n  const laterTimestamp =\n    +laterStartOfDay - getTimezoneOffsetInMilliseconds(laterStartOfDay);\n  const earlierTimestamp =\n    +earlierStartOfDay - getTimezoneOffsetInMilliseconds(earlierStartOfDay);\n\n  // Round the number of days to the nearest integer because the number of\n  // milliseconds in a day is not constant (e.g. it's different in the week of\n  // the daylight saving time clock shift).\n  return Math.round((laterTimestamp - earlierTimestamp) / millisecondsInDay);\n}\n\n// Fallback for modularized imports:\nexport default differenceInCalendarDays;\n","/**\n * @name isDate\n * @category Common Helpers\n * @summary Is the given value a date?\n *\n * @description\n * Returns true if the given value is an instance of Date. The function works for dates transferred across iframes.\n *\n * @param value - The value to check\n *\n * @returns True if the given value is a date\n *\n * @example\n * // For a valid date:\n * const result = isDate(new Date())\n * //=> true\n *\n * @example\n * // For an invalid date:\n * const result = isDate(new Date(NaN))\n * //=> true\n *\n * @example\n * // For some value:\n * const result = isDate('2014-02-31')\n * //=> false\n *\n * @example\n * // For an object:\n * const result = isDate({})\n * //=> false\n */\nexport function isDate(value) {\n  return (\n    value instanceof Date ||\n    (typeof value === \"object\" &&\n      Object.prototype.toString.call(value) === \"[object Date]\")\n  );\n}\n\n// Fallback for modularized imports:\nexport default isDate;\n","import { isDate } from \"./isDate.js\";\nimport { toDate } from \"./toDate.js\";\n\n/**\n * @name isValid\n * @category Common Helpers\n * @summary Is the given date valid?\n *\n * @description\n * Returns false if argument is Invalid Date and true otherwise.\n * Argument is converted to Date using `toDate`. See [toDate](https://date-fns.org/docs/toDate)\n * Invalid Date is a Date, whose time value is NaN.\n *\n * Time value of Date: http://es5.github.io/#x15.9.1.1\n *\n * @param date - The date to check\n *\n * @returns The date is valid\n *\n * @example\n * // For the valid date:\n * const result = isValid(new Date(2014, 1, 31))\n * //=> true\n *\n * @example\n * // For the value, convertible into a date:\n * const result = isValid(1393804800000)\n * //=> true\n *\n * @example\n * // For the invalid date:\n * const result = isValid(new Date(''))\n * //=> false\n */\nexport function isValid(date) {\n  return !((!isDate(date) && typeof date !== \"number\") || isNaN(+toDate(date)));\n}\n\n// Fallback for modularized imports:\nexport default isValid;\n","import { prisma } from \"@/lib/prisma\";\r\nimport { addBusinessDays, differenceInBusinessDays, addDays } from \"date-fns\";\r\n\r\nexport async function predictTaskCompletion(taskId: number) {\r\n    const task = await prisma.task.findUnique({\r\n        where: { id: taskId },\r\n        include: {\r\n            assignees: { select: { id: true } },\r\n            dependencies: { include: { dependsOnTask: true } }\r\n        }\r\n    });\r\n\r\n    if (!task) return null;\r\n\r\n    // RULE 1: Historical Velocity\r\n    // Calculate average metrics for the assignees\r\n    const avgDailyVelocity = 0; // Tasks per day\r\n    const totalCompleted = 0;\r\n\r\n    // Default to 1 task/day if no history (or 1 / estimatedHours if available)\r\n    let defaultTime = task.estimatedHours > 0 ? task.estimatedHours / 8 : 1; // Days\r\n\r\n    if (task.assignees.length > 0) {\r\n        // Simple velocity: Look at last 10 completed tasks\r\n        const recentTasks = await prisma.task.findMany({\r\n            where: {\r\n                assignees: { some: { id: { in: task.assignees.map(a => a.id) } } },\r\n                status: 'completed',\r\n                completedAt: { not: null }\r\n            },\r\n            take: 10,\r\n            orderBy: { completedAt: 'desc' },\r\n            select: { estimatedHours: true, actualHours: true, createdAt: true, completedAt: true }\r\n        });\r\n\r\n        if (recentTasks.length > 0) {\r\n            // Calculate a \"Pessimism Factor\": Actual / Estimated\r\n            // e.g. Est 4h, Act 6h => 1.5 factor\r\n            let totalFactor = 0;\r\n            let validSamples = 0;\r\n\r\n            recentTasks.forEach(t => {\r\n                if (t.estimatedHours > 0 && t.actualHours > 0) {\r\n                    totalFactor += (t.actualHours / t.estimatedHours);\r\n                    validSamples++;\r\n                }\r\n            });\r\n\r\n            const assigneeFactor = validSamples > 0 ? (totalFactor / validSamples) : 1.2; // Default 1.2 if no estimates\r\n\r\n            // Adjust estimated time by this factor\r\n            if (task.estimatedHours > 0) {\r\n                defaultTime = (task.estimatedHours * assigneeFactor) / 8; // Convert hours to workdays (8h/day)\r\n            }\r\n        }\r\n    }\r\n\r\n    // RULE 2: Dependency Delays\r\n    // If blocked, start date is NOT now. Start date is max(dependency completion).\r\n    let estimatedStartDate = new Date();\r\n    let dependencyRisk = false;\r\n\r\n    if (task.dependencies.length > 0) {\r\n        let maxDependencyEnd = new Date();\r\n        for (const dep of task.dependencies) {\r\n            const dt = dep.dependsOnTask;\r\n            if (dt.status !== 'completed' && !dt.taskStatusId) { // simple check\r\n                // If dependency is not done, when will IT be done?\r\n                // For recursion, we would predict that too. For Phase 1, assume dependency due date or today + 1\r\n                const depDate = dt.dueDate ? new Date(dt.dueDate) : addDays(new Date(), 1);\r\n                if (depDate > maxDependencyEnd) maxDependencyEnd = depDate;\r\n                dependencyRisk = true;\r\n            }\r\n        }\r\n        if (maxDependencyEnd > estimatedStartDate) {\r\n            estimatedStartDate = maxDependencyEnd;\r\n        }\r\n    }\r\n\r\n    const predictedDate = addBusinessDays(estimatedStartDate, Math.ceil(defaultTime));\r\n\r\n    // Confidence & Explanation\r\n    let confidence = 85;\r\n    const reasons: string[] = [];\r\n\r\n    if (dependencyRisk) {\r\n        confidence -= 15;\r\n        reasons.push(\"Dependent on incomplete tasks\");\r\n    }\r\n\r\n    if (task.dueDate && predictedDate > task.dueDate) {\r\n        reasons.push(\"Historical velocity suggests delay\");\r\n    }\r\n\r\n    if (task.assignees.length === 0) {\r\n        confidence -= 20;\r\n        reasons.push(\"No assignee to gauge velocity\");\r\n    }\r\n\r\n    let riskLevel = \"low\";\r\n    if (task.dueDate && predictedDate > task.dueDate) {\r\n        const delayDays = differenceInBusinessDays(predictedDate, task.dueDate);\r\n        if (delayDays > 2) riskLevel = \"high\";\r\n        else riskLevel = \"medium\";\r\n    }\r\n\r\n    return {\r\n        taskId,\r\n        predictedDate,\r\n        riskLevel,\r\n        confidence,\r\n        explanation: reasons.join(\", \") || \"Based on average team velocity\"\r\n    };\r\n}\r\n","import { constructFrom } from \"./constructFrom.js\";\nimport { isSaturday } from \"./isSaturday.js\";\nimport { isSunday } from \"./isSunday.js\";\nimport { isWeekend } from \"./isWeekend.js\";\nimport { toDate } from \"./toDate.js\";\n\n/**\n * The {@link addBusinessDays} function options.\n */\n\n/**\n * @name addBusinessDays\n * @category Day Helpers\n * @summary Add the specified number of business days (mon - fri) to the given date.\n *\n * @description\n * Add the specified number of business days (mon - fri) to the given date, ignoring weekends.\n *\n * @typeParam DateType - The `Date` type, the function operates on. Gets inferred from passed arguments. Allows to use extensions like [`UTCDate`](https://github.com/date-fns/utc).\n * @typeParam ResultDate - The result `Date` type, it is the type returned from the context function if it is passed, or inferred from the arguments.\n *\n * @param date - The date to be changed\n * @param amount - The amount of business days to be added.\n * @param options - An object with options\n *\n * @returns The new date with the business days added\n *\n * @example\n * // Add 10 business days to 1 September 2014:\n * const result = addBusinessDays(new Date(2014, 8, 1), 10)\n * //=> Mon Sep 15 2014 00:00:00 (skipped weekend days)\n */\nexport function addBusinessDays(date, amount, options) {\n  const _date = toDate(date, options?.in);\n  const startedOnWeekend = isWeekend(_date, options);\n\n  if (isNaN(amount)) return constructFrom(options?.in, NaN);\n\n  const hours = _date.getHours();\n  const sign = amount < 0 ? -1 : 1;\n  const fullWeeks = Math.trunc(amount / 5);\n\n  _date.setDate(_date.getDate() + fullWeeks * 7);\n\n  // Get remaining days not part of a full week\n  let restDays = Math.abs(amount % 5);\n\n  // Loops over remaining days\n  while (restDays > 0) {\n    _date.setDate(_date.getDate() + sign);\n    if (!isWeekend(_date, options)) restDays -= 1;\n  }\n\n  // If the date is a weekend day and we reduce a dividable of\n  // 5 from it, we land on a weekend date.\n  // To counter this, we add days accordingly to land on the next business day\n  if (startedOnWeekend && isWeekend(_date, options) && amount !== 0) {\n    // If we're reducing days, we want to add days until we land on a weekday\n    // If we're adding days we want to reduce days until we land on a weekday\n    if (isSaturday(_date, options))\n      _date.setDate(_date.getDate() + (sign < 0 ? 2 : -1));\n    if (isSunday(_date, options))\n      _date.setDate(_date.getDate() + (sign < 0 ? 1 : -2));\n  }\n\n  // Restore hours to avoid DST lag\n  _date.setHours(hours);\n\n  return _date;\n}\n\n// Fallback for modularized imports:\nexport default addBusinessDays;\n","import { toDate } from \"./toDate.js\";\n\n/**\n * The {@link isSaturday} function options.\n */\n\n/**\n * @name isSaturday\n * @category Weekday Helpers\n * @summary Is the given date Saturday?\n *\n * @description\n * Is the given date Saturday?\n *\n * @param date - The date to check\n * @param options - An object with options\n *\n * @returns The date is Saturday\n *\n * @example\n * // Is 27 September 2014 Saturday?\n * const result = isSaturday(new Date(2014, 8, 27))\n * //=> true\n */\nexport function isSaturday(date, options) {\n  return toDate(date, options?.in).getDay() === 6;\n}\n\n// Fallback for modularized imports:\nexport default isSaturday;\n","import { toDate } from \"./toDate.js\";\n\n/**\n * The {@link isSunday} function options.\n */\n\n/**\n * @name isSunday\n * @category Weekday Helpers\n * @summary Is the given date Sunday?\n *\n * @description\n * Is the given date Sunday?\n *\n * @param date - The date to check\n * @param options - The options object\n *\n * @returns The date is Sunday\n *\n * @example\n * // Is 21 September 2014 Sunday?\n * const result = isSunday(new Date(2014, 8, 21))\n * //=> true\n */\nexport function isSunday(date, options) {\n  return toDate(date, options?.in).getDay() === 0;\n}\n\n// Fallback for modularized imports:\nexport default isSunday;\n","import { toDate } from \"./toDate.js\";\n\n/**\n * The {@link isWeekend} function options.\n */\n\n/**\n * @name isWeekend\n * @category Weekday Helpers\n * @summary Does the given date fall on a weekend?\n *\n * @description\n * Does the given date fall on a weekend? A weekend is either Saturday (`6`) or Sunday (`0`).\n *\n * @param date - The date to check\n * @param options - An object with options\n *\n * @returns The date falls on a weekend\n *\n * @example\n * // Does 5 October 2014 fall on a weekend?\n * const result = isWeekend(new Date(2014, 9, 5))\n * //=> true\n */\nexport function isWeekend(date, options) {\n  const day = toDate(date, options?.in).getDay();\n  return day === 0 || day === 6;\n}\n\n// Fallback for modularized imports:\nexport default isWeekend;\n","import { normalizeDates } from \"./_lib/normalizeDates.js\";\nimport { addDays } from \"./addDays.js\";\nimport { differenceInCalendarDays } from \"./differenceInCalendarDays.js\";\nimport { isSameDay } from \"./isSameDay.js\";\nimport { isValid } from \"./isValid.js\";\nimport { isWeekend } from \"./isWeekend.js\";\n\n/**\n * The {@link differenceInBusinessDays} function options.\n */\n\n/**\n * @name differenceInBusinessDays\n * @category Day Helpers\n * @summary Get the number of business days between the given dates.\n *\n * @description\n * Get the number of business day periods between the given dates.\n * Business days being days that aren't in the weekend.\n * Like `differenceInCalendarDays`, the function removes the times from\n * the dates before calculating the difference.\n *\n * @param laterDate - The later date\n * @param earlierDate - The earlier date\n * @param options - An object with options\n *\n * @returns The number of business days\n *\n * @example\n * // How many business days are between\n * // 10 January 2014 and 20 July 2014?\n * const result = differenceInBusinessDays(\n *   new Date(2014, 6, 20),\n *   new Date(2014, 0, 10)\n * )\n * //=> 136\n *\n * // How many business days are between\n * // 30 November 2021 and 1 November 2021?\n * const result = differenceInBusinessDays(\n *   new Date(2021, 10, 30),\n *   new Date(2021, 10, 1)\n * )\n * //=> 21\n *\n * // How many business days are between\n * // 1 November 2021 and 1 December 2021?\n * const result = differenceInBusinessDays(\n *   new Date(2021, 10, 1),\n *   new Date(2021, 11, 1)\n * )\n * //=> -22\n *\n * // How many business days are between\n * // 1 November 2021 and 1 November 2021 ?\n * const result = differenceInBusinessDays(\n *   new Date(2021, 10, 1),\n *   new Date(2021, 10, 1)\n * )\n * //=> 0\n */\nexport function differenceInBusinessDays(laterDate, earlierDate, options) {\n  const [laterDate_, earlierDate_] = normalizeDates(\n    options?.in,\n    laterDate,\n    earlierDate,\n  );\n\n  if (!isValid(laterDate_) || !isValid(earlierDate_)) return NaN;\n\n  const diff = differenceInCalendarDays(laterDate_, earlierDate_);\n  const sign = diff < 0 ? -1 : 1;\n  const weeks = Math.trunc(diff / 7);\n\n  let result = weeks * 5;\n  let movingDate = addDays(earlierDate_, weeks * 7);\n\n  // the loop below will run at most 6 times to account for the remaining days that don't makeup a full week\n  while (!isSameDay(laterDate_, movingDate)) {\n    // sign is used to account for both negative and positive differences\n    result += isWeekend(movingDate, options) ? 0 : sign;\n    movingDate = addDays(movingDate, sign);\n  }\n\n  // Prevent negative zero\n  return result === 0 ? 0 : result;\n}\n\n// Fallback for modularized imports:\nexport default differenceInBusinessDays;\n","import { normalizeDates } from \"./_lib/normalizeDates.js\";\nimport { startOfDay } from \"./startOfDay.js\";\n\n/**\n * The {@link isSameDay} function options.\n */\n\n/**\n * @name isSameDay\n * @category Day Helpers\n * @summary Are the given dates in the same day (and year and month)?\n *\n * @description\n * Are the given dates in the same day (and year and month)?\n *\n * @param laterDate - The first date to check\n * @param earlierDate - The second date to check\n * @param options - An object with options\n *\n * @returns The dates are in the same day (and year and month)\n *\n * @example\n * // Are 4 September 06:00:00 and 4 September 18:00:00 in the same day?\n * const result = isSameDay(new Date(2014, 8, 4, 6, 0), new Date(2014, 8, 4, 18, 0))\n * //=> true\n *\n * @example\n * // Are 4 September and 4 October in the same day?\n * const result = isSameDay(new Date(2014, 8, 4), new Date(2014, 9, 4))\n * //=> false\n *\n * @example\n * // Are 4 September, 2014 and 4 September, 2015 in the same day?\n * const result = isSameDay(new Date(2014, 8, 4), new Date(2015, 8, 4))\n * //=> false\n */\nexport function isSameDay(laterDate, earlierDate, options) {\n  const [dateLeft_, dateRight_] = normalizeDates(\n    options?.in,\n    laterDate,\n    earlierDate,\n  );\n  return +startOfDay(dateLeft_) === +startOfDay(dateRight_);\n}\n\n// Fallback for modularized imports:\nexport default isSameDay;\n","\"use server\";\r\n\r\nimport { predictTaskCompletion } from \"@/lib/forecasting\";\r\nimport { getServerSession } from \"next-auth\";\r\nimport { authOptions } from \"@/lib/auth\";\r\n\r\nexport async function getForecastsForTasks(taskIds: number[]) {\r\n    const session = await getServerSession(authOptions);\r\n    if (!session) return { error: \"Unauthorized\" };\r\n\r\n    try {\r\n        const forecasts = await Promise.all(\r\n            taskIds.map(async (id) => {\r\n                const prediction = await predictTaskCompletion(id);\r\n                return { taskId: id, prediction };\r\n            })\r\n        );\r\n\r\n        // Convert to map for easier lookup\r\n        const forecastMap: Record<number, any> = {};\r\n        forecasts.forEach(f => {\r\n            forecastMap[f.taskId] = f.prediction;\r\n        });\r\n\r\n        return { success: true, data: forecastMap };\r\n    } catch (e) {\r\n        console.error(\"Failed to get forecasts\", e);\r\n        return { error: \"Failed to load forecasts\" };\r\n    }\r\n}\r\n","\"use server\"\r\n\r\nimport { prisma } from \"@/lib/prisma\"\r\nimport { getServerSession } from \"next-auth\"\r\nimport { authOptions } from \"@/lib/auth\"\r\nimport { revalidatePath } from \"next/cache\"\r\nimport { logActivity } from \"@/lib/activity-logger\"\r\nimport { createProjectNotification } from \"./project-notifications\"\r\nimport { z } from \"zod\"\r\nimport { hasPermissionWithoutRoleBypass } from \"@/lib/rbac-helpers\"\r\n\r\nconst markUrgentSchema = z.object({\r\n    projectId: z.coerce.number(),\r\n    reason: z.string().min(10, \"Reason must be at least 10 characters\"),\r\n})\r\n\r\nexport async function markProjectUrgent(formData: FormData) {\r\n    const session = await getServerSession(authOptions)\r\n    if (!session) return { error: \"Unauthorized\" }\r\n\r\n    const projectId = formData.get(\"projectId\")\r\n    const reason = formData.get(\"reason\")\r\n\r\n    const validated = markUrgentSchema.safeParse({ projectId, reason })\r\n\r\n    if (!validated.success) {\r\n        return { error: \"Validation failed\", details: validated.error.format() }\r\n    }\r\n\r\n    try {\r\n        // Check permissions\r\n        const project = await prisma.project.findUnique({\r\n            where: { id: validated.data.projectId },\r\n            include: {\r\n                projectManager: true,\r\n                projectUsers: true,\r\n                projectTeams: {\r\n                    include: {\r\n                        team: {\r\n                            include: {\r\n                                teamLead: true,\r\n                                members: true\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        })\r\n\r\n        if (!project) {\r\n            return { error: \"Project not found\" }\r\n        }\r\n\r\n        const userId = parseInt(session.user.id)\r\n        \r\n        // Check if user has permission to mark urgent (using RBAC, no role-based bypass)\r\n        const hasPermission = await hasPermissionWithoutRoleBypass(\r\n            userId,\r\n            \"project.markUrgent\",\r\n            validated.data.projectId\r\n        )\r\n\r\n        // Also allow project manager and creator\r\n        const isPM = project.projectManagerId === userId || project.createdById === userId\r\n\r\n        if (!hasPermission && !isPM) {\r\n            return { error: \"Unauthorized: You don't have permission to mark this project as urgent\" }\r\n        }\r\n\r\n        // Update project priority\r\n        const updatedProject = await prisma.project.update({\r\n            where: { id: validated.data.projectId },\r\n            data: {\r\n                priority: \"urgent\",\r\n                urgentReason: validated.data.reason,\r\n                urgentMarkedAt: new Date(),\r\n                urgentMarkedById: userId,\r\n            },\r\n            include: {\r\n                projectManager: true,\r\n                projectUsers: {\r\n                    select: {\r\n                        userId: true\r\n                    }\r\n                },\r\n                projectTeams: {\r\n                    include: {\r\n                        team: {\r\n                            select: {\r\n                                teamLeadId: true,\r\n                                members: {\r\n                                    select: {\r\n                                        userId: true\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        })\r\n\r\n        // Collect users to notify\r\n        const usersToNotify = new Set<number>()\r\n        \r\n        // Add project manager\r\n        if (updatedProject.projectManagerId) {\r\n            usersToNotify.add(updatedProject.projectManagerId)\r\n        }\r\n\r\n        // Add project users\r\n        updatedProject.projectUsers.forEach(pu => {\r\n            usersToNotify.add(pu.userId)\r\n        })\r\n\r\n        // Add team leads\r\n        updatedProject.projectTeams.forEach(pt => {\r\n            if (pt.team.teamLeadId) {\r\n                usersToNotify.add(pt.team.teamLeadId)\r\n            }\r\n            // Add team members\r\n            pt.team.members.forEach(member => {\r\n                usersToNotify.add(member.userId)\r\n            })\r\n        })\r\n\r\n        // Add all admins\r\n        const admins = await prisma.user.findMany({\r\n            where: { role: \"admin\" },\r\n            select: { id: true }\r\n        })\r\n        admins.forEach(admin => usersToNotify.add(admin.id))\r\n\r\n        // Send urgent notifications to all relevant users\r\n        const notificationPromises = Array.from(usersToNotify).map(userId => \r\n            createProjectNotification(\r\n                validated.data.projectId,\r\n                userId,\r\n                {\r\n                    type: \"project_urgent\",\r\n                    entityType: \"project\",\r\n                    entityId: validated.data.projectId,\r\n                    title: `ðŸš¨ URGENT: ${updatedProject.name}`,\r\n                    message: `This project has been marked as URGENT. Reason: ${validated.data.reason}`,\r\n                    soundRequired: true,\r\n                    isUrgent: true,\r\n                    requiresAcknowledgment: true,\r\n                }\r\n            )\r\n        )\r\n\r\n        await Promise.all(notificationPromises)\r\n\r\n        // Log activity\r\n        await logActivity({\r\n            actionType: \"project_marked_urgent\",\r\n            actionCategory: \"project\",\r\n            actionSummary: `Project \"${updatedProject.name}\" marked as URGENT`,\r\n            actionDetails: {\r\n                projectId: updatedProject.id,\r\n                projectName: updatedProject.name,\r\n                reason: validated.data.reason,\r\n                notifiedUsers: Array.from(usersToNotify).length,\r\n            },\r\n            performedById: userId,\r\n            projectId: validated.data.projectId,\r\n            entityType: \"project\",\r\n            entityId: validated.data.projectId,\r\n        })\r\n\r\n        revalidatePath(`/dashboard/projects/${validated.data.projectId}`)\r\n        revalidatePath(\"/dashboard\")\r\n        revalidatePath(\"/dashboard/projects\")\r\n\r\n        return { success: true, project: updatedProject }\r\n    } catch (error: any) {\r\n        console.error(\"Error marking project as urgent:\", error)\r\n        return { error: \"Failed to mark project as urgent\", details: error.message }\r\n    }\r\n}\r\n\r\nexport async function acknowledgeUrgentProject(projectId: number) {\r\n    const session = await getServerSession(authOptions)\r\n    if (!session) return { error: \"Unauthorized\" }\r\n\r\n    const userId = parseInt(session.user.id)\r\n\r\n    try {\r\n        const project = await prisma.project.findUnique({\r\n            where: { id: projectId }\r\n        })\r\n\r\n        if (!project) {\r\n            return { error: \"Project not found\" }\r\n        }\r\n\r\n        if (project.priority !== \"urgent\") {\r\n            return { error: \"Project is not marked as urgent\" }\r\n        }\r\n\r\n        // Create or update acknowledgment\r\n        await prisma.urgentProjectAcknowledgement.upsert({\r\n            where: {\r\n                projectId_userId: {\r\n                    projectId: projectId,\r\n                    userId: userId\r\n                }\r\n            },\r\n            create: {\r\n                projectId: projectId,\r\n                userId: userId,\r\n            },\r\n            update: {\r\n                acknowledgedAt: new Date()\r\n            }\r\n        })\r\n\r\n        // Mark urgent notifications as acknowledged for this user\r\n        await prisma.projectNotification.updateMany({\r\n            where: {\r\n                projectId: projectId,\r\n                userId: userId,\r\n                isUrgent: true,\r\n                requiresAcknowledgment: true,\r\n            },\r\n            data: {\r\n                acknowledgedAt: new Date(),\r\n                isRead: true,\r\n            }\r\n        })\r\n\r\n        // Log activity\r\n        await logActivity({\r\n            actionType: \"project_urgent_acknowledged\",\r\n            actionCategory: \"project\",\r\n            actionSummary: `Acknowledged urgent project \"${project.name}\"`,\r\n            actionDetails: {\r\n                projectId: project.id,\r\n                projectName: project.name,\r\n            },\r\n            performedById: userId,\r\n            projectId: projectId,\r\n            entityType: \"project\",\r\n            entityId: projectId,\r\n        })\r\n\r\n        revalidatePath(`/dashboard/projects/${projectId}`)\r\n        revalidatePath(\"/dashboard\")\r\n\r\n        return { success: true }\r\n    } catch (error: any) {\r\n        console.error(\"Error acknowledging urgent project:\", error)\r\n        return { error: \"Failed to acknowledge urgent project\", details: error.message }\r\n    }\r\n}\r\n\r\nexport async function removeUrgentPriority(projectId: number) {\r\n    const session = await getServerSession(authOptions)\r\n    if (!session) return { error: \"Unauthorized\" }\r\n\r\n    const userId = parseInt(session.user.id)\r\n\r\n    try {\r\n        const project = await prisma.project.findUnique({\r\n            where: { id: projectId }\r\n        })\r\n\r\n        if (!project) {\r\n            return { error: \"Project not found\" }\r\n        }\r\n\r\n        // Check if user has permission to remove urgent priority (using RBAC, no role-based bypass)\r\n        const hasPermission = await hasPermissionWithoutRoleBypass(\r\n            userId,\r\n            \"project.removeUrgent\",\r\n            projectId\r\n        )\r\n\r\n        // Also allow project manager and creator\r\n        const isPM = project.projectManagerId === userId || project.createdById === userId\r\n\r\n        if (!hasPermission && !isPM) {\r\n            return { error: \"Unauthorized: You don't have permission to remove urgent priority from this project\" }\r\n        }\r\n\r\n        // Update project\r\n        await prisma.project.update({\r\n            where: { id: projectId },\r\n            data: {\r\n                priority: \"normal\",\r\n                urgentReason: null,\r\n                urgentMarkedAt: null,\r\n                urgentMarkedById: null,\r\n            }\r\n        })\r\n\r\n        // Mark all urgent notifications as read (no longer urgent)\r\n        await prisma.projectNotification.updateMany({\r\n            where: {\r\n                projectId: projectId,\r\n                isUrgent: true,\r\n            },\r\n            data: {\r\n                isRead: true,\r\n                acknowledgedAt: new Date(),\r\n            }\r\n        })\r\n\r\n        // Log activity\r\n        await logActivity({\r\n            actionType: \"project_urgent_removed\",\r\n            actionCategory: \"project\",\r\n            actionSummary: `Removed urgent priority from project \"${project.name}\"`,\r\n            actionDetails: {\r\n                projectId: project.id,\r\n                projectName: project.name,\r\n            },\r\n            performedById: userId,\r\n            projectId: projectId,\r\n            entityType: \"project\",\r\n            entityId: projectId,\r\n        })\r\n\r\n        revalidatePath(`/dashboard/projects/${projectId}`)\r\n        revalidatePath(\"/dashboard\")\r\n        revalidatePath(\"/dashboard/projects\")\r\n\r\n        return { success: true }\r\n    } catch (error: any) {\r\n        console.error(\"Error removing urgent priority:\", error)\r\n        return { error: \"Failed to remove urgent priority\", details: error.message }\r\n    }\r\n}\r\n\r\nexport async function getUrgentProjects() {\r\n    const session = await getServerSession(authOptions)\r\n    if (!session) return { error: \"Unauthorized\" }\r\n\r\n    const userId = parseInt(session.user.id)\r\n    const userRole = session.user.role || \"developer\"\r\n    const isAdmin = userRole === \"admin\"\r\n\r\n    try {\r\n        const where: any = {\r\n            priority: \"urgent\"\r\n        }\r\n\r\n        // Filter by user's projects if not admin\r\n        if (!isAdmin) {\r\n            where.OR = [\r\n                { projectManagerId: userId },\r\n                { createdById: userId },\r\n                { projectUsers: { some: { userId } } },\r\n                { projectTeams: { some: { team: { teamLeadId: userId } } } },\r\n                { projectTeams: { some: { team: { members: { some: { userId } } } } } }\r\n            ]\r\n        }\r\n\r\n        const projects = await prisma.project.findMany({\r\n            where,\r\n            include: {\r\n                projectManager: {\r\n                    select: {\r\n                        id: true,\r\n                        username: true,\r\n                        avatarUrl: true\r\n                    }\r\n                },\r\n                urgentMarkedBy: {\r\n                    select: {\r\n                        id: true,\r\n                        username: true\r\n                    }\r\n                },\r\n                urgentAcknowledgments: {\r\n                    where: { userId },\r\n                    select: {\r\n                        acknowledgedAt: true\r\n                    }\r\n                }\r\n            },\r\n            orderBy: { urgentMarkedAt: \"desc\" }\r\n        })\r\n\r\n        return { success: true, projects }\r\n    } catch (error: any) {\r\n        console.error(\"Error fetching urgent projects:\", error)\r\n        return { error: \"Failed to fetch urgent projects\", details: error.message }\r\n    }\r\n}\r\n\r\nexport async function hasAcknowledgedUrgent(projectId: number) {\r\n    const session = await getServerSession(authOptions)\r\n    if (!session) return false\r\n\r\n    const userId = parseInt(session.user.id)\r\n\r\n    try {\r\n        const acknowledgment = await prisma.urgentProjectAcknowledgement.findUnique({\r\n            where: {\r\n                projectId_userId: {\r\n                    projectId,\r\n                    userId\r\n                }\r\n            }\r\n        })\r\n\r\n        return !!acknowledgment\r\n    } catch (error) {\r\n        console.error(\"Error checking acknowledgment:\", error)\r\n        return false\r\n    }\r\n}\r\n\r\n","/**\r\n * File upload validation and sanitization\r\n * Prevents malicious file uploads through MIME type checking, size limits, and magic bytes validation\r\n */\r\n\r\n// Allowed MIME types with max file sizes (whitelist approach)\r\nconst ALLOWED_MIME_TYPES: Record<string, { ext: string; maxSize: number }> = {\r\n  // Images\r\n  'image/jpeg': { ext: 'jpg', maxSize: 5 * 1024 * 1024 }, // 5MB\r\n  'image/png': { ext: 'png', maxSize: 5 * 1024 * 1024 },\r\n  'image/webp': { ext: 'webp', maxSize: 5 * 1024 * 1024 },\r\n  'image/gif': { ext: 'gif', maxSize: 5 * 1024 * 1024 },\r\n  'image/svg+xml': { ext: 'svg', maxSize: 2 * 1024 * 1024 },\r\n\r\n  // Documents\r\n  'application/pdf': { ext: 'pdf', maxSize: 10 * 1024 * 1024 }, // 10MB\r\n  'application/msword': { ext: 'doc', maxSize: 10 * 1024 * 1024 },\r\n  'application/vnd.openxmlformats-officedocument.wordprocessingml.document': {\r\n    ext: 'docx',\r\n    maxSize: 10 * 1024 * 1024,\r\n  },\r\n  'application/vnd.ms-excel': { ext: 'xls', maxSize: 10 * 1024 * 1024 },\r\n  'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet': {\r\n    ext: 'xlsx',\r\n    maxSize: 10 * 1024 * 1024,\r\n  },\r\n  'text/plain': { ext: 'txt', maxSize: 5 * 1024 * 1024 },\r\n  'text/csv': { ext: 'csv', maxSize: 5 * 1024 * 1024 },\r\n}\r\n\r\n// Disallowed extensions (defense in depth - for additional security)\r\nconst DANGEROUS_EXTENSIONS = [\r\n  'exe',\r\n  'bat',\r\n  'cmd',\r\n  'com',\r\n  'scr',\r\n  'vbs',\r\n  'js',\r\n  'jar',\r\n  'zip',\r\n  'rar',\r\n  '7z',\r\n  'dll',\r\n  'msi',\r\n  'app',\r\n  'deb',\r\n  'rpm',\r\n  'dmg',\r\n  'pkg',\r\n  'run',\r\n  'sh',\r\n  'bash',\r\n  'zsh',\r\n  'ps1',\r\n  'psc1',\r\n  'msh',\r\n  'msh1',\r\n  'mshxml',\r\n  'msh1xml',\r\n  'pssc',\r\n  'psc2',\r\n  'msh2',\r\n  'msh2xml',\r\n  'psc3',\r\n  'msh3',\r\n  'msh3xml',\r\n  'aspx',\r\n  'asp',\r\n  'php',\r\n  'php3',\r\n  'php4',\r\n  'php5',\r\n  'jsp',\r\n  'jspx',\r\n  'jspf',\r\n  'jsw',\r\n  'jsv',\r\n  'jspx',\r\n  'wsh',\r\n  'wsf',\r\n  'py',\r\n  'pyc',\r\n  'pyo',\r\n  'rb',\r\n  'rbw',\r\n  'cgi',\r\n  'pl',\r\n  'ada',\r\n  'asm',\r\n  'bas',\r\n  'c',\r\n  'cpp',\r\n  'cxx',\r\n  'cc',\r\n  'h',\r\n  'hpp',\r\n  'cs',\r\n  'java',\r\n  'class',\r\n  'swift',\r\n  'kt',\r\n  'go',\r\n  'rs',\r\n  'ts',\r\n  'tsx',\r\n  'jsx',\r\n]\r\n\r\nexport interface ValidationResult {\r\n  valid: boolean\r\n  error?: string\r\n  suggestedExtension?: string\r\n}\r\n\r\n/**\r\n * Validate file before upload\r\n * Checks:\r\n * 1. MIME type is in allowlist\r\n * 2. File size doesn't exceed limit\r\n * 3. Extension is not in blocklist\r\n * 4. Extension matches MIME type\r\n *\r\n * @param file - File to validate\r\n * @returns ValidationResult with error if invalid\r\n *\r\n * @example\r\n * const result = validateFileUpload(file)\r\n * if (!result.valid) {\r\n *   return { error: result.error }\r\n * }\r\n */\r\nexport function validateFileUpload(file: File): ValidationResult {\r\n  if (!file) {\r\n    return {\r\n      valid: false,\r\n      error: 'No file provided',\r\n    }\r\n  }\r\n\r\n  // 1. Check if file has a name\r\n  if (!file.name || file.name.trim() === '') {\r\n    return {\r\n      valid: false,\r\n      error: 'File must have a name',\r\n    }\r\n  }\r\n\r\n  // 2. Check MIME type against allowlist\r\n  if (!ALLOWED_MIME_TYPES[file.type]) {\r\n    const allowedTypes = Object.keys(ALLOWED_MIME_TYPES).join(', ')\r\n    return {\r\n      valid: false,\r\n      error: `File type \"${file.type || 'unknown'}\" is not allowed. Supported types: ${allowedTypes}`,\r\n    }\r\n  }\r\n\r\n  // 3. Check file size\r\n  const maxSize = ALLOWED_MIME_TYPES[file.type].maxSize\r\n  if (file.size === 0) {\r\n    return {\r\n      valid: false,\r\n      error: 'File is empty',\r\n    }\r\n  }\r\n\r\n  if (file.size > maxSize) {\r\n    const maxSizeMB = (maxSize / 1024 / 1024).toFixed(2)\r\n    const fileSizeMB = (file.size / 1024 / 1024).toFixed(2)\r\n    return {\r\n      valid: false,\r\n      error: `File size ${fileSizeMB}MB exceeds maximum ${maxSizeMB}MB for this file type`,\r\n    }\r\n  }\r\n\r\n  // 4. Check file extension\r\n  const ext = getFileExtension(file.name).toLowerCase()\r\n  if (ext && DANGEROUS_EXTENSIONS.includes(ext)) {\r\n    return {\r\n      valid: false,\r\n      error: `File extension \".${ext}\" is not allowed for security reasons`,\r\n    }\r\n  }\r\n\r\n  // 5. Validate extension matches MIME type (warning only)\r\n  const expectedExt = ALLOWED_MIME_TYPES[file.type].ext\r\n  if (ext && ext !== expectedExt) {\r\n    // Allow but log warning - some systems use different extensions\r\n    console.warn(\r\n      `Warning: File extension \".${ext}\" may not match MIME type \"${file.type}\". Expected: \".${expectedExt}\"`\r\n    )\r\n  }\r\n\r\n  return { valid: true }\r\n}\r\n\r\n/**\r\n * Sanitize filename to prevent directory traversal and special characters\r\n *\r\n * @param filename - Filename to sanitize\r\n * @returns Safe filename\r\n */\r\nexport function sanitizeFilename(filename: string): string {\r\n  if (!filename) return 'file'\r\n\r\n  return (\r\n    filename\r\n      .replace(/\\\\/g, '') // Remove backslashes\r\n      .replace(/\\//g, '') // Remove forward slashes\r\n      .replace(/\\.\\./g, '') // Remove dot-dot\r\n      .replace(/[<>:\"|?*\\x00-\\x1f]/g, '') // Remove special/control characters\r\n      .replace(/\\s+/g, '_') // Replace whitespace with underscore\r\n      .substring(0, 255) // Limit filename length\r\n  )\r\n}\r\n\r\n/**\r\n * Generate safe filename for storage with unique identifier\r\n *\r\n * @param originalName - Original filename from upload\r\n * @param userId - User ID for tracking\r\n * @returns Safe unique filename\r\n */\r\nexport function generateSafeFilename(originalName: string, userId: number): string {\r\n  const ext = getFileExtension(originalName)\r\n  const timestamp = Date.now()\r\n  const random = Math.random().toString(36).substring(2, 8)\r\n\r\n  // Format: user_123_timestamp_random.ext\r\n  return `u${userId}_${timestamp}_${random}.${ext}`\r\n}\r\n\r\n/**\r\n * Get file extension from filename\r\n *\r\n * @param filename - Filename\r\n * @returns File extension without the dot\r\n */\r\nfunction getFileExtension(filename: string): string {\r\n  if (!filename) return ''\r\n  const parts = filename.split('.')\r\n  return parts.length > 1 ? parts[parts.length - 1] : ''\r\n}\r\n\r\n/**\r\n * Validate file content by checking magic bytes (file signature)\r\n * This prevents MIME type spoofing attacks\r\n *\r\n * @param buffer - File content as ArrayBuffer\r\n * @param mimeType - Expected MIME type\r\n * @returns True if magic bytes match expected type, false otherwise\r\n */\r\nexport async function validateFileContent(buffer: ArrayBuffer, mimeType: string): Promise<boolean> {\r\n  // Magic numbers for common file types\r\n  const magicNumbers: Record<string, number[]> = {\r\n    'image/jpeg': [0xff, 0xd8, 0xff], // JPEG starts with FFD8FF\r\n    'image/png': [0x89, 0x50, 0x4e, 0x47], // PNG starts with 89504E47\r\n    'image/gif': [0x47, 0x49, 0x46], // GIF starts with GIF\r\n    'image/webp': [0x52, 0x49, 0x46, 0x46], // WebP starts with RIFF\r\n    'application/pdf': [0x25, 0x50, 0x44, 0x46], // PDF starts with %PDF\r\n  }\r\n\r\n  const magic = magicNumbers[mimeType]\r\n  if (!magic) return true // No magic bytes defined for this type, skip validation\r\n\r\n  const bytes = new Uint8Array(buffer)\r\n\r\n  // Check if file has enough bytes\r\n  if (bytes.length < magic.length) {\r\n    return false\r\n  }\r\n\r\n  // Check if file starts with expected magic bytes\r\n  for (let i = 0; i < magic.length; i++) {\r\n    if (bytes[i] !== magic[i]) {\r\n      return false\r\n    }\r\n  }\r\n\r\n  return true\r\n}\r\n\r\n/**\r\n * Get human-readable file size\r\n *\r\n * @param bytes - Size in bytes\r\n * @returns Human-readable size string\r\n */\r\nexport function getReadableFileSize(bytes: number): string {\r\n  const units = ['B', 'KB', 'MB', 'GB']\r\n  let size = bytes\r\n  let unitIndex = 0\r\n\r\n  while (size >= 1024 && unitIndex < units.length - 1) {\r\n    size /= 1024\r\n    unitIndex++\r\n  }\r\n\r\n  return `${size.toFixed(2)} ${units[unitIndex]}`\r\n}\r\n\r\n/**\r\n * Get maximum allowed file size for a MIME type\r\n *\r\n * @param mimeType - MIME type\r\n * @returns Maximum file size in bytes\r\n */\r\nexport function getMaxFileSize(mimeType: string): number {\r\n  return ALLOWED_MIME_TYPES[mimeType]?.maxSize ?? 0\r\n}\r\n\r\n/**\r\n * Get list of allowed MIME types\r\n *\r\n * @returns Array of allowed MIME types\r\n */\r\nexport function getAllowedMimeTypes(): string[] {\r\n  return Object.keys(ALLOWED_MIME_TYPES)\r\n}\r\n\r\n/**\r\n * Check if MIME type is allowed\r\n *\r\n * @param mimeType - MIME type to check\r\n * @returns True if allowed, false otherwise\r\n */\r\nexport function isAllowedMimeType(mimeType: string): boolean {\r\n  return mimeType in ALLOWED_MIME_TYPES\r\n}\r\n","\"use server\"\r\n\r\nimport { prisma } from \"@/lib/prisma\"\r\nimport { getServerSession } from \"next-auth\"\r\nimport { authOptions } from \"@/lib/auth\"\r\n\r\ntype ActionCategory = \r\n  | \"auth\" \r\n  | \"project\" \r\n  | \"task\" \r\n  | \"dependency\" \r\n  | \"settings\" \r\n  | \"notification\" \r\n  | \"today_task\"\r\n\r\ninterface GetActivityLogsParams {\r\n  limit?: number\r\n  offset?: number\r\n  startDate?: Date\r\n  endDate?: Date\r\n  userId?: number\r\n  projectId?: number\r\n  category?: ActionCategory\r\n  entityType?: string\r\n  search?: string\r\n}\r\n\r\n/**\r\n * Get activity logs (Admin only)\r\n */\r\nexport async function getActivityLogs(params: GetActivityLogsParams = {}) {\r\n  try {\r\n    const session = await getServerSession(authOptions)\r\n    if (!session?.user?.id) {\r\n      return { success: false, error: \"Unauthorized\" }\r\n    }\r\n\r\n    // Only admins can view activity logs\r\n    if (session.user.role !== \"admin\") {\r\n      return { success: false, error: \"Access denied. Admin only.\" }\r\n    }\r\n\r\n    const {\r\n      limit = 50,\r\n      offset = 0,\r\n      startDate,\r\n      endDate,\r\n      userId,\r\n      projectId,\r\n      category,\r\n      entityType,\r\n      search,\r\n    } = params\r\n\r\n    const where: any = {}\r\n\r\n    // Date range filter\r\n    if (startDate || endDate) {\r\n      where.createdAt = {}\r\n      if (startDate) {\r\n        where.createdAt.gte = startDate\r\n      }\r\n      if (endDate) {\r\n        where.createdAt.lte = endDate\r\n      }\r\n    }\r\n\r\n    // User filter\r\n    if (userId) {\r\n      where.performedById = userId\r\n    }\r\n\r\n    // Project filter\r\n    if (projectId) {\r\n      where.projectId = projectId\r\n    }\r\n\r\n    // Category filter\r\n    if (category) {\r\n      where.actionCategory = category\r\n    }\r\n\r\n    // Entity type filter\r\n    if (entityType) {\r\n      where.entityType = entityType\r\n    }\r\n\r\n    // Search filter (searches in actionSummary and actionDetails)\r\n    // Note: SQLite doesn't support case-insensitive mode, so we use contains\r\n    if (search && search.trim()) {\r\n      where.OR = [\r\n        { actionSummary: { contains: search.trim() } },\r\n        { actionDetails: { contains: search.trim() } },\r\n        { actionType: { contains: search.trim() } },\r\n      ]\r\n    }\r\n\r\n    // Try to fetch with new schema first, fall back to old schema if needed\r\n    let logs: any[] = []\r\n    let total = 0\r\n\r\n    try {\r\n      const [logsResult, totalResult] = await Promise.all([\r\n        prisma.activityLog.findMany({\r\n          where,\r\n          include: {\r\n            performedBy: {\r\n              select: {\r\n                id: true,\r\n                username: true,\r\n                email: true,\r\n                role: true,\r\n              },\r\n            },\r\n            affectedUser: {\r\n              select: {\r\n                id: true,\r\n                username: true,\r\n                email: true,\r\n              },\r\n            },\r\n            project: {\r\n              select: {\r\n                id: true,\r\n                name: true,\r\n              },\r\n            },\r\n          },\r\n          orderBy: { createdAt: \"desc\" },\r\n          take: limit,\r\n          skip: offset,\r\n        }),\r\n        prisma.activityLog.count({ where }),\r\n      ])\r\n      logs = logsResult\r\n      total = totalResult\r\n    } catch (error: any) {\r\n      // If relations don't exist, try with basic query\r\n      if (error.message?.includes('Unknown arg') || error.code === 'P2009') {\r\n        console.warn(\"[ActivityLogs] Relations not available, using basic query\")\r\n        const [logsResult, totalResult] = await Promise.all([\r\n          prisma.activityLog.findMany({\r\n            where,\r\n            orderBy: { createdAt: \"desc\" },\r\n            take: limit,\r\n            skip: offset,\r\n          }),\r\n          prisma.activityLog.count({ where }),\r\n        ])\r\n        logs = logsResult.map((log: any) => ({\r\n          ...log,\r\n          performedBy: log.userId ? { id: log.userId, username: \"Unknown\", email: \"\", role: \"\" } : null,\r\n          affectedUser: null,\r\n          project: null,\r\n        }))\r\n        total = totalResult\r\n      } else {\r\n        throw error\r\n      }\r\n    }\r\n\r\n    return {\r\n      success: true,\r\n      logs,\r\n      total,\r\n      limit,\r\n      offset,\r\n    }\r\n  } catch (error: any) {\r\n    console.error(\"Error fetching activity logs:\", error)\r\n    return {\r\n      success: false,\r\n      error: error?.message || \"Failed to fetch activity logs\",\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Get a single activity log by ID (Admin only)\r\n */\r\nexport async function getActivityLogById(id: number) {\r\n  try {\r\n    const session = await getServerSession(authOptions)\r\n    if (!session?.user?.id) {\r\n      return { success: false, error: \"Unauthorized\" }\r\n    }\r\n\r\n    // Only admins can view activity logs\r\n    if (session.user.role !== \"admin\") {\r\n      return { success: false, error: \"Access denied. Admin only.\" }\r\n    }\r\n\r\n    const log = await prisma.activityLog.findUnique({\r\n      where: { id },\r\n      include: {\r\n        performedBy: {\r\n          select: {\r\n            id: true,\r\n            username: true,\r\n            email: true,\r\n            role: true,\r\n          },\r\n        },\r\n        affectedUser: {\r\n          select: {\r\n            id: true,\r\n            username: true,\r\n            email: true,\r\n          },\r\n        },\r\n        project: {\r\n          select: {\r\n            id: true,\r\n            name: true,\r\n          },\r\n        },\r\n      },\r\n    })\r\n\r\n    if (!log) {\r\n      return { success: false, error: \"Activity log not found\" }\r\n    }\r\n\r\n    return {\r\n      success: true,\r\n      log,\r\n    }\r\n  } catch (error: any) {\r\n    console.error(\"Error fetching activity log:\", error)\r\n    return {\r\n      success: false,\r\n      error: error?.message || \"Failed to fetch activity log\",\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Get activity log statistics (Admin only)\r\n */\r\nexport async function getActivityLogStats(startDate?: Date, endDate?: Date) {\r\n  try {\r\n    const session = await getServerSession(authOptions)\r\n    if (!session?.user?.id) {\r\n      return { success: false, error: \"Unauthorized\" }\r\n    }\r\n\r\n    // Only admins can view activity logs\r\n    if (session.user.role !== \"admin\") {\r\n      return { success: false, error: \"Access denied. Admin only.\" }\r\n    }\r\n\r\n    const where: any = {}\r\n    if (startDate || endDate) {\r\n      where.createdAt = {}\r\n      if (startDate) {\r\n        where.createdAt.gte = startDate\r\n      }\r\n      if (endDate) {\r\n        where.createdAt.lte = endDate\r\n      }\r\n    }\r\n\r\n    const [totalLogs, byCategory, byUser, recentActivity] = await Promise.all([\r\n      prisma.activityLog.count({ where }),\r\n      prisma.activityLog.groupBy({\r\n        by: [\"actionCategory\"],\r\n        where,\r\n        _count: true,\r\n      }),\r\n      prisma.activityLog.groupBy({\r\n        by: [\"performedById\"],\r\n        where,\r\n        _count: true,\r\n        orderBy: { _count: { performedById: \"desc\" } },\r\n        take: 10,\r\n      }),\r\n      prisma.activityLog.findMany({\r\n        where,\r\n        orderBy: { createdAt: \"desc\" },\r\n        take: 10,\r\n        select: {\r\n          id: true,\r\n          actionType: true,\r\n          actionSummary: true,\r\n          createdAt: true,\r\n          performedBy: {\r\n            select: {\r\n              username: true,\r\n            },\r\n          },\r\n        },\r\n      }),\r\n    ])\r\n\r\n    return {\r\n      success: true,\r\n      stats: {\r\n        totalLogs,\r\n        byCategory: byCategory.map((item) => ({\r\n          category: item.actionCategory,\r\n          count: item._count,\r\n        })),\r\n        byUser: byUser.map((item) => ({\r\n          userId: item.performedById,\r\n          count: item._count,\r\n        })),\r\n        recentActivity,\r\n      },\r\n    }\r\n  } catch (error: any) {\r\n    console.error(\"Error fetching activity log stats:\", error)\r\n    return {\r\n      success: false,\r\n      error: error?.message || \"Failed to fetch activity log stats\",\r\n    }\r\n  }\r\n}\r\n\r\n","export {getPublicSystemSettings as '0033db22356cbf8845a3517099b63dfc38d1147299'} from 'ACTIONS_MODULE0'\nexport {getAllProjectsUnreadNotificationCount as '00686a7231b739e4fe9b8305b757bc0e83827b9865'} from 'ACTIONS_MODULE1'\nexport {getAllProjectsNotifications as '4004a0aae390e2c1aeb900c79065f312ac43d90f8d'} from 'ACTIONS_MODULE1'\nexport {markProjectNotificationAsRead as '60691655a7ad6aec29ab9691d8571a0d380be93da1'} from 'ACTIONS_MODULE1'\nexport {getProjects as '003ae2a452e6e1e8ebee86f206a9903396d5df13b8'} from 'ACTIONS_MODULE2'\nexport {createProject as '401e3f4be30a5d5dbee04214aa788c798e018c4c21'} from 'ACTIONS_MODULE2'\nexport {getProject as '402c9fcdaf734573eeb364d1e92aac14ecf31bcfb9'} from 'ACTIONS_MODULE2'\nexport {getProjectsWithFilters as '406144e6cbbfbe91083d4680cc56756da14a65698a'} from 'ACTIONS_MODULE2'\nexport {deleteProject as '40fdba31998d7a3efe7c944c688cf93002e917af7b'} from 'ACTIONS_MODULE2'\nexport {updateProject as '601c00162e3e64028c2b657a9e3982df01dad141d5'} from 'ACTIONS_MODULE2'\nexport {logActivity as '40daa1d9c7314de4957a7669434db12aaa24630ba4'} from 'ACTIONS_MODULE3'\nexport {getUsers as '0078a5996050e1da89a66893bd05780e75185392cb'} from 'ACTIONS_MODULE4'\nexport {createUser as '401fc4e21517ebfbd3eebabb3ac6ad3bf2fb7443a7'} from 'ACTIONS_MODULE4'\nexport {getUser as '406fd270e8a350e38c78e4b79321560707aa26fd1a'} from 'ACTIONS_MODULE4'\nexport {deleteUser as '40abdcd9a05b7e5b6a27a4efd7412defa3f340c60c'} from 'ACTIONS_MODULE4'\nexport {updateUserTeam as '6020ac488ab0f44300111f3a8024b04b647106d187'} from 'ACTIONS_MODULE4'\nexport {toggleUserStatus as '60b33fdd6fc55215f2569d47e96e5d33d33f4f707f'} from 'ACTIONS_MODULE4'\nexport {updateUser as '60e1fb0fb657783a6424ba7525af9dca8a6316a12b'} from 'ACTIONS_MODULE4'\nexport {getAllProjectsStats as '0067b4066470cdfc7051409a87b3c7ea74b1f3dbad'} from 'ACTIONS_MODULE5'\nexport {getProjectStats as '408c06bc00554e58667a6497e03286e21786a0b4de'} from 'ACTIONS_MODULE5'\nexport {getTaskStats as '4092a06687f1e4d6d11b97639f194f16619a7c015f'} from 'ACTIONS_MODULE5'\nexport {getSummaryStatsWithTrends as '60e05fd890f5d06ad446fdd4907a3fbe4311fe3ac9'} from 'ACTIONS_MODULE5'\nexport {getForecastsForTasks as '40014e02ec0435626c5ced3cf35fc455f331fe89cf'} from 'ACTIONS_MODULE6'\nexport {updateProject as '601c00162e3e64028c2b657a9e3982df01dad141d5'} from 'ACTIONS_MODULE2'\nexport {getProjectTypes as '60ec9252c798f5964d56c5d51f9afd9f2f40212108'} from 'ACTIONS_MODULE7'\nexport {getProjectStatuses as '40eb0a5c1df80ac1d9c012cf4d456e2b96fc6eccd4'} from 'ACTIONS_MODULE8'\nexport {getProjectUnreadNotificationCount as '40c45036bf2dcfbc3a3b624285c3d3d3366fc5ed73'} from 'ACTIONS_MODULE1'\nexport {getProjectNotifications as '60e11d18f808d2843f4d06a35ea4ad9027dd8b4de1'} from 'ACTIONS_MODULE1'\nexport {markAllProjectNotificationsAsRead as '40c086aae8b4c1ddec14829c213410ee4c5d2ec0b4'} from 'ACTIONS_MODULE1'\nexport {getProjectNotificationPreferences as '4073df5af18efe51e33e158abaa2dd30f11932484d'} from 'ACTIONS_MODULE1'\nexport {updateProjectNotificationPreferences as '60d7258dffa20b5ae58a4ac333313c2a6cc4aeb7a7'} from 'ACTIONS_MODULE1'\nexport {createProjectNotification as '705f7777ed9cdc6c32f418ba57dcb7f4b84f8c002a'} from 'ACTIONS_MODULE1'\nexport {markProjectUrgent as '409f63a3c373c5a1d91cbdece6bed64e7ad1bb9de3'} from 'ACTIONS_MODULE9'\nexport {removeUrgentPriority as '40a1ef9e59469b9018d9dca101e2d6830cd362dfa4'} from 'ACTIONS_MODULE9'\nexport {getActivityLogs as '404fd7d1c33d728683f2bb688d48969be05c615525'} from 'ACTIONS_MODULE10'\nexport {createTask as '402d88094f0d43ffbbdb2cc55981130389e939c098'} from 'ACTIONS_MODULE11'\nexport {updateTaskStatus as '709a22b83fb95b514103e9a68c206c65a10f984982'} from 'ACTIONS_MODULE11'\nexport {uploadProjectFile as '40c036377622299eab7c3fedd2f88987461f8f0471'} from 'ACTIONS_MODULE12'\nexport {getProjectAttachments as '400d0b446f3a38c15d257fe7d9046d0aa056070e15'} from 'ACTIONS_MODULE12'\nexport {deleteAttachment as '60c92747f45f0a848c5a9d51dc879510962f79e0b1'} from 'ACTIONS_MODULE12'\nexport {acknowledgeUrgentProject as '40271b869aa95cc70186c7d92a799fd4ff185374b6'} from 'ACTIONS_MODULE9'\nexport {hasAcknowledgedUrgent as '406dc0bd8d7e9cdb49e1d05a07a97ade94458c58d0'} from 'ACTIONS_MODULE9'\n","\"use server\"\r\n\r\nimport { prisma } from \"@/lib/prisma\"\r\nimport { getServerSession } from \"next-auth\"\r\nimport { authOptions } from \"@/lib/auth\"\r\nimport { revalidatePath } from \"next/cache\"\r\nimport { logActivity } from \"@/lib/activity-logger\"\r\nimport { writeFile, mkdir, unlink } from \"fs/promises\"\r\nimport { join } from \"path\"\r\nimport { existsSync } from \"fs\"\r\nimport {\r\n  validateFileUpload,\r\n  sanitizeFilename,\r\n  generateSafeFilename,\r\n  validateFileContent,\r\n  getReadableFileSize,\r\n} from \"@/lib/file-upload-validator\"\r\n\r\n// Ensure uploads directory exists\r\nconst uploadsDir = join(process.cwd(), \"public\", \"uploads\")\r\n\r\nasync function ensureUploadsDir() {\r\n  if (!existsSync(uploadsDir)) {\r\n    await mkdir(uploadsDir, { recursive: true })\r\n  }\r\n}\r\n\r\nexport async function uploadProjectFile(formData: FormData) {\r\n  const session = await getServerSession(authOptions)\r\n  if (!session) return { error: \"Unauthorized\", code: \"UNAUTHORIZED\" }\r\n\r\n  const file = formData.get(\"file\") as File | null\r\n  const projectId = formData.get(\"projectId\")\r\n  const taskId = formData.get(\"taskId\") // Optional - for task-specific files\r\n\r\n  if (!file || !projectId) {\r\n    return { error: \"File and project ID are required\", code: \"MISSING_PARAMS\" }\r\n  }\r\n\r\n  try {\r\n    // 1. VALIDATE FILE BEFORE PROCESSING\r\n    const validation = validateFileUpload(file)\r\n    if (!validation.valid) {\r\n      return {\r\n        error: validation.error || \"Invalid file\",\r\n        code: \"INVALID_FILE\",\r\n      }\r\n    }\r\n\r\n    // 2. VALIDATE FILE CONTENT (Magic Bytes) - Prevent MIME type spoofing\r\n    const bytes = await file.arrayBuffer()\r\n    const contentValid = await validateFileContent(bytes, file.type)\r\n    if (!contentValid) {\r\n      return {\r\n        error: \"File content does not match declared type. Possible spoofing attempt.\",\r\n        code: \"CONTENT_MISMATCH\",\r\n      }\r\n    }\r\n\r\n    await ensureUploadsDir()\r\n\r\n    // 3. GENERATE SAFE FILENAME\r\n    const safeFilename = generateSafeFilename(\r\n      file.name,\r\n      parseInt(session.user.id)\r\n    )\r\n    const filePath = join(uploadsDir, safeFilename)\r\n\r\n    // 4. SAVE FILE TO DISK\r\n    const buffer = Buffer.from(bytes)\r\n    await writeFile(filePath, buffer)\r\n\r\n    // 5. CREATE DATABASE RECORD\r\n    const fileUrl = `/uploads/${safeFilename}`\r\n    const attachment = await prisma.attachment.create({\r\n      data: {\r\n        fileName: sanitizeFilename(file.name),\r\n        fileUrl: fileUrl,\r\n        fileType: file.type || null,\r\n        fileSize: file.size || null,\r\n        taskId: taskId ? parseInt(taskId as string) : null,\r\n        uploadedById: parseInt(session.user.id),\r\n      },\r\n    })\r\n\r\n    // 6. LOG ACTIVITY\r\n    await logActivity({\r\n      actionType: \"file_uploaded\",\r\n      actionCategory: \"project\",\r\n      actionSummary: `File \"${sanitizeFilename(file.name)}\" uploaded`,\r\n      actionDetails: {\r\n        fileName: sanitizeFilename(file.name),\r\n        fileSize: file.size,\r\n        fileType: file.type,\r\n        attachmentId: attachment.id,\r\n        validationPassed: true,\r\n      },\r\n      performedById: parseInt(session.user.id),\r\n      projectId: parseInt(projectId as string),\r\n      entityType: \"attachment\",\r\n      entityId: attachment.id,\r\n    })\r\n\r\n    revalidatePath(`/dashboard/projects/${projectId}`)\r\n    return { success: true, attachment, code: \"UPLOAD_SUCCESS\" }\r\n  } catch (error: any) {\r\n    console.error(\"File upload error:\", error)\r\n    return {\r\n      error: \"Failed to upload file\",\r\n      code: \"UPLOAD_FAILED\",\r\n      details: error.message,\r\n    }\r\n  }\r\n}\r\n\r\n\r\nexport async function getProjectAttachments(projectId: number) {\r\n  const session = await getServerSession(authOptions)\r\n  if (!session) return { error: \"Unauthorized\" }\r\n\r\n  try {\r\n    // Get all attachments from tasks in this project\r\n    const tasks = await prisma.task.findMany({\r\n      where: { projectId },\r\n      select: { id: true },\r\n    })\r\n\r\n    const taskIds = tasks.map((t) => t.id)\r\n\r\n    const attachments = await prisma.attachment.findMany({\r\n      where: {\r\n        OR: [\r\n          { taskId: { in: taskIds } },\r\n          { taskId: null }, // Project-level files (no taskId)\r\n        ],\r\n      },\r\n      include: {\r\n        uploader: {\r\n          select: {\r\n            id: true,\r\n            username: true,\r\n            avatarUrl: true,\r\n          },\r\n        },\r\n        task: {\r\n          select: {\r\n            id: true,\r\n            title: true,\r\n          },\r\n        },\r\n      },\r\n      orderBy: { uploadedAt: \"desc\" },\r\n    })\r\n\r\n    return { success: true, attachments }\r\n  } catch (error: any) {\r\n    console.error(\"Error fetching attachments:\", error)\r\n    return { error: \"Failed to fetch attachments\", details: error.message }\r\n  }\r\n}\r\n\r\nexport async function deleteAttachment(attachmentId: number, projectId: number) {\r\n  const session = await getServerSession(authOptions)\r\n  if (!session) return { error: \"Unauthorized\" }\r\n\r\n  try {\r\n    const attachment = await prisma.attachment.findUnique({\r\n      where: { id: attachmentId },\r\n    })\r\n\r\n    if (!attachment) {\r\n      return { error: \"Attachment not found\" }\r\n    }\r\n\r\n    // Check permission - only uploader or admin can delete\r\n    if (\r\n      attachment.uploadedById !== parseInt(session.user.id) &&\r\n      session.user.role !== \"admin\"\r\n    ) {\r\n      return { error: \"Unauthorized: You can only delete your own files\" }\r\n    }\r\n\r\n    // Delete file from disk\r\n    try {\r\n      const filePath = join(process.cwd(), \"public\", attachment.fileUrl)\r\n      if (existsSync(filePath)) {\r\n        const { unlink } = await import(\"fs/promises\")\r\n        await unlink(filePath)\r\n      }\r\n    } catch (fileError) {\r\n      console.error(\"Error deleting file from disk:\", fileError)\r\n      // Continue with database deletion even if file deletion fails\r\n    }\r\n\r\n    // Delete database record\r\n    await prisma.attachment.delete({\r\n      where: { id: attachmentId },\r\n    })\r\n\r\n    // Log activity\r\n    await logActivity({\r\n      actionType: \"file_deleted\",\r\n      actionCategory: \"project\",\r\n      actionSummary: `File \"${attachment.fileName}\" deleted`,\r\n      actionDetails: {\r\n        fileName: attachment.fileName,\r\n        attachmentId: attachment.id,\r\n      },\r\n      performedById: parseInt(session.user.id),\r\n      projectId: projectId,\r\n      entityType: \"attachment\",\r\n      entityId: attachmentId,\r\n    })\r\n\r\n    revalidatePath(`/dashboard/projects/${projectId}`)\r\n    return { success: true }\r\n  } catch (error: any) {\r\n    console.error(\"Error deleting attachment:\", error)\r\n    return { error: \"Failed to delete attachment\", details: error.message }\r\n  }\r\n}\r\n\r\n"],"names":[],"mappings":"wCAAA,IAAA,EAAA,EAAA,CAAA,CAAA,QAEO,SAAS,EAAe,CAAO,CAAE,GAAG,CAAK,EAC9C,IAAM,EAAY,EAAA,aAAa,CAAC,IAAI,CAClC,KACA,GAAW,EAAM,IAAI,CAAC,AAAC,GAAyB,UAAhB,OAAO,IAEzC,OAAO,EAAM,GAAG,CAAC,EACnB,uDCRA,IAAA,EAAA,EAAA,CAAA,CAAA,QAaO,SAAS,EAAgC,CAAI,EAClD,IAAM,EAAQ,CAAA,EAAA,EAAA,MAAA,AAAM,EAAC,GACf,EAAU,IAAI,KAClB,KAAK,GAAG,CACN,EAAM,WAAW,GACjB,EAAM,QAAQ,GACd,EAAM,OAAO,GACb,EAAM,QAAQ,GACd,EAAM,UAAU,GAChB,EAAM,UAAU,GAChB,EAAM,eAAe,KAIzB,OADA,EAAQ,cAAc,CAAC,EAAM,WAAW,IACjC,AAAC,EAAQ,CAClB,IADiB,qEC3BjB,IAAA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QAqCO,SAAS,EAAyB,CAAS,CAAE,CAAW,CAAE,CAAO,EACtE,GAAM,CAAC,EAAY,EAAa,CAAG,CAAA,EAAA,EAAA,cAAA,AAAc,EAC/C,GAAS,GACT,EACA,GAGI,EAAkB,CAAA,EAAA,EAAA,UAAA,AAAU,EAAC,GAC7B,EAAoB,CAAA,EAAA,EAAA,UAAU,AAAV,EAAW,GAUrC,OAAO,KAAK,KAAK,CAAC,CAPf,AAOgB,EAPE,CAAA,EAAA,EAAA,UAOe,qBAPf,AAA+B,EAAC,IAEnD,AAAC,EAAoB,CAAA,EAAA,EAAA,+BAAA,AAA+B,EAAC,EAAA,CAKnB,CAAgB,CAAI,EAAA,iBAAiB,CAC3E,kEE1DA,IAAA,EAAA,EAAA,CAAA,CAAA,QAiCO,SAAS,EAAQ,CAAI,EAC1B,MAAO,CAAC,CAAE,CAAC,CDDT,aAAiB,MAChB,AAAiB,OAAV,aACoC,kBAA1C,OAAO,SAAS,CAAC,QAAQ,CAAC,IAAI,CAAC,ACDjB,EDC4B,GCDH,UAAhB,OAAO,GAAsB,MAAM,CAAC,CAAA,EAAA,EAAA,MAAA,AAAM,EAAC,GAAA,CAAM,AAC9E,kICpCA,EAAA,EAAA,CAAA,CAAA,QCAA,EAAA,EAAA,CAAA,CAAA,QCAA,EAAA,EAAA,CAAA,CAAA,QEwBO,SAAS,EAAU,CAAI,CAAE,CAAO,EACrC,IAAM,EAAM,CAAA,EAAA,EAAA,MAAA,AAAM,EAAC,EAAM,GAAS,IAAI,MAAM,GAC5C,OAAe,IAAR,GAAqB,IAAR,CACtB,CC3BA,IAAA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QCDA,EAAA,EAAA,CAAA,CAAA,QDGA,EAAA,EAAA,CAAA,CAAA,QLDO,eAAe,EAAsB,CAAc,EACtD,IAAM,EAAO,MAAM,EAAA,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC,CACtC,MAAO,CAAE,GAAI,CAAO,EACpB,QAAS,CACL,UAAW,CAAE,OAAQ,CAAE,IAAI,CAAK,CAAE,EAClC,aAAc,CAAE,QAAS,CAAE,eAAe,CAAK,CAAE,CACrD,CACJ,GAEA,GAAI,CAAC,EAAM,OAAO,KAQlB,IAAI,EAAc,EAAK,cAAc,CAAG,EAAI,EAAK,cAAc,CAAG,EAAI,EAEtE,CAFyE,EAErE,EAAK,GAFuE,MAE9D,CAAC,MAAM,CAAG,EAAG,CAE3B,IAAM,EAAc,MAAM,EAAA,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CAC3C,MAAO,CACH,UAAW,CAAE,KAAM,CAAE,GAAI,CAAE,GAAI,EAAK,SAAS,CAAC,GAAG,CAAC,GAAK,EAAE,EAAE,CAAE,CAAE,CAAE,EACjE,OAAQ,YACR,YAAa,CAAE,IAAK,IAAK,CAC7B,EACA,KAAM,GACN,QAAS,CAAE,YAAa,MAAO,EAC/B,OAAQ,CAAE,eAAgB,GAAM,aAAa,EAAM,WAAW,EAAM,aAAa,CAAK,CAC1F,GAEA,GAAI,EAAY,MAAM,CAAG,EAAG,CAGxB,IAAI,EAAc,EACd,EAAe,EAEnB,EAAY,OAAO,CAAC,IACZ,EAAE,cAAc,CAAG,GAAK,EAAE,WAAW,CAAG,GAAG,CAC3C,GAAgB,EAAE,WAAW,CAAG,EAAE,cAAc,CAChD,IAER,GAEA,IAAM,EAAiB,EAAe,EAAK,EAAc,EAAgB,GAGrE,EAH0E,CAGrE,cAAc,CAAG,GAAG,CACzB,EAAe,EAAK,MAJoF,QAItE,CAAG,GAAkB,CAE/D,CACJ,CAHsE,AAOtE,IAAI,EAAqB,IAAI,KACzB,GAAiB,EAErB,GAAI,EAAK,YAAY,AAVsF,CAUrF,MAAM,CAAG,EAAG,CAC9B,IAAI,EAAmB,IAAI,KAC3B,IAAK,IAAM,KAAO,EAAK,YAAY,CAAE,CACjC,IAAM,EAAK,EAAI,aAAa,CAC5B,GAAkB,cAAd,EAAG,MAAM,EAAoB,CAAC,EAAG,YAAY,CAAE,CAG/C,IAAM,EAAU,EAAG,OAAO,CAAG,IAAI,KAAK,EAAG,OAAO,EAAI,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,IAAI,KAAQ,GACpE,EAAU,IAAkB,EAAmB,CAAA,EACnD,GAAiB,CACrB,CACJ,CACI,EAAmB,IACnB,EAAqB,CAAA,CAE7B,CAEA,IAAM,EAAgB,AC/CnB,KD0C4C,IC1CnB,AAAhB,CAAoB,CAAE,CAAM,EAAS,EACnD,IAAM,EAAQ,CAAA,EAAA,EAAA,MAAA,AAAM,EAAC,OAAM,GACrB,EAAmB,EAAU,EADC,KACM,AAFE,GAI5C,GAAI,MAAM,GAAS,MAAO,CAAA,EAAA,EAAA,aAAA,AAAa,OAAC,EAAa,KAErD,EAFiD,EAE3C,EAAQ,EAAM,QAAQ,GACtB,EAAO,EAAS,EAAI,CAAC,EAAI,EACzB,EAAY,KAAK,KAAK,CAAC,EAAS,GAEtC,EAAM,OAAO,CAAC,EAAM,OAAO,GAAiB,EAAZ,GAGhC,IAAI,EAAW,KAAK,GAAG,CAAC,EAAS,GAGjC,KAAO,EAAW,EAAG,CACnB,EAAM,OAAO,CAAC,EAAM,OAAO,GAAK,GAC5B,AAAC,EAAU,OAAO,IAAU,KAAY,EAM1C,GAAoB,EAAU,OAAO,IAAuB,GAAG,CAAd,IC/BP,IAAvC,CAAA,EAAA,EAAA,MAAA,AAAM,EAAC,ADkCG,OClCG,ADkCI,GClCS,MAAM,AAAV,IDmCzB,EAAM,OAAO,CAAC,EAAM,OAAO,IAAM,CAAD,CAAQ,EAAI,EAAI,EAAC,CAAC,EEnCR,IAAvC,CAAA,EAAA,EAAA,MAAA,AAAM,EAAC,AFoCC,OEpCK,AFoCE,GEpCW,MAAJ,AAAU,IFqCnC,EAAM,OAAO,CAAC,EAAM,OAAO,IAAM,CAAD,CAAQ,EAAI,EAAI,EAAC,CAAC,GAMtD,OAFA,EAAM,QAAQ,CAAC,GAER,CACT,EDU0C,EAAoB,KAAK,IAAI,CAAC,IAGhE,EAAa,GACX,EAAoB,EAAE,CAExB,IACA,GAAc,GACd,EAAQ,IAFQ,AAEJ,CAAC,kCAGb,EAAK,OAAO,EAAI,EAAgB,EAAK,OAAO,EAAE,AAC9C,EAAQ,IAAI,CAAC,sCAGa,GAAG,CAA7B,EAAK,SAAS,CAAC,MAAM,GACrB,GAAc,GACd,EAAQ,IAAI,CAAC,kCAGjB,IAAI,EAAY,MAOhB,OANI,EAAK,OAAO,EAAI,EAAgB,EAAK,OAAO,EAAE,CAE3B,EKzCpB,ALyCK,AADc,SKxCV,AAAyB,CAAS,CAAE,CAAW,EAAS,EACtE,GAAM,CAAC,EAAY,EAAa,CAAG,CAAA,EAAA,EAAA,cAAA,AAAc,EAC/C,OACA,EADS,AAET,GAGF,GAAI,CAAC,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,IAAe,CAAC,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,GAAe,OAAO,IAE3D,IAAM,EAAO,CAAA,EAAA,EAAA,wBAAA,AAAwB,EAAC,EAAY,GAC5C,EAAO,EAAO,EAAI,CAAC,EAAI,EACvB,EAAQ,KAAK,KAAK,CAAC,EAAO,GAE5B,EAAiB,EAAR,EACT,EAAa,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,EAAsB,EAAR,GAGvC,KAAO,CC1CF,AD0CG,SC1CM,AAAU,CAAS,CAAE,CAAW,CAAE,CAAO,EACvD,GAAM,CAAC,EAAW,EAAW,CAAG,CAAA,EAAA,EAAA,cAAA,AAAc,OAC5C,EACA,EACA,GAEF,EAJW,IAIJ,CAAC,CAAA,EAAA,EAAA,UAAU,AAAV,EAAW,IAAe,CAAC,CAAA,EAAA,EAAA,UAAA,AAAU,EAAC,EAChD,EDmCoB,EAAY,IAE5B,GAAU,EAAU,GAFqB,IAjBoB,GAmBlB,EAAX,AAAe,EAC/C,EAAa,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,EAAY,GAInC,OAAkB,IAAX,EAAe,EAAI,CAC5B,ELemD,EAAe,EAAK,OAAO,EACtD,EAAe,OACd,UAGd,QACH,gBACA,YACA,aACA,EACA,YAAa,EAAQ,IAAI,CAAC,OAAS,gCACvC,CACJ,CO9GA,IAAA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QAEO,eAAe,EAAqB,CAAiB,EAExD,GAAI,CADY,AACX,MADiB,CAAA,EAAA,EAAA,gBAAA,AAAgB,EAAC,EAAA,WAAW,EACpC,MAAO,CAAE,MAAO,cAAe,EAE7C,GAAI,CACA,IAAM,EAAY,MAAM,QAAQ,GAAG,CAC/B,EAAQ,GAAG,CAAC,MAAO,IACf,IAAM,EAAa,MAAM,EAAsB,GAC/C,MAAO,CAAE,OAAQ,aAAI,CAAW,CACpC,IAIE,EAAmC,CAAC,EAK1C,OAJA,EAAU,OAAO,CAAC,IACd,CAAW,CAAC,EAAE,MAAM,CAAC,CAAG,EAAE,UAAU,AACxC,GAEO,CAAE,SAAS,EAAM,KAAM,CAAY,CAC9C,CAAE,MAAO,EAAG,CAER,OADA,QAAQ,KAAK,CAAC,0BAA2B,GAClC,CAAE,MAAO,0BAA2B,CAC/C,CACJ,2CAvBsB,IAAA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,4FCJtB,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,qBAEA,IAAM,EAAmB,EAAA,CAAC,CAAC,MAAM,CAAC,CAC9B,UAAW,EAAA,CAAC,CAAC,MAAM,CAAC,MAAM,GAC1B,OAAQ,EAAA,CAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAI,wCAC/B,GAEO,eAAe,EAAkB,CAAkB,EACtD,IAAM,EAAU,MAAM,CAAA,EAAA,EAAA,gBAAA,AAAgB,EAAC,EAAA,WAAW,EAClD,GAAI,CAAC,EAAS,MAAO,CAAE,MAAO,cAAe,EAE7C,IAAM,EAAY,EAAS,GAAG,CAAC,aACzB,EAAS,EAAS,GAAG,CAAC,UAEtB,EAAY,EAAiB,SAAS,CAAC,WAAE,EAAW,QAAO,GAEjE,GAAI,CAAC,EAAU,OAAO,CAClB,CADoB,KACb,CAAE,MAAO,oBAAqB,QAAS,EAAU,KAAK,CAAC,MAAM,EAAG,EAG3E,GAAI,CAEA,IAAM,EAAU,MAAM,EAAA,MAAM,CAAC,OAAO,CAAC,UAAU,CAAC,CAC5C,MAAO,CAAE,GAAI,EAAU,IAAI,CAAC,SAAS,AAAC,EACtC,QAAS,CACL,gBAAgB,EAChB,cAAc,EACd,aAAc,CACV,QAAS,CACL,KAAM,CACF,QAAS,CACL,UAAU,EACV,QAAS,EACb,CACJ,CACJ,CACJ,CACJ,CACJ,GAEA,GAAI,CAAC,EACD,MAAO,CADG,AACD,MAAO,mBAAoB,EAGxC,IAAM,EAAS,SAAS,EAAQ,IAAI,CAAC,EAAE,EAGjC,EAAgB,MAAM,CAAA,EAAA,EAAA,8BAAA,AAA8B,EACtD,EACA,qBACA,EAAU,IAAI,CAAC,SAAS,EAItB,EAAO,EAAQ,gBAAgB,GAAK,GAAU,EAAQ,WAAW,GAAK,EAE5E,GAAI,CAAC,GAAiB,CAAC,EACnB,IADyB,EAClB,CAAE,MAAO,wEAAyE,EAI7F,IAAM,EAAiB,MAAM,EAAA,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC,CAC/C,MAAO,CAAE,GAAI,EAAU,IAAI,CAAC,SAAS,AAAC,EACtC,KAAM,CACF,SAAU,SACV,aAAc,EAAU,IAAI,CAAC,MAAM,CACnC,eAAgB,IAAI,KACpB,iBAAkB,CACtB,EACA,QAAS,CACL,gBAAgB,EAChB,aAAc,CACV,OAAQ,CACJ,QAAQ,CACZ,CACJ,EACA,aAAc,CACV,QAAS,CACL,KAAM,CACF,OAAQ,CACJ,YAAY,EACZ,QAAS,CACL,OAAQ,CACJ,QAAQ,CACZ,CACJ,CACJ,CACJ,CACJ,CACJ,CACJ,CACJ,GAGM,EAAgB,IAAI,IAGtB,EAAe,gBAAgB,EAAE,AACjC,EAAc,GAAG,CAAC,EAAe,gBAAgB,EAIrD,EAAe,YAAY,CAAC,OAAO,CAAC,IAChC,EAAc,GAAG,CAAC,EAAG,MAAM,CAC/B,GAGA,EAAe,YAAY,CAAC,OAAO,CAAC,IAC5B,EAAG,IAAI,CAAC,UAAU,EAAE,AACpB,EAAc,GAAG,CAAC,EAAG,IAAI,CAAC,UAAU,EAGxC,EAAG,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,IACpB,EAAc,GAAG,CAAC,EAAO,MAAM,CACnC,EACJ,GAOA,CAJe,MAAM,EAAA,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CACtC,MAAO,CAAE,KAAM,OAAQ,EACvB,OAAQ,CAAE,IAAI,CAAK,CACvB,EAAA,EACO,OAAO,CAAC,GAAS,EAAc,GAAG,CAAC,EAAM,EAAE,GAGlD,IAAM,EAAuB,MAAM,IAAI,CAAC,GAAe,GAAG,CAAC,GACvD,CAAA,EAAA,EAAA,yBAAyB,AAAzB,EACI,EAAU,IAAI,CAAC,SAAS,CACxB,EACA,CACI,KAAM,iBACN,WAAY,UACZ,SAAU,EAAU,IAAI,CAAC,SAAS,CAClC,MAAO,CAAC,WAAW,EAAE,EAAe,IAAI,CAAA,CAAE,CAC1C,QAAS,CAAC,gDAAgD,EAAE,EAAU,IAAI,CAAC,MAAM,CAAA,CAAE,CACnF,eAAe,EACf,UAAU,EACV,wBAAwB,CAC5B,IA2BR,OAvBA,MAAM,QAAQ,GAAG,CAAC,GAGlB,MAAM,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,CACd,WAAY,wBACZ,eAAgB,UAChB,cAAe,CAAC,SAAS,EAAE,EAAe,IAAI,CAAC,kBAAkB,CAAC,CAClE,cAAe,CACX,UAAW,EAAe,EAAE,CAC5B,YAAa,EAAe,IAAI,CAChC,OAAQ,EAAU,IAAI,CAAC,MAAM,CAC7B,cAAe,MAAM,IAAI,CAAC,GAAe,MAAM,AACnD,EACA,cAAe,EACf,UAAW,EAAU,IAAI,CAAC,SAAS,CACnC,WAAY,UACZ,SAAU,EAAU,IAAI,CAAC,SAC7B,AADsC,GAGtC,CAAA,EAAA,EAAA,cAAc,AAAd,EAAe,CAAC,oBAAoB,EAAE,EAAU,IAAI,CAAC,SAAS,CAAA,CAAE,EAChE,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,cACf,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,uBAER,CAAE,SAAS,EAAM,QAAS,CAAe,CACpD,CAAE,MAAO,EAAY,CAEjB,OADA,QAAQ,KAAK,CAAC,mCAAoC,GAC3C,CAAE,MAAO,mCAAoC,QAAS,EAAM,OAAO,AAAC,CAC/E,CACJ,CAEO,eAAe,EAAyB,CAAiB,EAC5D,IAAM,EAAU,MAAM,CAAA,EAAA,EAAA,gBAAA,AAAgB,EAAC,EAAA,WAAW,EAClD,GAAI,CAAC,EAAS,MAAO,CAAE,MAAO,cAAe,EAE7C,IAAM,EAAS,SAAS,EAAQ,IAAI,CAAC,EAAE,EAEvC,GAAI,CACA,IAAM,EAAU,MAAM,EAAA,MAAM,CAAC,OAAO,CAAC,UAAU,CAAC,CAC5C,MAAO,CAAE,GAAI,CAAU,CAC3B,GAEA,GAAI,CAAC,EACD,MAAO,CADG,AACD,MAAO,mBAAoB,EAGxC,GAAyB,UAAU,CAA/B,EAAQ,QAAQ,CAChB,MAAO,CAAE,MAAO,iCAAkC,EAoDtD,OAhDA,MAAM,EAAA,MAAM,CAAC,4BAA4B,CAAC,MAAM,CAAC,CAC7C,MAAO,CACH,iBAAkB,CACd,UAAW,EACX,OAAQ,CACZ,CACJ,EACA,OAAQ,CACJ,UAAW,EACX,OAAQ,CACZ,EACA,OAAQ,CACJ,eAAgB,IAAI,IACxB,CACJ,GAGA,MAAM,EAAA,MAAM,CAAC,mBAAmB,CAAC,UAAU,CAAC,CACxC,MAAO,CACH,UAAW,EACX,OAAQ,EACR,UAAU,EACV,wBAAwB,CAC5B,EACA,KAAM,CACF,eAAgB,IAAI,KACpB,QAAQ,CACZ,CACJ,GAGA,MAAM,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,CACd,WAAY,8BACZ,eAAgB,UAChB,cAAe,CAAC,6BAA6B,EAAE,EAAQ,IAAI,CAAC,CAAC,CAAC,CAC9D,cAAe,CACX,UAAW,EAAQ,EAAE,CACrB,YAAa,EAAQ,IAAI,AAC7B,EACA,cAAe,EACf,UAAW,EACX,WAAY,UACZ,SAAU,CACd,GAEA,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,CAAC,oBAAoB,EAAE,EAAA,CAAW,EACjD,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,cAER,CAAE,SAAS,CAAK,CAC3B,CAAE,MAAO,EAAY,CAEjB,OADA,QAAQ,KAAK,CAAC,sCAAuC,GAC9C,CAAE,MAAO,uCAAwC,QAAS,EAAM,OAAO,AAAC,CACnF,CACJ,CAEO,eAAe,EAAqB,CAAiB,EACxD,IAAM,EAAU,MAAM,CAAA,EAAA,EAAA,gBAAA,AAAgB,EAAC,EAAA,WAAW,EAClD,GAAI,CAAC,EAAS,MAAO,CAAE,MAAO,cAAe,EAE7C,IAAM,EAAS,SAAS,EAAQ,IAAI,CAAC,EAAE,EAEvC,GAAI,CACA,IAAM,EAAU,MAAM,EAAA,MAAM,CAAC,OAAO,CAAC,UAAU,CAAC,CAC5C,MAAO,CAAE,GAAI,CAAU,CAC3B,GAEA,GAAI,CAAC,EACD,MAAO,CAAE,AADC,MACM,mBAAoB,EAIxC,IAAM,EAAgB,MAAM,CAAA,EAAA,EAAA,8BAAA,AAA8B,EACtD,EACA,uBACA,GAIE,EAAO,EAAQ,gBAAgB,GAAK,GAAU,EAAQ,WAAW,GAAK,EAE5E,GAAI,CAAC,GAAiB,CAAC,EACnB,IADyB,EAClB,CAAE,MAAO,qFAAsF,EA6C1G,OAzCA,MAAM,EAAA,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC,CACxB,MAAO,CAAE,GAAI,CAAU,EACvB,KAAM,CACF,SAAU,SACV,aAAc,KACd,eAAgB,KAChB,iBAAkB,IACtB,CACJ,GAGA,MAAM,EAAA,MAAM,CAAC,mBAAmB,CAAC,UAAU,CAAC,CACxC,MAAO,CACH,UAAW,EACX,UAAU,CACd,EACA,KAAM,CACF,OAAQ,GACR,eAAgB,IAAI,IACxB,CACJ,GAGA,MAAM,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,CACd,WAAY,yBACZ,eAAgB,UAChB,cAAe,CAAC,sCAAsC,EAAE,EAAQ,IAAI,CAAC,CAAC,CAAC,CACvE,cAAe,CACX,UAAW,EAAQ,EAAE,CACrB,YAAa,EAAQ,IAAI,AAC7B,EACA,cAAe,EACf,UAAW,EACX,WAAY,UACZ,SAAU,CACd,GAEA,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,CAAC,oBAAoB,EAAE,EAAA,CAAW,EACjD,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,cACf,CAAA,EAAA,EAAA,cAAc,AAAd,EAAe,uBAER,CAAE,SAAS,CAAK,CAC3B,CAAE,MAAO,EAAY,CAEjB,OADA,QAAQ,KAAK,CAAC,kCAAmC,GAC1C,CAAE,MAAO,mCAAoC,QAAS,EAAM,OAAO,AAAC,CAC/E,CACJ,CAEO,eAAe,IAClB,IAAM,EAAU,MAAM,CAAA,EAAA,EAAA,gBAAA,AAAgB,EAAC,EAAA,WAAW,EAClD,GAAI,CAAC,EAAS,MAAO,CAAE,MAAO,cAAe,EAE7C,IAAM,EAAS,SAAS,EAAQ,IAAI,CAAC,EAAE,EACjC,EAAW,EAAQ,IAAI,CAAC,IAAI,EAAI,YAGtC,GAAI,CACA,IAAM,EAAa,CACf,SAAU,QACd,CAGI,CAAC,AARoB,SAQX,CARF,IASR,EAAM,EAAE,CAAG,CACP,CAAE,iBAAkB,CAAO,EAC3B,CAAE,YAAa,CAAO,EACtB,CAAE,aAAc,CAAE,KAAM,QAAE,CAAO,CAAE,CAAE,EACrC,CAAE,aAAc,CAAE,KAAM,CAAE,KAAM,CAAE,WAAY,CAAO,CAAE,CAAE,CAAE,EAC3D,CAAE,aAAc,CAAE,KAAM,CAAE,KAAM,CAAE,QAAS,CAAE,KAAM,QAAE,CAAO,CAAE,CAAE,CAAE,CAAE,CAAE,EACzE,EAGL,IAAM,EAAW,MAAM,EAAA,MAAM,CAAC,OAAO,CAAC,QAAQ,CAAC,CAC3C,QACA,QAAS,CACL,eAAgB,CACZ,OAAQ,CACJ,IAAI,EACJ,UAAU,EACV,WAAW,CACf,CACJ,EACA,eAAgB,CACZ,OAAQ,CACJ,IAAI,EACJ,UAAU,CACd,CACJ,EACA,sBAAuB,CACnB,MAAO,CAAE,QAAO,EAChB,OAAQ,CACJ,gBAAgB,CACpB,CACJ,CACJ,EACA,QAAS,CAAE,eAAgB,MAAO,CACtC,GAEA,MAAO,CAAE,SAAS,WAAM,CAAS,CACrC,CAAE,MAAO,EAAY,CAEjB,OADA,QAAQ,KAAK,CAAC,kCAAmC,GAC1C,CAAE,MAAO,kCAAmC,QAAS,EAAM,OAAO,AAAC,CAC9E,CACJ,CAEO,eAAe,EAAsB,CAAiB,EACzD,IAAM,EAAU,MAAM,CAAA,EAAA,EAAA,gBAAA,AAAgB,EAAC,EAAA,WAAW,EAClD,GAAI,CAAC,EAAS,MAAO,GAErB,IAAM,EAAS,SAAS,EAAQ,IAAI,CAAC,EAAE,EAEvC,GAAI,CAUA,MAAO,CAAC,CATe,AASd,MAToB,EAAA,MAAM,CAAC,4BAA4B,CAAC,UAAU,CAAC,CACxE,MAAO,CACH,iBAAkB,WACd,SACA,CACJ,CACJ,CACJ,EAGJ,CAAE,MAAO,EAAO,CAEZ,OADA,QAAQ,KAAK,CAAC,iCAAkC,IACzC,CACX,CACJ,iCA5YsB,EAqKA,EA2EA,EA8EA,EAyDA,IAvXA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MAqKA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MA2EA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MA8EA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MAyDA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,gQCjYtB,IAAM,EAAuE,CAE3E,aAAc,CAAE,IAAK,MAAO,QAAS,IAAI,GAAY,EACrD,EADgD,UACnC,CAAE,IAAK,MAAO,QAAS,IAAI,GAAY,EACpD,EAD+C,WACjC,CAAE,IAAK,OAAQ,QAAS,IAAI,GAAY,EACtD,EADiD,UACpC,CAAE,IAAK,MAAO,QAAS,IAAI,GAAY,EACpD,EAD+C,cAC9B,CAAE,IAAK,MAAO,QAAS,IAAI,GAAY,EAGxD,EAHmD,gBAGhC,CAAE,IAAK,MAAO,QAAS,KAAK,GAAY,EAC3D,EADsD,mBAChC,CAAE,IAAK,MAAO,QAAS,KAAK,GAAY,EAC9D,EADyD,wEACkB,CACzE,IAAK,OACL,QAAS,KAAK,GAChB,EACA,EAFuB,yBAEK,CAAE,IAAK,MAAO,QAAS,KAAK,GAAY,EACpE,EAD+D,kEACM,CACnE,IAAK,OACL,QAAS,KAAK,GAChB,EACA,EAFuB,WAET,CAAE,IAAK,MAAO,QAAS,IAAI,GAAY,EACrD,EADgD,SACpC,CAAE,IAAK,MAAO,QAAS,IAAI,GAAY,CACrD,EAGM,CAJ0C,CAInB,CAC3B,MACA,MACA,MACA,MACA,MACA,MACA,KACA,MACA,MACA,MACA,KACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,KACA,OACA,MACA,MACA,OACA,MACA,OACA,SACA,UACA,OACA,OACA,OACA,UACA,OACA,OACA,UACA,OACA,MACA,MACA,OACA,OACA,OACA,MACA,OACA,OACA,MACA,MACA,OACA,MACA,MACA,KACA,MACA,MACA,KACA,MACA,MACA,KACA,MACA,MACA,MACA,IACA,MACA,MACA,KACA,IACA,MACA,KACA,OACA,QACA,QACA,KACA,KACA,KACA,KACA,MACA,MACD,CAyBM,SAAS,EAAmB,CAAU,EAC3C,GAAI,CAAC,EACH,IADS,EACF,CACL,OAAO,EACP,MAAO,kBACT,EAIF,GAAI,CAAC,EAAK,IAAI,EAAyB,IAAI,CAAzB,EAAK,IAAI,CAAC,IAAI,GAC9B,MAAO,CACL,OAAO,EACP,MAAO,uBACT,EAIF,GAAI,CAAC,CAAkB,CAAC,EAAK,IAAI,CAAC,CAAE,CAClC,IAAM,EAAe,OAAO,IAAI,CAAC,GAAoB,IAAI,CAAC,MAC1D,MAAO,CACL,OAAO,EACP,MAAO,CAAC,WAAW,EAAE,EAAK,IAAI,EAAI,UAAU,mCAAmC,EAAE,EAAA,CAAc,AACjG,CACF,CAGA,IAAM,EAAU,CAAkB,CAAC,EAAK,IAAI,CAAC,CAAC,OAAO,CACrD,GAAkB,GAAG,CAAjB,EAAK,IAAI,CACX,MAAO,CACL,MAAO,GACP,MAAO,eACT,EAGF,GAAI,EAAK,IAAI,CAAG,EAAS,CACvB,IAAM,EAAY,CAAC,EAAU,KAAO,IAAA,CAAI,CAAE,OAAO,CAAC,GAC5C,EAAa,CAAC,EAAK,IAAI,CAAG,KAAO,IAAA,CAAI,CAAE,OAAO,CAAC,GACrD,MAAO,CACL,OAAO,EACP,MAAO,CAAC,UAAU,EAAE,EAAW,mBAAmB,EAAE,EAAU,qBAAqB,CAAC,AACtF,CACF,CAGA,IAAM,EAAM,EAAiB,EAAK,IAAI,EAAE,WAAW,GACnD,GAAI,GAAO,EAAqB,QAAQ,CAAC,GACvC,GAD6C,GACtC,CACL,OAAO,EACP,MAAO,CAAC,iBAAiB,EAAE,EAAI,qCAAqC,CAAC,AACvE,EAIF,IAAM,EAAc,CAAkB,CAAC,EAAK,IAAI,CAAC,CAAC,GAAG,CAQrD,OAPI,GAAO,IAAQ,GAEjB,QAAQ,EAFsB,EAElB,CACV,CAAC,0BAA0B,EAAE,EAAI,2BAA2B,EAAE,EAAK,IAAI,CAAC,eAAe,EAAE,EAAY,CAAC,CAAC,EAIpG,CAAE,OAAO,CAAK,CACvB,CAQO,SAAS,EAAiB,CAAgB,SAC/C,AAAK,EAGH,EAHE,AAIC,MAJU,CAIH,CAAC,MAAO,IAAI,AACnB,OAAO,CAAC,MAAO,IAAI,AACnB,GAFwC,IAEjC,CAAC,QAAS,IACjB,AADqB,KADuB,EAErC,CAAC,SAD8B,aACP,IAAI,AACnC,OAAO,CAAC,OAAQ,KAAK,AACrB,SAAS,CAAC,EAAG,IAF0D,CAErD,AATD,MAWxB,CASO,SAAS,EAAqB,CAAoB,CAAE,AAZM,CAYQ,EACvE,CAZ+C,GAYzC,EAAM,EAAiB,GACvB,EAAY,KAAK,GAAG,GACpB,EAAS,KAAK,MAAM,GAAG,QAAQ,CAAC,IAAI,SAAS,CAAC,EAAG,GAGvD,MAAO,CAAC,CAAC,EAAE,EAAO,CAAC,EAAE,EAAU,CAAC,EAAE,EAAO,CAAC,EAAE,EAAA,CAAK,AACnD,CAQA,SAAS,EAAiB,CAAgB,EACxC,GAAI,CAAC,EAAU,MAAO,GACtB,IAAM,EAAQ,EAAS,KAAK,CAAC,KAC7B,OAAO,EAAM,MAAM,CAAG,EAAI,CAAK,CAAC,EAAM,MAAM,CAAG,EAAE,CAAG,EACtD,CAUO,eAAe,EAAoB,CAAmB,CAAE,CAAgB,EAU7E,IAAM,EARyC,AAQjC,CAPZ,aAAc,CAAC,IAAM,IAAM,IAAK,CAChC,YAAa,CAAC,IAAM,GAAM,GAAM,GAAK,CACrC,YAAa,CAAC,GAAM,GAAM,GAAK,CAC/B,aAAc,CAAC,GAAM,GAAM,GAAM,GAAK,CACtC,kBAAmB,CAAC,GAAM,GAAM,GAAM,GAAK,AAC7C,CAE0B,CAAC,EAAS,CACpC,GAAI,CAAC,EAAO,OAAO,EAEnB,GAFwB,CAElB,EAAQ,IAAI,WAAW,GAG7B,GAAI,EAAM,MAAM,CAAG,EAAM,MAAM,CAC7B,CAD+B,MACxB,EAIT,IAAK,CAV2E,GAUvE,EAAI,EAAG,EAAI,EAAM,MAAM,CAAE,IAAK,AACrC,GAAI,CAAK,CAAC,EAAE,GAAK,CAAK,CAAC,EAAE,CACvB,CADyB,KAClB,GAIX,OAAO,CACT,CAQO,SAAS,EAAoB,CAAa,EAC/C,IAAM,EAAQ,CAAC,IAAK,KAAM,KAAM,KAAK,CACjC,EAAO,EACP,EAAY,EAEhB,KAAO,GAAQ,MAAQ,EAAY,EAAM,MAAM,CAAG,EAAG,CACnD,GAAQ,KACR,IAGF,MAAO,CAAA,EAAG,EAAK,OAAO,CAAC,GAAG,CAAC,EAAE,CAAK,CAAC,EAAU,CAAA,CAC/C,AADiD,4LCxSjD,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QA0BO,eAAe,EAAgB,EAAgC,CAAC,CAAC,EACtE,GAAI,CACF,IAAM,EAAU,MAAM,CAAA,EAAA,EAAA,gBAAgB,AAAhB,EAAiB,EAAA,WAAW,EAClD,GAAI,CAAC,GAAS,MAAM,GAClB,CADsB,KACf,CAAE,SAAS,EAAO,MAAO,cAAe,EAIjD,GAA0B,SAAS,CAA/B,EAAQ,IAAI,CAAC,IAAI,CACnB,MAAO,CAAE,SAAS,EAAO,MAAO,4BAA6B,EAG/D,GAAM,OACJ,EAAQ,EAAE,QACV,EAAS,CAAC,WACV,CAAS,CACT,SAAO,QACP,CAAM,WACN,CAAS,UACT,CAAQ,CACR,YAAU,QACV,CAAM,CACP,CAAG,EAEE,EAAa,CAAC,GAGhB,GAAa,CAAA,GAAS,CACxB,EAAM,SAAS,CAAG,CAAC,EACf,IACF,EAAM,KADO,IACE,CAAC,GAAG,CAAG,CAAA,EAEpB,IACF,EAAM,GADK,MACI,CAAC,GAAG,CAAG,CAAA,GAKtB,GACF,GAAM,EADI,WACS,CAAG,CAAA,EAIpB,IACF,EAAM,KADO,IACE,CAAG,CAAA,EAIhB,IACF,EAAM,IADM,UACQ,CAAG,CAAA,EAIrB,GACF,GAAM,MADQ,IACE,CAAG,CAAA,EAKjB,GAAU,EAAO,IAAI,IAAI,CAC3B,EAAM,EAAE,CAAG,CACT,CAAE,cAAe,CAAE,SAAU,EAAO,IAAI,EAAG,CAAE,EAC7C,CAAE,cAAe,CAAE,SAAU,EAAO,IAAI,EAAG,CAAE,EAC7C,CAAE,WAAY,CAAE,SAAU,EAAO,IAAI,EAAG,CAAE,EAC3C,EAIH,IAAI,EAAc,EAAE,CAChB,EAAQ,EAEZ,GAAI,CACF,GAAM,CAAC,EAAY,EAAY,CAAG,MAAM,QAAQ,GAAG,CAAC,CAClD,EAAA,MAAM,CAAC,WAAW,CAAC,QAAQ,CAAC,OAC1B,EACA,QAAS,CACP,YAAa,CACX,OAAQ,CACN,IAAI,EACJ,UAAU,EACV,OAAO,EACP,KAAM,EACR,CACF,EACA,aAAc,CACZ,OAAQ,CACN,GAAI,GACJ,UAAU,EACV,OAAO,CACT,CACF,EACA,QAAS,CACP,OAAQ,CACN,IAAI,EACJ,KAAM,EACR,CACF,CACF,EACA,QAAS,CAAE,UAAW,MAAO,EAC7B,KAAM,EACN,KAAM,CACR,GACA,EAAA,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,CAAE,OAAM,GAClC,EACD,EAAO,EACP,EAAQ,CACV,CAAE,MAAO,EAAY,CAEnB,GAAI,EAAM,OAAO,EAAE,SAAS,gBAAiC,UAAf,EAAM,IAAI,CAAc,CACpE,QAAQ,IAAI,CAAC,6DACb,GAAM,CAAC,EAAY,EAAY,CAAG,MAAM,QAAQ,GAAG,CAAC,CAClD,EAAA,MAAM,CAAC,WAAW,CAAC,QAAQ,CAAC,OAC1B,EACA,QAAS,CAAE,UAAW,MAAO,EAC7B,KAAM,EACN,KAAM,CACR,GACA,EAAA,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,OAAE,CAAM,GAClC,EACD,EAAO,EAAW,GAAG,CAAC,AAAC,IAAc,CACnC,CADkC,EAC/B,CAAG,CACN,YAAa,EAAI,MAAM,CAAG,CAAE,GAAI,EAAI,MAAM,CAAE,SAAU,UAAW,MAAO,GAAI,KAAM,EAAG,EAAI,KACzF,aAAc,KACd,QAAS,KACX,CAAC,EACD,EAAQ,CACV,MACE,CADK,KACC,CAEV,CAEA,MAAO,CACL,SAAS,OACT,QACA,QACA,SACA,CACF,CACF,CAAE,MAAO,EAAY,CAEnB,OADA,QAAQ,KAAK,CAAC,gCAAiC,GACxC,CACL,SAAS,EACT,MAAO,GAAO,SAAW,+BAC3B,CACF,CACF,CAKO,eAAe,EAAmB,CAAU,EACjD,GAAI,CACF,IAAM,EAAU,MAAM,CAAA,EAAA,EAAA,gBAAA,AAAgB,EAAC,EAAA,WAAW,EAClD,GAAI,CAAC,GAAS,MAAM,GAClB,CADsB,KACf,CAAE,SAAS,EAAO,MAAO,cAAe,EAIjD,GAA0B,SAAS,CAA/B,EAAQ,IAAI,CAAC,IAAI,CACnB,MAAO,CAAE,SAAS,EAAO,MAAO,4BAA6B,EAG/D,IAAM,EAAM,MAAM,EAAA,MAAM,CAAC,WAAW,CAAC,UAAU,CAAC,CAC9C,MAAO,IAAE,CAAG,EACZ,QAAS,CACP,YAAa,CACX,OAAQ,CACN,IAAI,EACJ,UAAU,EACV,OAAO,EACP,MAAM,CACR,CACF,EACA,aAAc,CACZ,OAAQ,CACN,IAAI,EACJ,UAAU,EACV,OAAO,CACT,CACF,EACA,QAAS,CACP,OAAQ,CACN,GAAI,GACJ,MAAM,CACR,CACF,CACF,CACF,GAEA,GAAI,CAAC,EACH,GADQ,GACD,CAAE,SAAS,EAAO,MAAO,wBAAyB,EAG3D,MAAO,CACL,SAAS,EACT,KACF,CACF,CAAE,MAAO,EAAY,CAEnB,OADA,QAAQ,KAAK,CAAC,+BAAgC,GACvC,CACL,SAAS,EACT,MAAO,GAAO,SAAW,8BAC3B,CACF,CACF,CAKO,eAAe,EAAoB,CAAgB,CAAE,CAAc,EACxE,GAAI,CACF,IAAM,EAAU,MAAM,CAAA,EAAA,EAAA,gBAAA,AAAgB,EAAC,EAAA,WAAW,EAClD,GAAI,CAAC,GAAS,MAAM,GAClB,CADsB,KACf,CAAE,SAAS,EAAO,MAAO,cAAe,EAIjD,GAA0B,SAAS,CAA/B,EAAQ,IAAI,CAAC,IAAI,CACnB,MAAO,CAAE,QAAS,GAAO,MAAO,4BAA6B,EAG/D,IAAM,EAAa,CAAC,EAChB,IAAa,CAAA,GAAS,CACxB,EAAM,SAAS,CAAG,CAAC,EACf,IACF,EAAM,KADO,IACE,CAAC,GAAG,CAAG,CAAA,EAEpB,GACF,GAAM,GADK,MACI,CAAC,GAAG,CAAG,CAAA,GAI1B,GAAM,CAAC,EAAW,EAAY,EAAQ,EAAe,CAAG,MAAM,QAAQ,GAAG,CAAC,CACxE,EAAA,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,OAAE,CAAM,GACjC,EAAA,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,CACzB,GAAI,CAAC,iBAAiB,OACtB,EACA,QAAQ,CACV,GACA,EAAA,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,CACzB,GAAI,CAAC,gBAAgB,CACrB,QACA,QAAQ,EACR,QAAS,CAAE,OAAQ,CAAE,cAAe,MAAO,CAAE,EAC7C,KAAM,EACR,GACA,EAAA,MAAM,CAAC,WAAW,CAAC,QAAQ,CAAC,OAC1B,EACA,QAAS,CAAE,UAAW,MAAO,EAC7B,KAAM,GACN,OAAQ,CACN,IAAI,EACJ,YAAY,EACZ,eAAe,EACf,WAAW,EACX,YAAa,CACX,OAAQ,CACN,UAAU,CACZ,CACF,CACF,CACF,GACD,EAED,MAAO,CACL,SAAS,EACT,MAAO,WACL,EACA,WAAY,EAAW,GAAG,CAAC,AAAC,IAAU,CACpC,EADmC,OACzB,EAAK,cAAc,CAC7B,MAAO,EAAK,MAAM,CACpB,CAAC,EACD,OAAQ,EAAO,GAAG,CAAC,AAAC,IAAU,CAC5B,EAD2B,KACnB,EAAK,aAAa,CAC1B,MAAO,EAAK,MAAM,CACpB,CAAC,iBACD,CACF,CACF,CACF,CAAE,MAAO,EAAY,CAEnB,OADA,QAAQ,KAAK,CAAC,qCAAsC,GAC7C,CACL,SAAS,EACT,MAAO,GAAO,SAAW,oCAC3B,CACF,CACF,2CA9RsB,EAsJA,EA2DA,IAjNA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MAsJA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MA2DA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,6DC/OtB,IAAA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QAGA,EAAA,EAAA,CAAA,CAAA,QAMA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QAOA,EAAA,EAAA,CAAA,CAAA,QAIA,EAAA,EAAA,CAAA,CAAA,QAEA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QAOA,EAAA,EAAA,CAAA,CAAA,QAEA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,oBCjCA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QAEA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,sBASA,IAAM,EAAa,CAAA,EAAA,EAAA,IAAA,AAAI,EAAC,QAAQ,GAAG,GAAI,SAAU,WAEjD,eAAe,IACT,AAAC,CAAA,EAAA,EAAA,UAAA,AAAU,EAAC,IACd,MAAM,CAAA,EADqB,AACrB,EAAA,KAAA,AAAK,EAAC,EAAY,CAAE,WAAW,CAAK,EAE9C,CAEO,eAAe,EAAkB,CAAkB,EACxD,IAAM,EAAU,MAAM,CAAA,EAAA,EAAA,gBAAA,AAAgB,EAAC,EAAA,WAAW,EAClD,GAAI,CAAC,EAAS,MAAO,CAAE,MAAO,eAAgB,KAAM,cAAe,EAEnE,IAAM,EAAO,EAAS,GAAG,CAAC,QACpB,EAAY,EAAS,GAAG,CAAC,aACzB,EAAS,EAAS,GAAG,CAAC,UAAU,AAEtC,GAAI,CAAC,GAAQ,CAAC,EACZ,MAAO,CAAE,EADc,IACP,cAHyD,qBAGrB,KAAM,gBAAiB,EAG7E,GAAI,CAEF,IAAM,EAAa,CAAA,EAAA,EAAA,kBAAA,AAAkB,EAAC,GACtC,GAAI,CAAC,EAAW,KAAK,CACnB,CADqB,KACd,CACL,MAAO,EAAW,KAAK,EAAI,eAC3B,KAAM,cACR,EAIF,IAAM,EAAQ,MAAM,EAAK,WAAW,GAEpC,GAAI,CADiB,AAChB,MADsB,CAAA,EAAA,EAAA,GACR,gBADQ,AAAmB,EAAC,EAAO,EAAK,IAAI,EAE7D,MAAO,CACL,MAAO,wEACP,KAAM,kBACR,CAGF,OAAM,IAGN,IAAM,EAAe,CAAA,EAAA,EAAA,oBAAA,AAAoB,EACvC,EAAK,IAAI,CACT,SAAS,EAAQ,IAAI,CAAC,EAAE,GAEpB,EAAW,CAAA,EAAA,EAAA,IAAA,AAAI,EAAC,EAAY,GAG5B,EAAS,OAAO,IAAI,CAAC,EAC3B,OAAM,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,EAAU,GAG1B,IAAM,EAAU,CAAC,SAAS,EAAE,EAAA,CAAc,CACpC,EAAa,MAAM,EAAA,MAAM,CAAC,UAAU,CAAC,MAAM,CAAC,CAChD,KAAM,CACJ,SAAU,CAAA,EAAA,EAAA,gBAAA,AAAgB,EAAC,EAAK,IAAI,EACpC,QAAS,EACT,SAAU,EAAK,IAAI,EAAI,KACvB,SAAU,EAAK,IAAI,EAAI,KACvB,OAAQ,EAAS,SAAS,GAAoB,KAC9C,aAAc,SAAS,EAAQ,IAAI,CAAC,EAAE,CACxC,CACF,GAqBA,OAlBA,MAAM,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,CAChB,WAAY,gBACZ,eAAgB,UAChB,cAAe,CAAC,MAAM,EAAE,CAAA,EAAA,EAAA,gBAAA,AAAgB,EAAC,EAAK,IAAI,EAAE,UAAU,CAAC,CAC/D,cAAe,CACb,SAAU,CAAA,EAAA,EAAA,gBAAA,AAAgB,EAAC,EAAK,IAAI,EACpC,SAAU,EAAK,IAAI,CACnB,SAAU,EAAK,IAAI,CACnB,aAAc,EAAW,EAAE,CAC3B,kBAAkB,CACpB,EACA,cAAe,SAAS,EAAQ,IAAI,CAAC,EAAE,EACvC,UAAW,SAAS,GACpB,WAAY,aACZ,SAAU,EAAW,EAAE,AACzB,GAEA,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,CAAC,oBAAoB,EAAE,EAAA,CAAW,EAC1C,CAAE,SAAS,aAAM,EAAY,KAAM,gBAAiB,CAC7D,CAAE,MAAO,EAAY,CAEnB,OADA,QAAQ,KAAK,CAAC,qBAAsB,GAC7B,CACL,MAAO,wBACP,KAAM,gBACN,QAAS,EAAM,OAAO,AACxB,CACF,CACF,CAGO,eAAe,EAAsB,CAAiB,EAE3D,GAAI,CADY,AACX,MADiB,CAAA,EAAA,EAAA,gBAAA,AAAgB,EAAC,EAAA,WAAW,EACpC,MAAO,CAAE,MAAO,cAAe,EAE7C,GAAI,CAOF,IAAM,EAAU,CALF,MAAM,EAAA,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CACvC,MAAO,WAAE,CAAU,EACnB,OAAQ,CAAE,IAAI,CAAK,CACrB,EAAA,EAEsB,GAAG,CAAC,AAAC,GAAM,EAAE,EAAE,EAE/B,EAAc,MAAM,EAAA,MAAM,CAAC,UAAU,CAAC,QAAQ,CAAC,CACnD,MAAO,CACL,GAAI,CACF,CAAE,OAAQ,CAAE,GAAI,CAAQ,CAAE,EAC1B,CAAE,OAAQ,IAAK,EAChB,AACH,EACA,QAAS,CACP,SAAU,CACR,OAAQ,CACN,IAAI,EACJ,SAAU,GACV,UAAW,EACb,CACF,EACA,KAAM,CACJ,OAAQ,CACN,IAAI,EACJ,OAAO,CACT,CACF,CACF,EACA,QAAS,CAAE,WAAY,MAAO,CAChC,GAEA,MAAO,CAAE,SAAS,EAAM,aAAY,CACtC,CAAE,MAAO,EAAY,CAEnB,OADA,QAAQ,KAAK,CAAC,8BAA+B,GACtC,CAAE,MAAO,8BAA+B,QAAS,EAAM,OAAO,AAAC,CACxE,CACF,CAEO,eAAe,EAAiB,CAAoB,CAAE,CAAiB,EAC5E,IAAM,EAAU,MAAM,CAAA,EAAA,EAAA,gBAAA,AAAgB,EAAC,EAAA,WAAW,EAClD,GAAI,CAAC,EAAS,MAAO,CAAE,MAAO,cAAe,EAE7C,GAAI,CACF,IAAM,EAAa,MAAM,EAAA,MAAM,CAAC,UAAU,CAAC,UAAU,CAAC,CACpD,MAAO,CAAE,GAAI,CAAa,CAC5B,GAEA,GAAI,CAAC,EACH,MAAO,CAAE,GADM,GACC,sBAAuB,EAIzC,GACE,EAAW,YAAY,GAAK,SAAS,EAAQ,IAAI,CAAC,EAAE,GAC9B,SACtB,CADA,EAAQ,IAAI,CAAC,IAAI,CAEjB,MAAO,CAAE,MAAO,kDAAmD,EAIrE,GAAI,CACF,IAAM,EAAW,CAAA,EAAA,EAAA,IAAA,AAAI,EAAC,QAAQ,GAAG,GAAI,SAAU,EAAW,OAAO,EACjE,GAAI,CAAA,EAAA,EAAA,UAAA,AAAU,EAAC,GAAW,CACxB,GAAM,QAAE,CAAM,CAAE,CAAG,MAAA,EAAA,CAAA,CAAA,OACnB,OAAM,EAAO,EACf,CACF,CAAE,MAAO,EAAW,CAClB,QAAQ,KAAK,CAAC,iCAAkC,EAElD,CAuBA,OApBA,MAAM,EAAA,MAAM,CAAC,UAAU,CAAC,MAAM,CAAC,CAC7B,MAAO,CAAE,GAAI,CAAa,CAC5B,GAGA,MAAM,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,CAChB,WAAY,eACZ,eAAgB,UAChB,cAAe,CAAC,MAAM,EAAE,EAAW,QAAQ,CAAC,SAAS,CAAC,CACtD,cAAe,CACb,SAAU,EAAW,QAAQ,CAC7B,aAAc,EAAW,EAAE,AAC7B,EACA,cAAe,SAAS,EAAQ,IAAI,CAAC,EAAE,EACvC,UAAW,EACX,WAAY,aACZ,SAAU,CACZ,GAEA,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,CAAC,oBAAoB,EAAE,EAAA,CAAW,EAC1C,CAAE,SAAS,CAAK,CACzB,CAAE,MAAO,EAAY,CAEnB,OADA,QAAQ,KAAK,CAAC,6BAA8B,GACrC,CAAE,MAAO,8BAA+B,QAAS,EAAM,OAAO,AAAC,CACxE,CACF,iCAjMsB,EAyFA,EA6CA,IAtIA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MAyFA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MA6CA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA","ignoreList":[0,1,2,3,4,6,7,8,9,10,11]}