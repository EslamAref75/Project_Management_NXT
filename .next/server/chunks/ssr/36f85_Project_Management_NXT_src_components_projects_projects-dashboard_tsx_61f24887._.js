module.exports=[377273,a=>{"use strict";var b=a.i(295394),c=a.i(313954),d=a.i(401149),e=a.i(489158),f=a.i(920931),g=a.i(760335),h=a.i(66796),i=a.i(682600);function j({value:a,onChange:c,onClear:d}){return(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(g.Search,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,b.jsx)(f.Input,{type:"text",placeholder:"Search projects by name or client...",value:a,onChange:a=>c(a.target.value),className:"pl-10 pr-10"}),a&&(0,b.jsx)(i.Button,{variant:"ghost",size:"icon",className:"absolute right-1 top-1/2 h-7 w-7 -translate-y-1/2",onClick:d,children:(0,b.jsx)(h.X,{className:"h-4 w-4"})})]})}var k=a.i(301209),l=a.i(167764),m=a.i(732378),n=a.i(917710),o=a.i(571529),p=a.i(322695),q=a.i(586561),r=a.i(877103);let s=["planned","active","on_hold","completed","cancelled"];function t({categoryFilter:a,onCategoryChange:c,statusFilter:d,onStatusChange:e,dateRange:f,onDateRangeChange:g,projectManagerFilter:j,onProjectManagerChange:t,users:u,projectTypes:v=[],onClear:w,priorityFilter:x=[]}){let y=a.length>0||d.length>0||x.length>0||f.start||f.end||"all"!==j;return(0,b.jsx)(k.Card,{children:(0,b.jsx)(k.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(l.Label,{className:"text-xs",children:"Category"}),(0,b.jsxs)(p.Popover,{children:[(0,b.jsx)(p.PopoverTrigger,{asChild:!0,children:(0,b.jsxs)(i.Button,{variant:"outline",size:"sm",className:"h-9",children:[(0,b.jsx)(o.Filter,{className:"h-4 w-4 mr-2"}),"Category",a.length>0&&(0,b.jsx)(n.Badge,{variant:"secondary",className:"ml-2",children:a.length})]})}),(0,b.jsx)(p.PopoverContent,{className:"w-56",align:"start",children:(0,b.jsx)("div",{className:"space-y-2",children:0===v.length?(0,b.jsx)("p",{className:"text-sm text-muted-foreground p-2",children:"No project types available"}):v.map(d=>(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(r.Checkbox,{id:`cat-${d.id}`,checked:a.includes(d.name),onCheckedChange:()=>{var b;return b=d.name,void(a.includes(b)?c(a.filter(a=>a!==b)):c([...a,b]))}}),(0,b.jsxs)("label",{htmlFor:`cat-${d.id}`,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 cursor-pointer flex items-center gap-2",children:[d.color&&(0,b.jsx)("div",{className:"h-3 w-3 rounded-full",style:{backgroundColor:d.color}}),d.name]})]},d.id))})})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(l.Label,{className:"text-xs",children:"Status"}),(0,b.jsxs)(p.Popover,{children:[(0,b.jsx)(p.PopoverTrigger,{asChild:!0,children:(0,b.jsxs)(i.Button,{variant:"outline",size:"sm",className:"h-9",children:[(0,b.jsx)(o.Filter,{className:"h-4 w-4 mr-2"}),"Status",d.length>0&&(0,b.jsx)(n.Badge,{variant:"secondary",className:"ml-2",children:d.length})]})}),(0,b.jsx)(p.PopoverContent,{className:"w-56",align:"start",children:(0,b.jsx)("div",{className:"space-y-2",children:s.map(a=>(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(r.Checkbox,{id:`status-${a}`,checked:d.includes(a),onCheckedChange:()=>{d.includes(a)?e(d.filter(b=>b!==a)):e([...d,a])}}),(0,b.jsx)("label",{htmlFor:`status-${a}`,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 capitalize cursor-pointer",children:a.replace("_"," ")})]},a))})})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(l.Label,{className:"text-xs",children:"Date Range"}),(0,b.jsx)(q.DatePickerWithRange,{date:{from:f.start,to:f.end},setDate:a=>{g({start:a?.from,end:a?.to})},className:"w-[240px]"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(l.Label,{className:"text-xs",children:"Project Manager"}),(0,b.jsxs)(m.Select,{value:j,onValueChange:t,children:[(0,b.jsx)(m.SelectTrigger,{className:"w-[180px] h-9",children:(0,b.jsx)(m.SelectValue,{placeholder:"All Managers"})}),(0,b.jsxs)(m.SelectContent,{children:[(0,b.jsx)(m.SelectItem,{value:"all",children:"All Managers"}),u.map(a=>(0,b.jsx)(m.SelectItem,{value:a.id.toString(),children:a.username},a.id))]})]})]}),y&&(0,b.jsx)("div",{className:"flex items-end",children:(0,b.jsxs)(i.Button,{variant:"ghost",size:"sm",onClick:w,children:[(0,b.jsx)(h.X,{className:"h-4 w-4 mr-2"}),"Clear All"]})})]})})})}var u=a.i(533208),v=a.i(104626);function w({viewMode:a,onViewChange:c}){return(0,b.jsxs)("div",{className:"flex items-center gap-1 border rounded-lg p-1",children:[(0,b.jsxs)(i.Button,{variant:"card"===a?"default":"ghost",size:"sm",onClick:()=>c("card"),className:(0,d.cn)("h-8","card"===a&&"bg-primary text-primary-foreground"),children:[(0,b.jsx)(u.LayoutGrid,{className:"h-4 w-4 mr-2"}),"Cards"]}),(0,b.jsxs)(i.Button,{variant:"table"===a?"default":"ghost",size:"sm",onClick:()=>c("table"),className:(0,d.cn)("h-8","table"===a&&"bg-primary text-primary-foreground"),children:[(0,b.jsx)(v.Table,{className:"h-4 w-4 mr-2"}),"Table"]})]})}var x=a.i(443161),y=a.i(646579),z=a.i(38032),A=a.i(484477),A=A,B=a.i(631375),C=a.i(486944),D=a.i(289788),E=a.i(126124),F=a.i(869872),G=a.i(98668),H=a.i(514750),I=a.i(999392),J=a.i(285225),K=a.i(231721),L=a.i(395301);let M=(0,L.createServerReference)("40fdba31998d7a3efe7c944c688cf93002e917af7b",L.callServer,void 0,L.findSourceMapURL,"deleteProject");var N=a.i(34123),O=a.i(504440),P=a.i(205172),Q=a.i(47065);function R({projects:a,total:c,page:d,limit:f,onPageChange:g,onProjectDeleted:h}){let i=Math.ceil(c/f),{data:j}=(0,K.useSession)();return((0,e.useRouter)(),0===a.length)?(0,b.jsxs)("div",{className:"flex min-h-[400px] flex-col items-center justify-center rounded-md border border-dashed p-8 text-center",children:[(0,b.jsx)("div",{className:"mx-auto flex h-12 w-12 items-center justify-center rounded-full bg-accent",children:(0,b.jsx)(A.default,{className:"h-6 w-6 text-muted-foreground"})}),(0,b.jsx)("h3",{className:"mt-4 text-lg font-semibold",children:"No projects found"}),(0,b.jsx)("p",{className:"mb-4 mt-2 text-sm text-muted-foreground max-w-sm",children:"Try adjusting your filters or create a new project."})]}):(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:a.map(a=>{let c,d=0===(c=a.tasks||[]).length?0:Math.round(c.filter(a=>"completed"===a.status).length/c.length*100),e=j?.user?.id?parseInt(j.user.id):0,f=j?.user?.role||"developer",g="admin"===f,i=a.createdById===e,k="project_manager"===f||g,l=g||i,m=g||i,n=(g||k)&&"urgent"!==a.priority,o=(g||k)&&"urgent"===a.priority;return(0,b.jsx)(S,{project:a,progress:d,statusColors:{active:"bg-green-100 text-green-800",completed:"bg-blue-100 text-blue-800",on_hold:"bg-yellow-100 text-yellow-800",planned:"bg-gray-100 text-gray-800",cancelled:"bg-red-100 text-red-800"},canEdit:l,canDelete:m,canMarkUrgent:n,canRemoveUrgent:o,onDeleted:h},a.id)})}),i>1&&(0,b.jsx)(Q.Pagination,{children:(0,b.jsxs)(Q.PaginationContent,{children:[(0,b.jsx)(Q.PaginationItem,{children:(0,b.jsx)(Q.PaginationPrevious,{onClick:()=>d>1&&g(d-1),className:1===d?"pointer-events-none opacity-50":"cursor-pointer"})}),Array.from({length:i},(a,b)=>b+1).map(a=>(0,b.jsx)(Q.PaginationItem,{children:(0,b.jsx)(Q.PaginationLink,{onClick:()=>g(a),isActive:a===d,className:"cursor-pointer",children:a})},a)),(0,b.jsx)(Q.PaginationItem,{children:(0,b.jsx)(Q.PaginationNext,{onClick:()=>d<i&&g(d+1),className:d===i?"pointer-events-none opacity-50":"cursor-pointer"})})]})})]})}function S({project:a,progress:f,statusColors:g,canEdit:h,canDelete:j,canMarkUrgent:l=!1,canRemoveUrgent:m=!1,onDeleted:o}){let[p,q]=(0,c.useState)(!1),[r,s]=(0,c.useState)(!1),[t,u]=(0,c.useState)(!1),v=(0,e.useRouter)(),w=async()=>{u(!0);let b=await M(a.id);u(!1),q(!1),b.success?(o&&o(),v.refresh()):alert(b.error||"Failed to delete project")};return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(k.Card,{className:"transition-shadow hover:shadow-md h-full relative group",children:[(0,b.jsxs)(k.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(x.default,{href:`/dashboard/projects/${a.id}`,className:"flex-1",children:(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,b.jsx)(n.Badge,{variant:"secondary",className:"text-xs capitalize",children:a.type}),"urgent"===a.priority&&(0,b.jsx)(n.Badge,{variant:"destructive",className:"text-xs animate-pulse",children:"ðŸš¨ URGENT"}),"high"===a.priority&&(0,b.jsx)(n.Badge,{variant:"outline",className:"text-xs border-orange-500 text-orange-700",children:"High"})]}),(0,b.jsx)(k.CardTitle,{className:"text-xl font-semibold line-clamp-1",children:a.name})]})}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(n.Badge,{className:(0,d.cn)("text-xs",g[a.status]||"bg-gray-100 text-gray-800"),children:a.status.replace("_"," ")}),(h||j)&&(0,b.jsxs)(I.DropdownMenu,{children:[(0,b.jsx)(I.DropdownMenuTrigger,{asChild:!0,onClick:a=>a.stopPropagation(),children:(0,b.jsx)(i.Button,{variant:"ghost",size:"icon",className:"h-8 w-8 opacity-0 group-hover:opacity-100 transition-opacity",onClick:a=>{a.preventDefault(),a.stopPropagation()},children:(0,b.jsx)(D.MoreVertical,{className:"h-4 w-4"})})}),(0,b.jsxs)(I.DropdownMenuContent,{align:"end",onClick:a=>a.stopPropagation(),children:[h&&(0,b.jsxs)(I.DropdownMenuItem,{onClick:a=>{a.preventDefault(),a.stopPropagation(),s(!0)},children:[(0,b.jsx)(E.Edit,{className:"h-4 w-4 mr-2"}),"Edit Project"]}),l&&(0,b.jsxs)(b.Fragment,{children:[(h||j)&&(0,b.jsx)(I.DropdownMenuSeparator,{}),(0,b.jsx)(O.MarkUrgentDialog,{projectId:a.id,projectName:a.name,children:(0,b.jsxs)(I.DropdownMenuItem,{onSelect:a=>{a.preventDefault(),a.stopPropagation()},children:[(0,b.jsx)(G.AlertTriangle,{className:"h-4 w-4 mr-2"}),"Make Urgent"]})})]}),m&&(0,b.jsxs)(b.Fragment,{children:[(h||j||l)&&(0,b.jsx)(I.DropdownMenuSeparator,{}),(0,b.jsx)(P.RemoveUrgentDialog,{projectId:a.id,projectName:a.name,children:(0,b.jsxs)(I.DropdownMenuItem,{onSelect:a=>{a.preventDefault(),a.stopPropagation()},children:[(0,b.jsx)(H.CheckCircle2,{className:"h-4 w-4 mr-2"}),"Remove Urgent"]})})]}),j&&(0,b.jsxs)(b.Fragment,{children:[(h||l)&&(0,b.jsx)(I.DropdownMenuSeparator,{}),(0,b.jsxs)(I.DropdownMenuItem,{onClick:a=>{a.preventDefault(),a.stopPropagation(),q(!0)},className:"text-red-600 focus:text-red-600",children:[(0,b.jsx)(F.Trash2,{className:"h-4 w-4 mr-2"}),"Delete Project"]})]})]})]})]})]}),(0,b.jsx)(x.default,{href:`/dashboard/projects/${a.id}`,children:(0,b.jsxs)(k.CardContent,{className:"space-y-4",children:[(0,b.jsx)(k.CardDescription,{className:"line-clamp-2 min-h-[40px]",children:a.description||"No description provided."}),a.tasks&&a.tasks.length>0&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Progress"}),(0,b.jsxs)("span",{className:"font-medium",children:[f,"%"]})]}),(0,b.jsx)(y.Progress,{value:f,className:"h-2"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[a.startDate&&(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(B.Calendar,{className:"h-3 w-3"}),(0,b.jsx)("span",{children:(0,z.format)(new Date(a.startDate),"MMM d, yyyy")})]}),a.endDate&&a.startDate&&(0,b.jsx)("span",{children:"â†’"}),a.endDate&&(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(B.Calendar,{className:"h-3 w-3"}),(0,b.jsx)("span",{children:(0,z.format)(new Date(a.endDate),"MMM d, yyyy")})]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1 text-muted-foreground",children:[(0,b.jsx)(A.default,{className:"h-3 w-3"}),(0,b.jsxs)("span",{children:[a.tasks?.length||0," tasks"]})]}),a.projectManager&&(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(C.Users,{className:"h-3 w-3 text-muted-foreground"}),(0,b.jsx)("span",{className:"text-xs text-muted-foreground",children:a.projectManager.username})]})]})]})})]}),h&&(0,b.jsx)(N.ProjectEditDialog,{project:{id:a.id,name:a.name,type:a.type,projectTypeId:a.projectTypeId||null,projectStatusId:a.projectStatusId||null,description:a.description||null,scope:a.scope||null,status:a.status,startDate:a.startDate?new Date(a.startDate):null,endDate:a.endDate?new Date(a.endDate):null},open:r,onOpenChange:s}),j&&(0,b.jsx)(J.AlertDialog,{open:p,onOpenChange:q,children:(0,b.jsxs)(J.AlertDialogContent,{children:[(0,b.jsxs)(J.AlertDialogHeader,{children:[(0,b.jsxs)(J.AlertDialogTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(G.AlertTriangle,{className:"h-5 w-5 text-red-600"}),"Delete Project"]}),(0,b.jsxs)(J.AlertDialogDescription,{children:["Are you sure you want to delete ",(0,b.jsx)("strong",{children:a.name}),"?",(0,b.jsx)("br",{}),(0,b.jsx)("br",{}),"This action cannot be undone. All tasks, dependencies, and related data will be permanently deleted.",a.tasks&&a.tasks.length>0&&(0,b.jsxs)("span",{className:"block mt-2 text-red-600 font-medium",children:["This project has ",a.tasks.length," task(s) that will also be deleted."]})]})]}),(0,b.jsxs)(J.AlertDialogFooter,{children:[(0,b.jsx)(J.AlertDialogCancel,{disabled:t,children:"Cancel"}),(0,b.jsx)(J.AlertDialogAction,{onClick:w,disabled:t,className:"bg-red-600 hover:bg-red-700",children:t?"Deleting...":"Delete Project"})]})]})})]})}var T=a.i(214719),U=a.i(515790),V=a.i(19778),W=a.i(139353),X=a.i(97186);function Y({projects:a,total:e,page:f,limit:g,onPageChange:h,users:j}){let[k,l]=(0,c.useState)(null),[m,o]=(0,c.useState)("asc"),p=[...a].sort((a,b)=>{let c,d;if(!k)return 0;switch(k){case"name":c=a.name.toLowerCase(),d=b.name.toLowerCase();break;case"status":c=a.status,d=b.status;break;case"progress":let e=a.tasks||[],f=b.tasks||[];c=e.length>0?e.filter(a=>"completed"===a.status).length/e.length:0,d=f.length>0?f.filter(a=>"completed"===a.status).length/f.length:0;break;case"startDate":c=a.startDate?new Date(a.startDate).getTime():0,d=b.startDate?new Date(b.startDate).getTime():0;break;case"endDate":c=a.endDate?new Date(a.endDate).getTime():0,d=b.endDate?new Date(b.endDate).getTime():0;break;default:return 0}return c<d?"asc"===m?-1:1:c>d?"asc"===m?1:-1:0}),q=Math.ceil(e/g),r=(a,c)=>(0,b.jsxs)(i.Button,{variant:"ghost",size:"sm",className:"h-8 data-[state=open]:bg-accent",onClick:()=>{k===a?o("asc"===m?"desc":"asc"):(l(a),o("asc"))},children:[c,k===a?"asc"===m?(0,b.jsx)(W.ArrowUp,{className:"ml-2 h-4 w-4"}):(0,b.jsx)(X.ArrowDown,{className:"ml-2 h-4 w-4"}):(0,b.jsx)(V.ArrowUpDown,{className:"ml-2 h-4 w-4 opacity-50"})]});return 0===a.length?(0,b.jsxs)("div",{className:"flex min-h-[400px] flex-col items-center justify-center rounded-md border border-dashed p-8 text-center",children:[(0,b.jsx)("h3",{className:"mt-4 text-lg font-semibold",children:"No projects found"}),(0,b.jsx)("p",{className:"mb-4 mt-2 text-sm text-muted-foreground max-w-sm",children:"Try adjusting your filters or create a new project."})]}):(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("div",{className:"rounded-md border",children:(0,b.jsxs)(T.Table,{children:[(0,b.jsx)(T.TableHeader,{children:(0,b.jsxs)(T.TableRow,{children:[(0,b.jsx)(T.TableHead,{children:r("name","Project Name")}),(0,b.jsx)(T.TableHead,{children:"Category"}),(0,b.jsx)(T.TableHead,{children:r("status","Status")}),(0,b.jsx)(T.TableHead,{children:r("progress","Progress")}),(0,b.jsx)(T.TableHead,{children:r("startDate","Start Date")}),(0,b.jsx)(T.TableHead,{children:r("endDate","End Date")}),(0,b.jsx)(T.TableHead,{children:"Project Manager"}),(0,b.jsx)(T.TableHead,{children:"Tasks"})]})}),(0,b.jsx)(T.TableBody,{children:p.map(a=>{let c,e=0===(c=a.tasks||[]).length?0:Math.round(c.filter(a=>"completed"===a.status).length/c.length*100);return(0,b.jsxs)(T.TableRow,{className:"cursor-pointer hover:bg-muted/50",children:[(0,b.jsx)(T.TableCell,{children:(0,b.jsx)(x.default,{href:`/dashboard/projects/${a.id}`,className:"font-medium hover:underline",children:a.name})}),(0,b.jsx)(T.TableCell,{children:(0,b.jsx)(n.Badge,{variant:"secondary",className:"capitalize",children:a.type})}),(0,b.jsx)(T.TableCell,{children:(0,b.jsx)(n.Badge,{className:(0,d.cn)("text-xs",{active:"bg-green-100 text-green-800",completed:"bg-blue-100 text-blue-800",on_hold:"bg-yellow-100 text-yellow-800",planned:"bg-gray-100 text-gray-800",cancelled:"bg-red-100 text-red-800"}[a.status]||"bg-gray-100 text-gray-800"),children:a.status.replace("_"," ")})}),(0,b.jsx)(T.TableCell,{children:(0,b.jsxs)("div",{className:"flex items-center gap-2 w-32",children:[(0,b.jsx)(y.Progress,{value:e,className:"h-2 flex-1"}),(0,b.jsxs)("span",{className:"text-xs text-muted-foreground w-10",children:[e,"%"]})]})}),(0,b.jsx)(T.TableCell,{children:a.startDate?(0,b.jsx)("span",{className:"text-sm",children:(0,z.format)(new Date(a.startDate),"MMM d, yyyy")}):(0,b.jsx)("span",{className:"text-muted-foreground",children:"â€”"})}),(0,b.jsx)(T.TableCell,{children:a.endDate?(0,b.jsx)("span",{className:"text-sm",children:(0,z.format)(new Date(a.endDate),"MMM d, yyyy")}):(0,b.jsx)("span",{className:"text-muted-foreground",children:"â€”"})}),(0,b.jsx)(T.TableCell,{children:a.projectManager?(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)(U.Avatar,{className:"h-6 w-6",children:[(0,b.jsx)(U.AvatarImage,{src:a.projectManager.avatarUrl||void 0}),(0,b.jsx)(U.AvatarFallback,{className:"text-xs",children:a.projectManager.username.substring(0,2).toUpperCase()})]}),(0,b.jsx)("span",{className:"text-sm",children:a.projectManager.username})]}):(0,b.jsx)("span",{className:"text-muted-foreground",children:"â€”"})}),(0,b.jsx)(T.TableCell,{children:(0,b.jsx)("span",{className:"text-sm",children:a.tasks?.length||0})})]},a.id)})})]})}),q>1&&(0,b.jsx)(Q.Pagination,{children:(0,b.jsxs)(Q.PaginationContent,{children:[(0,b.jsx)(Q.PaginationItem,{children:(0,b.jsx)(Q.PaginationPrevious,{onClick:()=>f>1&&h(f-1),className:1===f?"pointer-events-none opacity-50":"cursor-pointer"})}),Array.from({length:q},(a,b)=>b+1).map(a=>(0,b.jsx)(Q.PaginationItem,{children:(0,b.jsx)(Q.PaginationLink,{onClick:()=>h(a),isActive:a===f,className:"cursor-pointer",children:a})},a)),(0,b.jsx)(Q.PaginationItem,{children:(0,b.jsx)(Q.PaginationNext,{onClick:()=>f<q&&h(f+1),className:f===q?"pointer-events-none opacity-50":"cursor-pointer"})})]})})]})}var Z=a.i(97155);let $=(0,L.createServerReference)("401e3f4be30a5d5dbee04214aa788c798e018c4c21",L.callServer,void 0,L.findSourceMapURL,"createProject");var _=a.i(879896),aa=a.i(210731),ab=a.i(638236);function ac({onProjectCreated:a}){let[d,g]=(0,c.useState)(!1),[h,j]=(0,c.useState)(!1),[k,n]=(0,c.useState)([]),[o,p]=(0,c.useState)(!0),q=(0,e.useRouter)();async function r(b){b.preventDefault(),j(!0);let c=new FormData(b.currentTarget),d=await $(c);if(j(!1),d?.success){g(!1);let c=b.currentTarget;c&&c.reset(),q.refresh(),a&&a()}else alert(d?.error||"Failed to create project")}return(0,c.useEffect)(()=>{async function a(){p(!0);let a=await (0,_.getProjectTypes)(!1);p(!1),a.success&&n(a.projectTypes||[])}d&&a()},[d]),(0,b.jsxs)(Z.Dialog,{open:d,onOpenChange:g,children:[(0,b.jsx)(Z.DialogTrigger,{asChild:!0,children:(0,b.jsxs)(i.Button,{children:[(0,b.jsx)(ab.Plus,{className:"mr-2 h-4 w-4"}),"New Project"]})}),(0,b.jsxs)(Z.DialogContent,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[(0,b.jsxs)(Z.DialogHeader,{children:[(0,b.jsx)(Z.DialogTitle,{children:"Create New Project"}),(0,b.jsx)(Z.DialogDescription,{children:"Configure your project with details, timeline, and team structure."})]}),(0,b.jsxs)("form",{onSubmit:r,children:[(0,b.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(l.Label,{htmlFor:"name",children:"Project Name *"}),(0,b.jsx)(f.Input,{id:"name",name:"name",placeholder:"E-commerce Platform",required:!0})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(l.Label,{htmlFor:"projectTypeId",children:"Project Type *"}),(0,b.jsxs)(m.Select,{name:"projectTypeId",required:!0,disabled:o,children:[(0,b.jsx)(m.SelectTrigger,{id:"projectTypeId",children:(0,b.jsx)(m.SelectValue,{placeholder:o?"Loading types...":"Select project type"})}),(0,b.jsx)(m.SelectContent,{children:0!==k.length||o?k.map(a=>(0,b.jsx)(m.SelectItem,{value:a.id.toString(),children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[a.color&&(0,b.jsx)("div",{className:"h-3 w-3 rounded-full",style:{backgroundColor:a.color}}),(0,b.jsx)("span",{children:a.name})]})},a.id)):(0,b.jsx)(m.SelectItem,{value:"",disabled:!0,children:"No project types available. Please create one in Settings."})})]}),(0,b.jsx)("input",{type:"hidden",name:"type",value:""})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(l.Label,{htmlFor:"description",children:"Description"}),(0,b.jsx)("textarea",{id:"description",name:"description",placeholder:"Brief overview of the project goals and purpose...",rows:3,className:"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(l.Label,{htmlFor:"scope",children:"Project Scope"}),(0,b.jsx)("textarea",{id:"scope",name:"scope",placeholder:"Define deliverables, features, and boundaries...",rows:3,className:"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(l.Label,{htmlFor:"startDate",children:"Start Date"}),(0,b.jsx)(f.Input,{id:"startDate",name:"startDate",type:"date"})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(l.Label,{htmlFor:"endDate",children:"Target End Date"}),(0,b.jsx)(f.Input,{id:"endDate",name:"endDate",type:"date"})]})]}),(0,b.jsx)("input",{type:"hidden",name:"projectManagerId",value:""})]}),(0,b.jsxs)(Z.DialogFooter,{children:[(0,b.jsx)(i.Button,{type:"button",variant:"outline",onClick:()=>g(!1),children:"Cancel"}),(0,b.jsxs)(i.Button,{type:"submit",disabled:h,children:[h&&(0,b.jsx)(aa.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Create Project"]})]})]})]})]})}var ad=a.i(146886),ae=a.i(204451);let af=(0,L.createServerReference)("406144e6cbbfbe91083d4680cc56756da14a65698a",L.callServer,void 0,L.findSourceMapURL,"getProjectsWithFilters");var ag=a.i(335680),A=A,ah=a.i(114082),ah=ah;function ai({initialProjects:a,initialTotal:f,users:g,stats:h}){let i=(0,e.useRouter)(),k=(0,e.useSearchParams)(),[l,m]=(0,c.useState)(a),[n,o]=(0,c.useState)(f),[p,q]=(0,c.useState)(!1),[r,s]=(0,c.useState)(null),[u,v]=(0,c.useState)(k.get("view")||"card"),[x,y]=(0,c.useState)([]),[z,B]=(0,c.useState)(k.get("search")||""),[C,D]=(0,c.useState)(k.get("category")?.split(",").filter(Boolean)||[]),[E,F]=(0,c.useState)(k.get("status")?.split(",").filter(Boolean)||[]),[I,J]=(0,c.useState)({start:k.get("startDate")?new Date(k.get("startDate")):void 0,end:k.get("endDate")?new Date(k.get("endDate")):void 0}),[K,L]=(0,c.useState)(k.get("projectManager")||"all"),[M,N]=(0,c.useState)(k.get("priority")?.split(",").filter(Boolean)||[]),[O,P]=(0,c.useState)(parseInt(k.get("page")||"1")),[Q]=(0,c.useState)(12),S=(0,c.useRef)(!1);(0,c.useEffect)(()=>{!async function(){let a=await (0,_.getProjectTypes)(!1);a.success&&y(a.projectTypes||[])}()},[]);let T=(0,c.useCallback)(()=>{let a=new URLSearchParams;z&&a.set("search",z),C.length>0&&a.set("category",C.join(",")),E.length>0&&a.set("status",E.join(",")),I.start&&a.set("startDate",I.start.toISOString().split("T")[0]),I.end&&a.set("endDate",I.end.toISOString().split("T")[0]),"all"!==K&&a.set("projectManager",K),M.length>0&&a.set("priority",M.join(",")),"card"!==u&&a.set("view",u),O>1&&a.set("page",O.toString()),i.push(`/dashboard/projects?${a.toString()}`,{scroll:!1});let b=`${window.location.pathname}?${a.toString()}`;window.history.pushState(null,"",b)},[z,C,E,M,I,K,u,O]),U=(0,c.useCallback)(async()=>{q(!0),s(null);try{let a=await af({search:z,category:C,status:E,startDate:I.start?.toISOString(),endDate:I.end?.toISOString(),projectManager:"all"!==K?K:void 0,priority:M,page:O,limit:Q});a.success?(m(a.projects||[]),o(a.total||0)):s(a.error||"Failed to load projects")}catch(a){s(a.message||"An error occurred")}finally{q(!1)}},[z,C,E,M,I,K,O,Q]);(0,c.useEffect)(()=>{let a=setTimeout(()=>{P(1),U(),T()},400);return()=>clearTimeout(a)},[z]),(0,c.useEffect)(()=>{S.current?(P(1),U(),T()):S.current=!0},[C,E,M,I,K,u]),(0,c.useEffect)(()=>{S.current&&1!==O&&(U(),T())},[O]);let V=()=>{B(""),D([]),F([]),N([]),J({}),L("all"),P(1)};return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-3xl font-bold tracking-tight",children:"Projects"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Manage your projects and track progress"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(w,{viewMode:u,onViewChange:a=>{v(a),T()}}),(0,b.jsx)(ac,{onProjectCreated:U})]})]}),(0,b.jsx)(ag.SummaryStatsCards,{cards:[{label:"Total Projects",value:h.total,icon:(0,b.jsx)(A.default,{}),color:"default",onClick:()=>{D([]),F([]),N([]),L("all"),B(""),J({})},active:0===E.length&&0===M.length&&0===C.length},{label:"Active",value:h.active,icon:(0,b.jsx)(ah.default,{}),color:"blue",onClick:()=>{F(["active"]),N([])},active:E.includes("active")&&1===E.length&&0===M.length},{label:"Completed",value:h.completed,icon:(0,b.jsx)(H.CheckCircle2,{}),color:"green",onClick:()=>{F(["completed"]),N([])},active:E.includes("completed")&&1===E.length},{label:"Urgent",value:h.urgent,icon:(0,b.jsx)(G.AlertTriangle,{}),color:"red",onClick:()=>{N(["urgent"]),F([])},active:M.includes("urgent")}]}),(0,b.jsx)(j,{value:z,onChange:B,onClear:()=>{B(""),V()}}),(0,b.jsx)(t,{categoryFilter:C,onCategoryChange:D,statusFilter:E,onStatusChange:F,dateRange:I,onDateRangeChange:J,projectManagerFilter:K,onProjectManagerChange:L,users:g,projectTypes:x,onClear:V,priorityFilter:M}),r&&(0,b.jsxs)(ae.Alert,{variant:"destructive",children:[(0,b.jsx)(ad.AlertCircle,{className:"h-4 w-4"}),(0,b.jsx)(ae.AlertDescription,{children:r})]}),(0,b.jsxs)("div",{className:"relative min-h-[400px]",children:[p&&(0,b.jsx)("div",{className:"absolute inset-0 z-10 bg-background/50 backdrop-blur-sm flex items-center justify-center rounded-lg transition-all duration-200",children:(0,b.jsx)(aa.Loader2,{className:"h-8 w-8 animate-spin text-primary"})}),(0,b.jsx)("div",{className:(0,d.cn)("transition-opacity duration-200",p?"opacity-50":"opacity-100"),children:"card"===u?(0,b.jsx)(R,{projects:l,total:n,page:O,limit:Q,onPageChange:P,onProjectDeleted:U}):(0,b.jsx)(Y,{projects:l,total:n,page:O,limit:Q,onPageChange:P,users:g,onProjectDeleted:U})})]})]})}a.s(["ProjectsDashboard",()=>ai],377273)}];

//# sourceMappingURL=36f85_Project_Management_NXT_src_components_projects_projects-dashboard_tsx_61f24887._.js.map