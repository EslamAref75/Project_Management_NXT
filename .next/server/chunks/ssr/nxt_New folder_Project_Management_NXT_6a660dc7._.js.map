{"version":3,"sources":["../../../../../../../nxt/New%20folder/Project_Management_NXT/src/app/actions/project-settings.ts","../../../../../../../nxt/New%20folder/Project_Management_NXT/.next-internal/server/app/dashboard/projects/%5Bid%5D/settings/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["\"use server\"\r\n\r\nimport { prisma } from \"@/lib/prisma\"\r\nimport { getServerSession } from \"next-auth\"\r\nimport { authOptions } from \"@/lib/auth\"\r\nimport { revalidatePath } from \"next/cache\"\r\nimport { hasPermissionWithoutRoleBypass } from \"@/lib/rbac-helpers\"\r\n\r\n// Check if user can manage project settings\r\nasync function checkProjectSettingsAccess(projectId: number) {\r\n    const session = await getServerSession(authOptions)\r\n    if (!session) return { authorized: false, session: null, hasAdminPermission: false }\r\n\r\n    const userId = parseInt(session.user.id)\r\n    const hasAdminPermission = await hasPermissionWithoutRoleBypass(userId, \"admin.access\")\r\n\r\n    // Check if user is project manager\r\n    const project = await prisma.project.findUnique({\r\n        where: { id: projectId },\r\n        select: {\r\n            id: true,\r\n            projectManagerId: true,\r\n            createdById: true\r\n        }\r\n    })\r\n\r\n    if (!project) {\r\n        return { authorized: false, session: null, hasAdminPermission: false, error: \"Project not found\" }\r\n    }\r\n\r\n    const isProjectManager = project.projectManagerId === userId || project.createdById === userId\r\n\r\n    const authorized = hasAdminPermission || isProjectManager\r\n\r\n    return { authorized, session, hasAdminPermission, isProjectManager }\r\n}\r\n\r\n// Get all project settings with override resolution\r\nexport async function getProjectSettings(projectId: number) {\r\n    const { authorized, session } = await checkProjectSettingsAccess(projectId)\r\n    if (!authorized || !session) {\r\n        return { error: \"Unauthorized: Only project managers and admins can access project settings\" }\r\n    }\r\n\r\n    try {\r\n        const projectSettings = await prisma.projectSetting.findMany({\r\n            where: { projectId },\r\n            orderBy: [\r\n                { category: \"asc\" },\r\n                { key: \"asc\" }\r\n            ],\r\n            include: {\r\n                updater: {\r\n                    select: {\r\n                        id: true,\r\n                        username: true,\r\n                        email: true\r\n                    }\r\n                }\r\n            }\r\n        })\r\n\r\n        // Group settings by category\r\n        const grouped: Record<string, any[]> = {}\r\n        projectSettings.forEach(setting => {\r\n            if (!grouped[setting.category]) {\r\n                grouped[setting.category] = []\r\n            }\r\n            grouped[setting.category].push({\r\n                id: setting.id,\r\n                key: setting.key,\r\n                value: JSON.parse(setting.value),\r\n                category: setting.category,\r\n                enabled: setting.enabled,\r\n                updatedAt: setting.updatedAt,\r\n                updatedBy: setting.updater\r\n            })\r\n        })\r\n\r\n        return { success: true, settings: grouped }\r\n    } catch (e: any) {\r\n        console.error(\"getProjectSettings Error:\", e)\r\n        return { error: \"Failed to fetch project settings\", details: e.message }\r\n    }\r\n}\r\n\r\n// Get resolved settings (project override + global default)\r\nexport async function getResolvedProjectSettings(projectId: number) {\r\n    const session = await getServerSession(authOptions)\r\n    if (!session) {\r\n        return { error: \"Unauthorized\" }\r\n    }\r\n\r\n    try {\r\n        // Get all project settings\r\n        const projectSettings = await prisma.projectSetting.findMany({\r\n            where: { projectId, enabled: true }\r\n        })\r\n\r\n        // Get all global settings\r\n        const globalSettings = await prisma.systemSetting.findMany()\r\n\r\n        // Create a map of resolved settings\r\n        const resolved: Record<string, any> = {}\r\n\r\n        // Process each category\r\n        const categories = [\"general\", \"tasks\", \"dependencies\", \"today_tasks\", \"workflow\", \"permissions\", \"notifications\"]\r\n\r\n        for (const category of categories) {\r\n            const projectSetting = projectSettings.find(s => s.category === category && s.key === category)\r\n            const globalSetting = globalSettings.find(s => s.category === category && s.key === category)\r\n\r\n            if (projectSetting && projectSetting.enabled) {\r\n                resolved[category] = {\r\n                    value: JSON.parse(projectSetting.value),\r\n                    source: \"project\",\r\n                    enabled: true\r\n                }\r\n            } else if (globalSetting) {\r\n                resolved[category] = {\r\n                    value: JSON.parse(globalSetting.value),\r\n                    source: \"global\",\r\n                    enabled: false\r\n                }\r\n            } else {\r\n                // System default (would need to be defined)\r\n                resolved[category] = {\r\n                    value: null,\r\n                    source: \"system\",\r\n                    enabled: false\r\n                }\r\n            }\r\n        }\r\n\r\n        return { success: true, settings: resolved }\r\n    } catch (e: any) {\r\n        console.error(\"getResolvedProjectSettings Error:\", e)\r\n        return { error: \"Failed to fetch resolved settings\", details: e.message }\r\n    }\r\n}\r\n\r\n// Get a specific project setting\r\nexport async function getProjectSetting(projectId: number, key: string) {\r\n    const { authorized, session } = await checkProjectSettingsAccess(projectId)\r\n    if (!authorized || !session) {\r\n        return { error: \"Unauthorized\" }\r\n    }\r\n\r\n    try {\r\n        const setting = await prisma.projectSetting.findUnique({\r\n            where: {\r\n                projectId_key: {\r\n                    projectId,\r\n                    key\r\n                }\r\n            },\r\n            include: {\r\n                updater: {\r\n                    select: {\r\n                        id: true,\r\n                        username: true,\r\n                        email: true\r\n                    }\r\n                }\r\n            }\r\n        })\r\n\r\n        if (!setting) {\r\n            return { error: \"Setting not found\" }\r\n        }\r\n\r\n        return {\r\n            success: true,\r\n            setting: {\r\n                id: setting.id,\r\n                key: setting.key,\r\n                value: JSON.parse(setting.value),\r\n                category: setting.category,\r\n                enabled: setting.enabled,\r\n                updatedAt: setting.updatedAt,\r\n                updatedBy: setting.updater\r\n            }\r\n        }\r\n    } catch (e: any) {\r\n        console.error(\"getProjectSetting Error:\", e)\r\n        return { error: \"Failed to fetch setting\", details: e.message }\r\n    }\r\n}\r\n\r\n// Update a project setting\r\nexport async function updateProjectSetting(\r\n    projectId: number,\r\n    key: string,\r\n    value: any,\r\n    enabled: boolean = true,\r\n    reason?: string\r\n) {\r\n    const { authorized, session, hasAdminPermission } = await checkProjectSettingsAccess(projectId)\r\n    if (!authorized || !session) {\r\n        return { error: \"Unauthorized\" }\r\n    }\r\n\r\n    try {\r\n        // Get existing setting\r\n        const existing = await prisma.projectSetting.findUnique({\r\n            where: {\r\n                projectId_key: {\r\n                    projectId,\r\n                    key\r\n                }\r\n            }\r\n        })\r\n\r\n        const oldValue = existing?.value || null\r\n        const newValue = JSON.stringify(value)\r\n\r\n        // Update or create setting\r\n        const updated = await prisma.projectSetting.upsert({\r\n            where: {\r\n                projectId_key: {\r\n                    projectId,\r\n                    key\r\n                }\r\n            },\r\n            create: {\r\n                projectId,\r\n                key,\r\n                category: key, // Assuming key matches category for now\r\n                value: newValue,\r\n                enabled,\r\n                updatedBy: parseInt(session.user.id)\r\n            },\r\n            update: {\r\n                value: newValue,\r\n                enabled,\r\n                updatedBy: parseInt(session.user.id)\r\n            }\r\n        })\r\n\r\n        // Log the change\r\n        await prisma.projectSettingsChangeLog.create({\r\n            data: {\r\n                projectId,\r\n                settingKey: key,\r\n                category: updated.category,\r\n                oldValue: oldValue,\r\n                newValue: newValue,\r\n                reason: reason || null,\r\n                changedBy: parseInt(session.user.id),\r\n                settingId: updated.id\r\n            }\r\n        })\r\n\r\n        revalidatePath(`/dashboard/projects/${projectId}`)\r\n        revalidatePath(`/dashboard/projects/${projectId}/settings`)\r\n        return { success: true, setting: updated }\r\n    } catch (e: any) {\r\n        console.error(\"updateProjectSetting Error:\", e)\r\n        return { error: \"Failed to update setting\", details: e.message }\r\n    }\r\n}\r\n\r\n// Create a new project setting\r\nexport async function createProjectSetting(\r\n    projectId: number,\r\n    key: string,\r\n    category: string,\r\n    value: any,\r\n    enabled: boolean = true\r\n) {\r\n    const { authorized, session } = await checkProjectSettingsAccess(projectId)\r\n    if (!authorized || !session) {\r\n        return { error: \"Unauthorized\" }\r\n    }\r\n\r\n    try {\r\n        // Check if setting already exists\r\n        const existing = await prisma.projectSetting.findUnique({\r\n            where: {\r\n                projectId_key: {\r\n                    projectId,\r\n                    key\r\n                }\r\n            }\r\n        })\r\n\r\n        if (existing) {\r\n            return { error: \"Setting with this key already exists\" }\r\n        }\r\n\r\n        const newSetting = await prisma.projectSetting.create({\r\n            data: {\r\n                projectId,\r\n                key,\r\n                category,\r\n                value: JSON.stringify(value),\r\n                enabled,\r\n                updatedBy: parseInt(session.user.id)\r\n            }\r\n        })\r\n\r\n        // Log the creation\r\n        await prisma.projectSettingsChangeLog.create({\r\n            data: {\r\n                projectId,\r\n                settingKey: key,\r\n                category: category,\r\n                oldValue: null,\r\n                newValue: JSON.stringify(value),\r\n                reason: \"Setting created\",\r\n                changedBy: parseInt(session.user.id),\r\n                settingId: newSetting.id\r\n            }\r\n        })\r\n\r\n        revalidatePath(`/dashboard/projects/${projectId}/settings`)\r\n        return { success: true, setting: newSetting }\r\n    } catch (e: any) {\r\n        console.error(\"createProjectSetting Error:\", e)\r\n        return { error: \"Failed to create setting\", details: e.message }\r\n    }\r\n}\r\n\r\n// Get project settings change log\r\nexport async function getProjectSettingsChangeLog(\r\n    projectId: number,\r\n    settingKey?: string,\r\n    limit: number = 50,\r\n    offset: number = 0\r\n) {\r\n    const { authorized, session } = await checkProjectSettingsAccess(projectId)\r\n    if (!authorized || !session) {\r\n        return { error: \"Unauthorized\" }\r\n    }\r\n\r\n    try {\r\n        const where: any = { projectId }\r\n        if (settingKey) {\r\n            where.settingKey = settingKey\r\n        }\r\n\r\n        const logs = await prisma.projectSettingsChangeLog.findMany({\r\n            where,\r\n            include: {\r\n                changer: {\r\n                    select: {\r\n                        id: true,\r\n                        username: true,\r\n                        email: true\r\n                    }\r\n                },\r\n                setting: {\r\n                    select: {\r\n                        key: true,\r\n                        category: true\r\n                    }\r\n                }\r\n            },\r\n            orderBy: { createdAt: \"desc\" },\r\n            take: limit,\r\n            skip: offset\r\n        })\r\n\r\n        const total = await prisma.projectSettingsChangeLog.count({ where })\r\n\r\n        return {\r\n            success: true,\r\n            logs: logs.map(log => ({\r\n                id: log.id,\r\n                settingKey: log.settingKey,\r\n                category: log.setting?.category,\r\n                oldValue: log.oldValue ? JSON.parse(log.oldValue) : null,\r\n                newValue: JSON.parse(log.newValue),\r\n                reason: log.reason,\r\n                changedBy: log.changer,\r\n                createdAt: log.createdAt\r\n            })),\r\n            total,\r\n            limit,\r\n            offset\r\n        }\r\n    } catch (e: any) {\r\n        console.error(\"getProjectSettingsChangeLog Error:\", e)\r\n        return { error: \"Failed to fetch change log\", details: e.message }\r\n    }\r\n}\r\n\r\n// Reset project setting to global default\r\nexport async function resetProjectSetting(projectId: number, key: string) {\r\n    const { authorized, session } = await checkProjectSettingsAccess(projectId)\r\n    if (!authorized || !session) {\r\n        return { error: \"Unauthorized\" }\r\n    }\r\n\r\n    try {\r\n        // Disable the override (don't delete, just disable)\r\n        const setting = await prisma.projectSetting.update({\r\n            where: {\r\n                projectId_key: {\r\n                    projectId,\r\n                    key\r\n                }\r\n            },\r\n            data: {\r\n                enabled: false\r\n            }\r\n        })\r\n\r\n        // Log the reset\r\n        await prisma.projectSettingsChangeLog.create({\r\n            data: {\r\n                projectId,\r\n                settingKey: key,\r\n                category: setting.category,\r\n                oldValue: setting.value,\r\n                newValue: JSON.stringify({ enabled: false }),\r\n                reason: \"Reset to global default\",\r\n                changedBy: parseInt(session.user.id),\r\n                settingId: setting.id\r\n            }\r\n        })\r\n\r\n        revalidatePath(`/dashboard/projects/${projectId}/settings`)\r\n        return { success: true, message: \"Setting reset to global default\" }\r\n    } catch (e: any) {\r\n        console.error(\"resetProjectSetting Error:\", e)\r\n        return { error: \"Failed to reset setting\", details: e.message }\r\n    }\r\n}\r\n\r\n","export {getPublicSystemSettings as '0033db22356cbf8845a3517099b63dfc38d1147299'} from 'ACTIONS_MODULE0'\nexport {getAllProjectsUnreadNotificationCount as '00686a7231b739e4fe9b8305b757bc0e83827b9865'} from 'ACTIONS_MODULE1'\nexport {getAllProjectsNotifications as '4004a0aae390e2c1aeb900c79065f312ac43d90f8d'} from 'ACTIONS_MODULE1'\nexport {markProjectNotificationAsRead as '60691655a7ad6aec29ab9691d8571a0d380be93da1'} from 'ACTIONS_MODULE1'\nexport {getProjects as '003ae2a452e6e1e8ebee86f206a9903396d5df13b8'} from 'ACTIONS_MODULE2'\nexport {createProject as '401e3f4be30a5d5dbee04214aa788c798e018c4c21'} from 'ACTIONS_MODULE2'\nexport {getProject as '402c9fcdaf734573eeb364d1e92aac14ecf31bcfb9'} from 'ACTIONS_MODULE2'\nexport {getProjectsWithFilters as '406144e6cbbfbe91083d4680cc56756da14a65698a'} from 'ACTIONS_MODULE2'\nexport {deleteProject as '40fdba31998d7a3efe7c944c688cf93002e917af7b'} from 'ACTIONS_MODULE2'\nexport {updateProject as '601c00162e3e64028c2b657a9e3982df01dad141d5'} from 'ACTIONS_MODULE2'\nexport {logActivity as '40daa1d9c7314de4957a7669434db12aaa24630ba4'} from 'ACTIONS_MODULE3'\nexport {getProjectSettings as '403775645662f7593a65be1a569d77a1a93596c3ae'} from 'ACTIONS_MODULE4'\nexport {getResolvedProjectSettings as '40b69736d10082c7029d6a3ba958f68a26bb984d11'} from 'ACTIONS_MODULE4'\nexport {resetProjectSetting as '605b6b24e07efe1c92d678d775d9b33fe01c191a36'} from 'ACTIONS_MODULE4'\nexport {getProjectSetting as '60dd758f1f511cf854a107f1bb542f2741d586bc05'} from 'ACTIONS_MODULE4'\nexport {getProjectSettingsChangeLog as '7802fce46123ca10d47a8086a9d3ea3e96b95af191'} from 'ACTIONS_MODULE4'\nexport {createProjectSetting as '7c78551cafee9f072ea8e2de6a74f1f2afe17a47d6'} from 'ACTIONS_MODULE4'\nexport {updateProjectSetting as '7cf014ca08e543e0266b1bf98988bb7f513f6a9a2b'} from 'ACTIONS_MODULE4'\nexport {updateProjectSetting as '7cf014ca08e543e0266b1bf98988bb7f513f6a9a2b'} from 'ACTIONS_MODULE4'\nexport {resetProjectSetting as '605b6b24e07efe1c92d678d775d9b33fe01c191a36'} from 'ACTIONS_MODULE4'\n"],"names":[],"mappings":"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"}