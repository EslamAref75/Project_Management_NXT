module.exports=[185957,a=>{"use strict";var b=a.i(295394),c=a.i(313954),d=a.i(877103),e=a.i(920931),f=a.i(682600),g=a.i(638236),h=a.i(210731),i=a.i(66796),j=a.i(395301);let k=(0,j.createServerReference)("4092279ff8e6ca25b90aeb832f385d51d9d7c60d48",j.callServer,void 0,j.findSourceMapURL,"createSubtask"),l=(0,j.createServerReference)("600329ba0ba9cc97651d7734bbf3d4a35a31ef80d5",j.callServer,void 0,j.findSourceMapURL,"updateSubtask"),m=(0,j.createServerReference)("403f8a5c068c0438ff16759bb9ee34241fe1078c6f",j.callServer,void 0,j.findSourceMapURL,"deleteSubtask");var n=a.i(932065),o=a.i(489158),p=a.i(401149);function q({subtasks:a,parentTaskId:j}){let[q,r]=(0,c.useState)(""),[s,t]=(0,c.useState)(!1),[u,v]=(0,c.useState)(null),[w,x]=(0,c.useState)(""),y=(0,c.useRef)(null),z=(0,c.useRef)(null),{toast:A}=(0,n.useToast)(),B=(0,o.useRouter)(),C=a.filter(a=>"completed"===a.status).length,D=a.length,E=D>0?Math.round(C/D*100):0;(0,c.useEffect)(()=>{null!==u&&z.current&&(z.current.focus(),z.current.select())},[u]);let F=async()=>{if(!q.trim())return;t(!0);let a=await k({parentTaskId:j,title:q.trim(),priority:"normal"});t(!1),a.error?A({title:"Error",description:a.error,variant:"destructive"}):(r(""),B.refresh())},G=async(a,b)=>{await l(a,{status:"completed"===b?"pending":"completed"}),B.refresh()},H=async(a,b)=>{if(!window.confirm(`Delete "${b}"?`))return;let c=await m(a);c.error?A({title:"Error",description:c.error,variant:"destructive"}):B.refresh()},I=async a=>{w.trim()?(await l(a,{title:w.trim()}),v(null),B.refresh()):v(null)};return(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("div",{className:"flex items-center justify-between",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("h3",{className:"text-sm font-semibold",children:"Checklist"}),D>0&&(0,b.jsxs)("span",{className:"text-xs text-muted-foreground",children:[C," of ",D," completed"]})]})}),a.length>0&&(0,b.jsx)("div",{className:"space-y-1.5",children:a.map(a=>{let c="completed"===a.status,f=u===a.id;return(0,b.jsxs)("div",{className:(0,p.cn)("group flex items-center gap-3 p-2 rounded-md transition-colors","hover:bg-muted/50",c&&"opacity-75"),children:[(0,b.jsx)(d.Checkbox,{checked:c,onCheckedChange:()=>G(a.id,a.status),className:"mt-0.5"}),f?(0,b.jsx)("div",{className:"flex-1 flex items-center gap-2",children:(0,b.jsx)(e.Input,{ref:z,value:w,onChange:a=>x(a.target.value),onKeyDown:b=>{"Enter"===b.key?I(a.id):"Escape"===b.key&&(v(null),x(""))},onBlur:()=>I(a.id),className:"h-8 text-sm"})}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("span",{className:(0,p.cn)("flex-1 text-sm cursor-pointer select-none",c&&"line-through text-muted-foreground"),onDoubleClick:()=>{v(a.id),x(a.title)},children:a.title}),(0,b.jsx)("button",{className:"opacity-0 group-hover:opacity-100 h-6 w-6 text-muted-foreground hover:text-destructive flex items-center justify-center transition-all rounded-sm hover:bg-destructive/10",onClick:()=>H(a.id,a.title),title:"Delete subtask",children:(0,b.jsx)(i.X,{className:"h-3.5 w-3.5"})})]})]},a.id)})}),(0,b.jsxs)("div",{className:"flex gap-2 items-center pt-2 border-t",children:[(0,b.jsx)(e.Input,{ref:y,placeholder:"Add a checklist item...",className:"h-9 text-sm",value:q,onChange:a=>r(a.target.value),onKeyDown:a=>{"Enter"!==a.key||s||F()}}),(0,b.jsx)(f.Button,{size:"sm",onClick:F,disabled:s||!q.trim(),className:"h-9",children:s?(0,b.jsx)(h.Loader2,{className:"h-4 w-4 animate-spin"}):(0,b.jsx)(g.Plus,{className:"h-4 w-4"})})]}),D>0&&(0,b.jsx)("div",{className:"pt-2",children:(0,b.jsx)("div",{className:"h-1.5 bg-muted rounded-full overflow-hidden",children:(0,b.jsx)("div",{className:"h-full bg-primary transition-all duration-300",style:{width:`${E}%`}})})})]})}a.s(["SubtaskList",()=>q],185957)},472793,a=>{"use strict";var b=a.i(295394),c=a.i(917710),d=a.i(682600),e=a.i(301209),f=a.i(146886),g=a.i(514750),h=a.i(107346),i=a.i(66796),j=a.i(937946),j=j,k=a.i(486944),l=a.i(436564),l=l,m=a.i(395301);let n=(0,m.createServerReference)("604f3a4a12d21d9ff500f2582d8b0d2c84fbc7c29b",m.callServer,void 0,m.findSourceMapURL,"removeTaskDependency");var o=a.i(489158),p=a.i(313954),q=a.i(401149);function r({dependencies:a,taskId:m,projectId:r,canEdit:s=!0}){let t=(0,o.useRouter)(),[u,v]=(0,p.useState)(null),w=async a=>{if(confirm("Are you sure you want to remove this dependency?")){v(a);try{let b=await n(m,a);b.error?alert(b.error):(t.refresh(),window.location.reload())}catch(a){console.error("Removal error:",a),alert("Failed to remove dependency")}finally{v(null)}}};return 0===a.length?(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"No dependencies. This task can be started immediately."}):(0,b.jsx)("div",{className:"space-y-3",children:a.map(a=>{var m;let n="completed"===a.dependsOnTask.status,o=!n;return(0,b.jsxs)(e.Card,{className:(0,q.cn)("transition-colors",o&&"border-orange-500/50 bg-orange-500/5"),children:[(0,b.jsx)(e.CardHeader,{className:"pb-3",children:(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[o?(0,b.jsx)(f.AlertCircle,{className:"w-4 h-4 text-orange-500"}):(0,b.jsx)(g.CheckCircle2,{className:"w-4 h-4 text-green-500"}),(0,b.jsx)(e.CardTitle,{className:"text-sm font-medium",children:a.dependsOnTask.title})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(m=a.dependsOnTask.status,n?(0,b.jsxs)(c.Badge,{variant:"outline",className:"bg-green-500/10 text-green-500 border-green-500/20",children:[(0,b.jsx)(g.CheckCircle2,{className:"w-3 h-3 mr-1"}),"Completed"]}):(0,b.jsx)(c.Badge,{variant:"outline",className:(0,q.cn)("capitalize",{pending:"bg-yellow-500/10 text-yellow-500 border-yellow-500/20",in_progress:"bg-blue-500/10 text-blue-500 border-blue-500/20",waiting:"bg-orange-500/10 text-orange-500 border-orange-500/20",review:"bg-purple-500/10 text-purple-500 border-purple-500/20",completed:"bg-green-500/10 text-green-500 border-green-500/20"}[m]||"bg-gray-500/10 text-gray-500"),children:m.replace("_"," ")})),o&&(0,b.jsxs)(c.Badge,{variant:"outline",className:"bg-orange-500/10 text-orange-500 border-orange-500/20",children:[(0,b.jsx)(h.Clock,{className:"w-3 h-3 mr-1"}),"Blocking"]})]})]}),s&&(0,b.jsx)(d.Button,{variant:"ghost",size:"icon",className:"h-8 w-8 shrink-0",onClick:()=>w(a.dependsOnTask.id),disabled:u===a.dependsOnTask.id,children:(0,b.jsx)(i.X,{className:"w-4 h-4"})})]})}),(0,b.jsx)(e.CardContent,{className:"pt-0",children:(0,b.jsxs)("div",{className:"space-y-2 text-sm",children:[a.dependsOnTask.assignees&&a.dependsOnTask.assignees.length>0&&(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(k.Users,{className:"w-4 h-4 text-muted-foreground"}),(0,b.jsx)("span",{className:"text-muted-foreground",children:"Assigned to:"}),(0,b.jsx)("div",{className:"flex flex-wrap gap-1",children:a.dependsOnTask.assignees.map(a=>(0,b.jsxs)(c.Badge,{variant:"secondary",className:"text-xs",children:[a.username,a.team&&(0,b.jsxs)("span",{className:"ml-1 text-muted-foreground",children:["(",a.team.name,")"]})]},a.id))})]}),a.dependsOnTask.team&&(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(l.default,{className:"w-4 h-4 text-muted-foreground"}),(0,b.jsx)("span",{className:"text-muted-foreground",children:"Team:"}),(0,b.jsx)(c.Badge,{variant:"outline",className:"text-xs",children:a.dependsOnTask.team.name})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(j.default,{className:"w-4 h-4 text-muted-foreground"}),(0,b.jsx)("span",{className:"text-muted-foreground",children:"Type:"}),(0,b.jsx)("span",{className:"text-xs",children:"finish_to_start"===a.dependencyType?"Finish-to-Start":a.dependencyType})]})]})})]},a.dependsOnTask.id)})})}a.s(["DependencyList",()=>r],472793)},503511,a=>{"use strict";var b=a.i(295394),c=a.i(313954),d=a.i(682600),e=a.i(97155),f=a.i(322695),g=a.i(167764),h=a.i(638236),i=a.i(210731),j=a.i(344770),k=a.i(78673),k=k,l=a.i(780963),m=a.i(760335),n=a.i(395301);let o=(0,n.createServerReference)("40b408831ea3954e375d99f8ba4ff27359527e7e4b",n.callServer,void 0,n.findSourceMapURL,"createTaskDependency"),p=(0,n.createServerReference)("40dd61ff2058f534f42f49da426a52f160b4b04ec1",n.callServer,void 0,n.findSourceMapURL,"getAvailableDependencyTasks");var q=a.i(489158),r=a.i(917710),s=a.i(401149);function t({taskId:a,projectId:n,existingDependencyIds:t=[]}){let[u,v]=(0,c.useState)(!1),[w,x]=(0,c.useState)(!1),[y,z]=(0,c.useState)(!1),[A,B]=(0,c.useState)([]),[C,D]=(0,c.useState)([]),[E,F]=(0,c.useState)(""),[G,H]=(0,c.useState)(!1),[I,J]=(0,c.useState)("");(0,q.useRouter)(),(0,c.useEffect)(()=>{u?K():(J(""),B([]),D([]),F(""))},[u,a,t]),(0,c.useEffect)(()=>{if(E.trim()){let a=E.toLowerCase();D(A.filter(b=>{let c=b.title.toLowerCase(),d=b.status.toLowerCase(),e=b.assignees&&b.assignees.length>0?b.assignees.map(a=>a.username.toLowerCase()).join(" "):b.team?b.team.name.toLowerCase():"";return c.includes(a)||d.includes(a)||e.includes(a)||b.id.toString().includes(a)}))}else D(A)},[E,A]);let K=async()=>{H(!0);try{let b=(await p(a)).filter(a=>!t.includes(a.id));console.log("Available tasks for dependency:",b.length,b),B(b),D(b)}catch(a){console.error("Failed to load available tasks:",a),alert("Failed to load tasks. Please try again."),B([])}finally{H(!1)}},L=async()=>{if(!I)return void alert("Please select a task");z(!0);try{let b=new FormData;b.append("taskId",a.toString()),b.append("dependsOnTaskId",I),b.append("dependencyType","finish_to_start");let c=await o(b);if(c.error)if(!c.error.includes("already exists"))return void alert(c.error+(c.details?`: ${c.details}`:""));else{v(!1),J(""),window.location.reload();return}v(!1),J(""),window.location.href=`/dashboard/projects/${n}/tasks/${a}`}catch(a){alert("Failed to create dependency")}finally{z(!1)}},M=A.find(a=>a.id.toString()===I);return(0,b.jsxs)(e.Dialog,{open:u,onOpenChange:v,children:[(0,b.jsx)(e.DialogTrigger,{asChild:!0,children:(0,b.jsxs)(d.Button,{variant:"outline",size:"sm",children:[(0,b.jsx)(h.Plus,{className:"w-4 h-4 mr-2"}),"Add Dependency"]})}),(0,b.jsxs)(e.DialogContent,{className:"sm:max-w-[500px]",children:[(0,b.jsxs)(e.DialogHeader,{children:[(0,b.jsx)(e.DialogTitle,{children:"Add Task Dependency"}),(0,b.jsx)(e.DialogDescription,{children:"Search and select a task that must be completed before this task can proceed."})]}),(0,b.jsxs)("div",{className:"space-y-4 py-4",children:[(0,b.jsxs)("div",{className:"space-y-2 flex flex-col",children:[(0,b.jsx)(g.Label,{children:"Prerequisite Task"}),G?(0,b.jsxs)("div",{className:"flex items-center justify-center py-4 border rounded-md",children:[(0,b.jsx)(i.Loader2,{className:"w-4 h-4 animate-spin mr-2"}),(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Loading available tasks..."})]}):0===A.length?(0,b.jsx)("div",{className:"flex items-center justify-center py-4 border rounded-md bg-muted/50",children:(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:t.length>0?"All project tasks are already linked.":"No other tasks available in this project."})}):(0,b.jsxs)(f.Popover,{open:w,onOpenChange:x,children:[(0,b.jsx)(f.PopoverTrigger,{asChild:!0,children:(0,b.jsxs)(d.Button,{variant:"outline",role:"combobox","aria-expanded":w,className:"w-full justify-between",children:[I?A.find(a=>a.id.toString()===I)?.title:"Select task...",(0,b.jsx)(k.default,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),(0,b.jsx)(f.PopoverContent,{className:"w-[450px] p-0",align:"start",children:(0,b.jsxs)("div",{className:"flex flex-col",children:[(0,b.jsxs)("div",{className:"flex items-center border-b px-3",children:[(0,b.jsx)(m.Search,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),(0,b.jsx)("input",{type:"text",placeholder:"Search tasks...",value:E,onChange:a=>F(a.target.value),className:"flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground"})]}),(0,b.jsx)("div",{className:"max-h-[300px] overflow-y-auto overflow-x-hidden p-1",children:0===C.length?(0,b.jsx)("div",{className:"py-6 text-center text-sm text-muted-foreground",children:"No task found."}):(0,b.jsx)("div",{className:"space-y-1",children:C.map(a=>{let c="completed"===a.status,d=a.assignees&&a.assignees.length>0?a.assignees.map(a=>a.username).join(", "):a.team?`Team: ${a.team.name}`:"Unassigned",e=I===a.id.toString();return(0,b.jsxs)("div",{onClick:()=>{let b=a.id.toString();J(b===I?"":b),x(!1)},className:(0,s.cn)("relative flex cursor-pointer select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors","hover:bg-accent hover:text-accent-foreground",e&&"bg-accent text-accent-foreground"),children:[(0,b.jsx)(j.Check,{className:(0,s.cn)("mr-2 h-4 w-4",e?"opacity-100":"opacity-0")}),(0,b.jsxs)("div",{className:"flex flex-col flex-1 gap-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"font-medium",children:a.title}),c&&(0,b.jsx)(r.Badge,{variant:"outline",className:"text-[10px] px-1 py-0 h-4 bg-green-500/10 text-green-500 border-green-500/20",children:"Done"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[(0,b.jsx)("span",{className:"capitalize",children:a.status.replace("_"," ")}),(0,b.jsx)("span",{children:"•"}),(0,b.jsx)("span",{children:d})]})]})]},a.id)})})})]})})]})]}),M&&(0,b.jsxs)("div",{className:"p-3 bg-muted/50 rounded-md border space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm font-medium",children:[(0,b.jsx)(l.Info,{className:"w-4 h-4 text-blue-500"}),"Selected Prerequisite"]}),(0,b.jsxs)("div",{className:"text-sm pl-6",children:[(0,b.jsx)("p",{className:"font-medium",children:M.title}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"This task must be completed before the current task can start."})]})]}),(0,b.jsxs)("div",{className:"space-y-2 pt-2",children:[(0,b.jsx)(g.Label,{children:"Dependency Type"}),(0,b.jsxs)("div",{className:"text-sm text-muted-foreground flex items-center gap-2 p-2 border rounded-md",children:[(0,b.jsx)(r.Badge,{variant:"outline",children:"Finish-to-Start"}),(0,b.jsx)("span",{children:"Mandatory: Prerequisite must finish for dependent to start."})]})]})]}),(0,b.jsxs)(e.DialogFooter,{children:[(0,b.jsx)(d.Button,{type:"button",variant:"outline",onClick:()=>v(!1),disabled:y,children:"Cancel"}),(0,b.jsxs)(d.Button,{onClick:L,disabled:y||!I||G,children:[y&&(0,b.jsx)(i.Loader2,{className:"w-4 h-4 mr-2 animate-spin"}),"Add Dependency"]})]})]})]})}a.s(["DependencyDialog",()=>t],503511)},669035,a=>{"use strict";var b=a.i(295394),c=a.i(313954),d=a.i(489158),e=a.i(515790),f=a.i(682600),g=a.i(951564),h=a.i(395301);let i=(0,h.createServerReference)("40a65e7babeb7969d8364ec60bd423ee1c78b2ae4a",h.callServer,void 0,h.findSourceMapURL,"createComment");var j=a.i(400770),k=a.i(210731),l=a.i(948340),l=l,m=a.i(917710);function n({comments:a,taskId:h,projectId:n,users:o=[]}){let[p,q]=(0,c.useState)(!1),[r,s]=(0,c.useState)(""),[t,u]=(0,c.useState)(!1),[v,w]=(0,c.useState)(""),[x,y]=(0,c.useState)(0),z=(0,c.useRef)(null),A=(0,c.useRef)(null),B=(0,d.useRouter)(),C=o.filter(a=>a.username.toLowerCase().includes(v.toLowerCase())),D=a=>{if(!z.current)return;let b=z.current,c=b.selectionStart,d=r.substring(0,c).lastIndexOf("@");if(-1!==d){let e=r.substring(c);s(r.substring(0,d)+`@${a.username} `+e),u(!1),setTimeout(()=>{let c=d+a.username.length+2;b.focus(),b.setSelectionRange(c,c)},0)}};async function E(a){a.preventDefault(),q(!0);let b=new FormData(a.currentTarget);b.set("content",r),b.append("taskId",h.toString()),b.append("projectId",n.toString());let c=await i(b);q(!1),s(""),u(!1),c?.success&&B.refresh()}return(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold",children:"Comments"}),(0,b.jsxs)("form",{onSubmit:E,className:"space-y-3",children:[(0,b.jsxs)("div",{ref:A,className:"space-y-2",children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(g.Textarea,{ref:z,name:"content",value:r,onChange:a=>{let b=a.target.value;s(b);let c=a.target.selectionStart,d=b.substring(0,c),e=d.lastIndexOf("@");if(-1!==e){let a=d.substring(e+1);if(!/[\s\n]/.test(a)){w(a),u(!0),y(0);return}}u(!1)},onKeyDown:a=>{t&&C.length>0&&("ArrowDown"===a.key?(a.preventDefault(),y(a=>a<C.length-1?a+1:a)):"ArrowUp"===a.key?(a.preventDefault(),y(a=>a>0?a-1:0)):"Enter"===a.key||"Tab"===a.key?(a.preventDefault(),D(C[x])):"Escape"===a.key&&u(!1))},placeholder:"Add Comment (type @ to mention someone)",required:!0,className:"min-h-[100px]"}),t&&C.length>0&&(0,b.jsx)("div",{className:"absolute z-50 top-full left-0 mt-1 w-[300px] rounded-md border bg-popover shadow-lg",children:(0,b.jsx)("div",{className:"max-h-[200px] overflow-y-auto p-1",children:C.map((a,c)=>(0,b.jsxs)("div",{onClick:b=>{b.preventDefault(),b.stopPropagation(),D(a)},onMouseEnter:()=>y(c),className:`
                                                flex items-center gap-2 px-2 py-1.5 rounded-sm cursor-pointer
                                                transition-colors select-none
                                                ${c===x?"bg-accent text-accent-foreground":"hover:bg-accent/50"}
                                            `,children:[(0,b.jsx)(e.Avatar,{className:"h-6 w-6",children:(0,b.jsx)(e.AvatarFallback,{className:"text-xs",children:a.username.substring(0,2).toUpperCase()})}),(0,b.jsx)("span",{className:"text-sm font-medium",children:a.username})]},a.id))})})]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Tip: Type @ followed by a username to mention someone"})]}),(0,b.jsx)(f.Button,{type:"submit",disabled:p,className:"w-full",children:p?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(k.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Adding..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(l.default,{className:"mr-2 h-4 w-4"}),"Add Comment"]})})]}),0===a.length?(0,b.jsx)("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No comments yet."}):(0,b.jsx)("div",{className:"space-y-4 pt-4 border-t",children:a.map(a=>(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsx)(e.Avatar,{className:"h-8 w-8",children:(0,b.jsx)(e.AvatarFallback,{className:"text-xs",children:a.author.username.substring(0,2).toUpperCase()})}),(0,b.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-sm font-semibold",children:a.author.username}),(0,b.jsx)("span",{className:"text-xs text-muted-foreground",suppressHydrationWarning:!0,children:(0,j.formatDistanceToNow)(new Date(a.createdAt),{addSuffix:!0})})]}),(0,b.jsx)("div",{className:"text-sm text-foreground whitespace-pre-wrap break-words",children:function(a){let c,d=/@(\w+)/g,e=[],f=0;for(;null!==(c=d.exec(a));)c.index>f&&e.push(a.substring(f,c.index)),e.push((0,b.jsxs)(m.Badge,{variant:"secondary",className:"mx-0.5 bg-primary/10 text-primary hover:bg-primary/20",children:["@",c[1]]},c.index)),f=d.lastIndex;return f<a.length&&e.push(a.substring(f)),e.length>0?e:a}(a.content)})]})]},a.id))})]})}a.s(["CommentSection",()=>n],669035)},648432,a=>{"use strict";var b=a.i(295394),c=a.i(313954),d=a.i(682600),e=a.i(97155),f=a.i(732378),g=a.i(920931),h=a.i(167764),i=a.i(951564),j=a.i(395301);let k=(0,j.createServerReference)("6066449d29d31fc61eee331d63571737ef28220e06",j.callServer,void 0,j.findSourceMapURL,"updateTask");var l=a.i(210731),m=a.i(489158);function n({task:a,projectId:j,users:n=[],open:o,onOpenChange:p}){let[q,r]=(0,c.useState)(!1),[s,t]=(0,c.useState)([]),u=(0,m.useRouter)();async function v(b){b.preventDefault(),r(!0);let c=new FormData(b.currentTarget);c.set("assigneeIds",JSON.stringify(s));let d=await k(a.id,c);r(!1),d?.success?(p(!1),u.refresh()):alert(d?.error+(d?.details?`: ${d.details}`:""))}return(0,c.useEffect)(()=>{a.assignees&&t(a.assignees.map(a=>a.id))},[a]),(0,b.jsx)(e.Dialog,{open:o,onOpenChange:p,children:(0,b.jsxs)(e.DialogContent,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[(0,b.jsxs)(e.DialogHeader,{children:[(0,b.jsx)(e.DialogTitle,{children:"Edit Task"}),(0,b.jsx)(e.DialogDescription,{children:"Update task details, assignees, and priority."})]}),(0,b.jsxs)("form",{onSubmit:v,children:[(0,b.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(h.Label,{htmlFor:"title",children:"Title *"}),(0,b.jsx)(g.Input,{id:"title",name:"title",defaultValue:a.title,placeholder:"Task title",required:!0})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(h.Label,{htmlFor:"description",children:"Description"}),(0,b.jsx)(i.Textarea,{id:"description",name:"description",defaultValue:a.description||"",placeholder:"Task description...",rows:4})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(h.Label,{htmlFor:"priority",children:"Priority"}),(0,b.jsxs)(f.Select,{name:"priority",defaultValue:a.priority,children:[(0,b.jsx)(f.SelectTrigger,{id:"priority",children:(0,b.jsx)(f.SelectValue,{placeholder:"Select priority"})}),(0,b.jsxs)(f.SelectContent,{children:[(0,b.jsx)(f.SelectItem,{value:"normal",children:"Normal"}),(0,b.jsx)(f.SelectItem,{value:"urgent",children:"Urgent"})]})]})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(h.Label,{htmlFor:"status",children:"Status"}),(0,b.jsxs)(f.Select,{name:"status",defaultValue:a.status,children:[(0,b.jsx)(f.SelectTrigger,{id:"status",children:(0,b.jsx)(f.SelectValue,{placeholder:"Select status"})}),(0,b.jsxs)(f.SelectContent,{children:[(0,b.jsx)(f.SelectItem,{value:"pending",children:"Pending"}),(0,b.jsx)(f.SelectItem,{value:"waiting",children:"Waiting"}),(0,b.jsx)(f.SelectItem,{value:"in_progress",children:"In Progress"}),(0,b.jsx)(f.SelectItem,{value:"review",children:"Review"}),(0,b.jsx)(f.SelectItem,{value:"completed",children:"Completed"})]})]})]})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(h.Label,{htmlFor:"dueDate",children:"Due Date"}),(0,b.jsx)(g.Input,{id:"dueDate",name:"dueDate",type:"date",defaultValue:(a=>{if(!a)return"";let b=new Date(a),c=b.getFullYear(),d=String(b.getMonth()+1).padStart(2,"0"),e=String(b.getDate()).padStart(2,"0");return`${c}-${d}-${e}`})(a.dueDate)})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(h.Label,{children:"Assignees"}),(0,b.jsx)("div",{className:"border rounded-md p-2 max-h-[150px] overflow-y-auto space-y-2",children:n.length>0?n.map(a=>(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)("input",{type:"checkbox",id:`assignee-${a.id}`,checked:s.includes(a.id),onChange:()=>{var b;return b=a.id,void t(a=>a.includes(b)?a.filter(a=>a!==b):[...a,b])},className:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"}),(0,b.jsx)(h.Label,{htmlFor:`assignee-${a.id}`,className:"text-sm font-normal cursor-pointer",children:a.username})]},a.id)):(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"No users available"})})]})]}),(0,b.jsxs)(e.DialogFooter,{children:[(0,b.jsx)(d.Button,{type:"button",variant:"outline",onClick:()=>p(!1),children:"Cancel"}),(0,b.jsxs)(d.Button,{type:"submit",disabled:q,children:[q&&(0,b.jsx)(l.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Update Task"]})]})]})]})})}let o=(0,j.createServerReference)("40db1cdcc45db655c6914f09995d8097bcc488bbce",j.callServer,void 0,j.findSourceMapURL,"deleteTask");var p=a.i(98668);function q({task:a,projectId:f,open:g,onOpenChange:h}){let[i,j]=(0,c.useState)(!1),k=(0,m.useRouter)();async function n(){j(!0);let b=await o(a.id);j(!1),b?.success?(h(!1),k.push(`/dashboard/projects/${f}`),k.refresh()):alert(b?.error+(b?.details?`

${b.details}`:""))}let q=(a.subtaskCount||0)>0||(a.commentCount||0)>0||(a.dependencyCount||0)>0;return(0,b.jsx)(e.Dialog,{open:g,onOpenChange:h,children:(0,b.jsxs)(e.DialogContent,{children:[(0,b.jsxs)(e.DialogHeader,{children:[(0,b.jsxs)(e.DialogTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(p.AlertTriangle,{className:"h-5 w-5 text-destructive"}),"Delete Task"]}),(0,b.jsxs)(e.DialogDescription,{children:["Are you sure you want to delete ",(0,b.jsx)("strong",{children:a.title}),"?"]})]}),(0,b.jsx)("div",{className:"py-4",children:(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["This action cannot be undone. This will permanently delete the task",q&&(0,b.jsxs)("span",{className:"block mt-2 text-destructive font-medium",children:["⚠️ Warning: This task has related data that will be permanently deleted:",a.subtaskCount&&a.subtaskCount>0&&(0,b.jsxs)("span",{className:"block",children:["• ",a.subtaskCount," subtask(s)"]}),a.commentCount&&a.commentCount>0&&(0,b.jsxs)("span",{className:"block",children:["• ",a.commentCount," comment(s)"]}),a.dependencyCount&&a.dependencyCount>0&&(0,b.jsxs)("span",{className:"block",children:["• ",a.dependencyCount," dependency relationship(s)"]})]})]})}),(0,b.jsxs)(e.DialogFooter,{children:[(0,b.jsx)(d.Button,{type:"button",variant:"outline",onClick:()=>h(!1),disabled:i,children:"Cancel"}),(0,b.jsxs)(d.Button,{type:"button",variant:"destructive",onClick:n,disabled:i,children:[i&&(0,b.jsx)(l.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Delete Task"]})]})]})})}var r=a.i(126124),s=a.i(869872);function t({task:a,projectId:e,users:f=[]}){let[g,h]=(0,c.useState)(!1),[i,j]=(0,c.useState)(!1);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(d.Button,{variant:"outline",size:"sm",onClick:()=>h(!0),children:[(0,b.jsx)(r.Edit,{className:"mr-2 h-4 w-4"}),"Edit"]}),(0,b.jsxs)(d.Button,{variant:"outline",size:"sm",onClick:()=>j(!0),className:"text-destructive hover:text-destructive",children:[(0,b.jsx)(s.Trash2,{className:"mr-2 h-4 w-4"}),"Delete"]}),(0,b.jsx)(n,{task:{id:a.id,title:a.title,description:a.description??null,priority:a.priority||"normal",status:a.status||"pending",dueDate:a.dueDate??null,assignees:(a.assignees||[]).map(a=>({id:a.id,username:a.username}))},projectId:e,users:f,open:g,onOpenChange:h}),(0,b.jsx)(q,{task:{id:a.id,title:a.title,subtaskCount:a.subtasks?.length||0,commentCount:a.comments?.length||0,dependencyCount:(a.dependencies?.length||0)+(a.dependents?.length||0)},projectId:e,open:i,onOpenChange:j})]})}a.s(["TaskActions",()=>t],648432)},992624,a=>{"use strict";var b=a.i(295394),c=a.i(313954),d=a.i(732378),e=a.i(682600),f=a.i(403215),g=a.i(434805),h=a.i(489158),i=a.i(210731);function j({taskId:a,currentStatus:j,currentTaskStatusId:k,projectId:l}){let[m,n]=(0,c.useState)(k?.toString()||j),[o,p]=(0,c.useState)(!1),[q,r]=(0,c.useState)([]),[s,t]=(0,c.useState)(!0),u=(0,h.useRouter)();(0,c.useEffect)(()=>{!async function(){t(!0);let a=await (0,g.getTaskStatuses)(!1);if(t(!1),a.success&&(r(a.taskStatuses||[]),!k&&a.taskStatuses)){let b=a.taskStatuses.find(a=>a.name.toLowerCase()===j.toLowerCase());b&&n(b.id.toString())}}()},[j,k]);let v=async()=>{let b=k?.toString()||j;if(m!==b){p(!0);try{let c=q.find(a=>a.id.toString()===m)?parseInt(m):m,d=await (0,f.updateTaskStatus)(a,c,l);d.error?(alert(d.error+(d.details?`: ${d.details}`:"")),n(b)):u.refresh()}catch(a){alert("Failed to update status"),n(b)}finally{p(!1)}}},w=k?.toString()||j;return(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(d.Select,{value:m,onValueChange:n,disabled:o||s||0===q.length,children:[(0,b.jsx)(d.SelectTrigger,{className:"flex-1",children:(0,b.jsx)(d.SelectValue,{placeholder:s?"Loading statuses...":0===q.length?"No statuses available":"Select status"})}),q.length>0&&(0,b.jsx)(d.SelectContent,{children:q.map(a=>(0,b.jsx)(d.SelectItem,{value:a.id.toString(),children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"h-3 w-3 rounded-full",style:{backgroundColor:a.color}}),(0,b.jsx)("span",{children:a.name})]})},a.id))})]}),(0,b.jsx)(e.Button,{onClick:v,disabled:o||m===w||s||0===q.length,size:"sm",children:o?(0,b.jsx)(i.Loader2,{className:"h-4 w-4 animate-spin"}):"Update"})]})}a.s(["TaskStatusUpdate",()=>j])}];

//# sourceMappingURL=nxt_New%20folder_Project_Management_NXT_src_components_tasks_1d4dbc98._.js.map