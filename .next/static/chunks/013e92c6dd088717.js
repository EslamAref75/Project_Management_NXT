(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,385008,e=>{"use strict";var s=e.i(696009),t=e.i(181340),a=e.i(479093),r=e.i(813606),l=e.i(620770),n=e.i(364850),i=e.i(956569);function d({value:e,onChange:t,onClear:a}){return(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(l.Search,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,s.jsx)(r.Input,{type:"text",placeholder:"Search tasks by name, ID, project, or assignee...",value:e,onChange:e=>t(e.target.value),className:"pl-10 pr-10"}),e&&(0,s.jsx)(i.Button,{variant:"ghost",size:"icon",className:"absolute right-1 top-1/2 h-7 w-7 -translate-y-1/2",onClick:a,children:(0,s.jsx)(n.X,{className:"h-4 w-4"})})]})}var c=e.i(304077),o=e.i(594652),x=e.i(936358),h=e.i(35490),g=e.i(315811),m=e.i(678892),u=e.i(62238),p=e.i(142113);let j=["pending","in_progress","review","waiting","completed"],b=["low","normal","high","urgent"],v=[{value:"all",label:"All Tasks"},{value:"blocked",label:"Blocked"},{value:"free",label:"Free"},{value:"blocking",label:"Blocking Others"}];function y({projectFilter:e,onProjectChange:t,statusFilter:a,onStatusChange:r,priorityFilter:l,onPriorityChange:d,assigneeFilter:y,onAssigneeChange:f,dependencyState:N,onDependencyStateChange:w,dateRange:k,onDateRangeChange:T,dateFilterType:C,onDateFilterTypeChange:D,projects:S,users:P,currentUserId:A,onClear:I}){let B=e.length>0||a.length>0||l.length>0||"all"!==y||"all"!==N||k.start||k.end;return(0,s.jsx)(c.Card,{children:(0,s.jsx)(c.CardContent,{className:"pt-6",children:(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(o.Label,{className:"text-xs",children:"Project"}),(0,s.jsxs)(m.Popover,{children:[(0,s.jsx)(m.PopoverTrigger,{asChild:!0,children:(0,s.jsxs)(i.Button,{variant:"outline",size:"sm",className:"h-9",children:[(0,s.jsx)(g.Filter,{className:"h-4 w-4 mr-2"}),"Project",e.length>0&&(0,s.jsx)(h.Badge,{variant:"secondary",className:"ml-2",children:e.length})]})}),(0,s.jsx)(m.PopoverContent,{className:"w-56",align:"start",children:(0,s.jsx)("div",{className:"space-y-2 max-h-[300px] overflow-y-auto",children:S.map(a=>(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(p.Checkbox,{id:`proj-${a.id}`,checked:e.includes(a.id.toString()),onCheckedChange:()=>{var s;return s=a.id.toString(),void(e.includes(s)?t(e.filter(e=>e!==s)):t([...e,s]))}}),(0,s.jsx)("label",{htmlFor:`proj-${a.id}`,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 cursor-pointer",children:a.name})]},a.id))})})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(o.Label,{className:"text-xs",children:"Status"}),(0,s.jsxs)(m.Popover,{children:[(0,s.jsx)(m.PopoverTrigger,{asChild:!0,children:(0,s.jsxs)(i.Button,{variant:"outline",size:"sm",className:"h-9",children:[(0,s.jsx)(g.Filter,{className:"h-4 w-4 mr-2"}),"Status",a.length>0&&(0,s.jsx)(h.Badge,{variant:"secondary",className:"ml-2",children:a.length})]})}),(0,s.jsx)(m.PopoverContent,{className:"w-56",align:"start",children:(0,s.jsx)("div",{className:"space-y-2",children:j.map(e=>(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(p.Checkbox,{id:`status-${e}`,checked:a.includes(e),onCheckedChange:()=>{a.includes(e)?r(a.filter(s=>s!==e)):r([...a,e])}}),(0,s.jsx)("label",{htmlFor:`status-${e}`,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 capitalize cursor-pointer",children:e.replace("_"," ")})]},e))})})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(o.Label,{className:"text-xs",children:"Priority"}),(0,s.jsxs)(m.Popover,{children:[(0,s.jsx)(m.PopoverTrigger,{asChild:!0,children:(0,s.jsxs)(i.Button,{variant:"outline",size:"sm",className:"h-9",children:[(0,s.jsx)(g.Filter,{className:"h-4 w-4 mr-2"}),"Priority",l.length>0&&(0,s.jsx)(h.Badge,{variant:"secondary",className:"ml-2",children:l.length})]})}),(0,s.jsx)(m.PopoverContent,{className:"w-56",align:"start",children:(0,s.jsx)("div",{className:"space-y-2",children:b.map(e=>(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(p.Checkbox,{id:`prio-${e}`,checked:l.includes(e),onCheckedChange:()=>{l.includes(e)?d(l.filter(s=>s!==e)):d([...l,e])}}),(0,s.jsx)("label",{htmlFor:`prio-${e}`,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 capitalize cursor-pointer",children:e})]},e))})})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(o.Label,{className:"text-xs",children:"Assignee"}),(0,s.jsxs)(x.Select,{value:y,onValueChange:f,children:[(0,s.jsx)(x.SelectTrigger,{className:"w-[150px] h-9",children:(0,s.jsx)(x.SelectValue,{placeholder:"All Users"})}),(0,s.jsxs)(x.SelectContent,{children:[(0,s.jsx)(x.SelectItem,{value:"all",children:"All Users"}),(0,s.jsx)(x.SelectItem,{value:"me",children:"Me"}),P.map(e=>(0,s.jsx)(x.SelectItem,{value:e.id.toString(),children:e.username},e.id))]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(o.Label,{className:"text-xs",children:"Dependency"}),(0,s.jsxs)(x.Select,{value:N,onValueChange:w,children:[(0,s.jsx)(x.SelectTrigger,{className:"w-[160px] h-9",children:(0,s.jsx)(x.SelectValue,{})}),(0,s.jsx)(x.SelectContent,{children:v.map(e=>(0,s.jsx)(x.SelectItem,{value:e.value,children:e.label},e.value))})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(o.Label,{className:"text-xs",children:"Date"}),(0,s.jsx)(m.Popover,{children:(0,s.jsx)(u.DatePickerWithRange,{date:{from:k.start,to:k.end},setDate:e=>{T({start:e?.from,end:e?.to})},className:"w-[240px]"})})]}),B&&(0,s.jsx)("div",{className:"flex items-end",children:(0,s.jsxs)(i.Button,{variant:"ghost",size:"sm",onClick:I,children:[(0,s.jsx)(n.X,{className:"h-4 w-4 mr-2"}),"Clear All"]})})]})})})}var f=e.i(612498),N=e.i(278501),w=e.i(91622);function k({viewMode:e,onViewChange:t}){return(0,s.jsxs)("div",{className:"flex items-center gap-1 border rounded-lg p-1",children:[(0,s.jsxs)(i.Button,{variant:"card"===e?"default":"ghost",size:"sm",onClick:()=>t("card"),className:(0,w.cn)("h-8","card"===e&&"bg-primary text-primary-foreground"),children:[(0,s.jsx)(f.LayoutGrid,{className:"h-4 w-4 mr-2"}),"Cards"]}),(0,s.jsxs)(i.Button,{variant:"table"===e?"default":"ghost",size:"sm",onClick:()=>t("table"),className:(0,w.cn)("h-8","table"===e&&"bg-primary text-primary-foreground"),children:[(0,s.jsx)(N.Table,{className:"h-4 w-4 mr-2"}),"Table"]})]})}var T=e.i(924130),C=e.i(690831),D=e.i(501529),S=e.i(776827),P=e.i(841644),A=e.i(892119),I=e.i(782199),B=e.i(799038),L=e.i(117807),F=e.i(307070),F=F,U=e.i(287975);function R({forecast:e,dueDate:t,compact:a=!1}){if(!e)return null;let{style:r,icon:l}=(e=>{switch(e){case"high":return{style:"bg-red-100 text-red-700 border-red-200 dark:bg-red-900/30 dark:text-red-300 dark:border-red-900",icon:I.AlertCircle};case"medium":return{style:"bg-amber-100 text-amber-700 border-amber-200 dark:bg-amber-900/30 dark:text-amber-300 dark:border-amber-900",icon:L.Clock};case"low":return{style:"bg-emerald-100 text-emerald-700 border-emerald-200 dark:bg-emerald-900/30 dark:text-emerald-300 dark:border-emerald-900",icon:B.CheckCircle2};default:return{style:"bg-muted text-muted-foreground",icon:F.default}}})(e.riskLevel),n=new Date(e.predictedDate).toLocaleDateString(void 0,{month:"short",day:"numeric"}),i=t&&new Date(e.predictedDate)>new Date(t);return a?(0,s.jsx)(U.TooltipProvider,{children:(0,s.jsxs)(U.Tooltip,{children:[(0,s.jsx)(U.TooltipTrigger,{asChild:!0,children:(0,s.jsx)("div",{className:(0,w.cn)("flex items-center justify-center p-1 rounded-full w-6 h-6",r),children:(0,s.jsx)(l,{className:"w-3.5 h-3.5"})})}),(0,s.jsxs)(U.TooltipContent,{children:[(0,s.jsx)("p",{className:"font-semibold",children:"high"===e.riskLevel?"High Risk":"Forecast"}),(0,s.jsxs)("p",{className:"text-xs",children:["Pred: ",n," (",e.confidence,"% conf)"]}),(0,s.jsx)("p",{className:"text-xs opacity-70 mt-1",children:e.explanation})]})]})}):(0,s.jsx)(U.TooltipProvider,{children:(0,s.jsxs)(U.Tooltip,{children:[(0,s.jsx)(U.TooltipTrigger,{asChild:!0,children:(0,s.jsxs)(h.Badge,{variant:"outline",className:(0,w.cn)("gap-1.5 cursor-help pl-1.5 pr-2.5 py-0.5",r),children:[(0,s.jsx)(l,{className:"w-3.5 h-3.5"}),(0,s.jsxs)("span",{className:"flex flex-col items-start leading-tight",children:[(0,s.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-wider opacity-80",children:"high"===e.riskLevel?"At Risk":"Forecast"}),(0,s.jsx)("span",{className:"text-xs font-semibold",children:i?`Late by ${n}`:`On Track (${n})`})]})]})}),(0,s.jsxs)(U.TooltipContent,{className:"max-w-[200px] text-xs",children:[(0,s.jsx)("p",{className:"font-semibold mb-1",children:"Why this forecast?"}),(0,s.jsx)("p",{children:e.explanation}),(0,s.jsxs)("div",{className:"mt-2 pt-2 border-t flex justify-between opacity-70",children:[(0,s.jsx)("span",{children:"Confidence:"}),(0,s.jsxs)("span",{children:[e.confidence,"%"]})]})]})]})})}var O=e.i(69346);function H({tasks:e,total:t,page:a,limit:r,onPageChange:l,forecasts:n}){let i=Math.ceil(t/r),d={pending:"bg-yellow-500/10 text-yellow-500 border-yellow-500/20",in_progress:"bg-blue-500/10 text-blue-500 border-blue-500/20",review:"bg-purple-500/10 text-purple-500 border-purple-500/20",completed:"bg-green-500/10 text-green-500 border-green-500/20",waiting:"bg-orange-500/10 text-orange-500 border-orange-500/20"},o={urgent:"bg-red-500/10 text-red-500 border-red-500/20",high:"bg-orange-500/10 text-orange-500 border-orange-500/20",normal:"bg-blue-500/10 text-blue-500 border-blue-500/20",low:"bg-gray-500/10 text-gray-500 border-gray-500/20"};return 0===e.length?(0,s.jsxs)("div",{className:"flex min-h-[400px] flex-col items-center justify-center rounded-md border border-dashed p-8 text-center",children:[(0,s.jsx)("h3",{className:"mt-4 text-lg font-semibold",children:"No tasks found"}),(0,s.jsx)("p",{className:"mb-4 mt-2 text-sm text-muted-foreground max-w-sm",children:"Try adjusting your filters or create a new task."})]}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:e.map(e=>{let t="waiting"===e.status||!!e.dependencies&&e.dependencies.length>0&&e.dependencies.some(e=>"completed"!==e.dependsOnTask.status),a=!!e.dueDate&&new Date(e.dueDate)<new Date&&"completed"!==e.status,r=(e=>{if(!e.plannedDate)return!1;let s=new Date;return new Date(e.plannedDate).toDateString()===s.toDateString()&&"completed"!==e.status})(e);return(0,s.jsx)(T.default,{href:`/dashboard/projects/${e.projectId}/tasks/${e.id}`,children:(0,s.jsxs)(c.Card,{className:(0,w.cn)("transition-shadow hover:shadow-md h-full cursor-pointer",t&&"border-orange-500/50",a&&"border-red-500/50",r&&"border-blue-500/50 bg-blue-50/50"),children:[(0,s.jsxs)(c.CardHeader,{className:"flex flex-row items-start justify-between space-y-0 pb-2",children:[(0,s.jsxs)("div",{className:"space-y-1 flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(c.CardTitle,{className:"text-base font-semibold leading-none line-clamp-2",children:e.title}),t&&(0,s.jsx)(U.TooltipProvider,{children:(0,s.jsxs)(U.Tooltip,{children:[(0,s.jsx)(U.TooltipTrigger,{children:(0,s.jsx)(P.Lock,{className:"h-4 w-4 text-orange-500 shrink-0"})}),(0,s.jsx)(U.TooltipContent,{children:(0,s.jsx)("p",{children:"Waiting on dependency"})})]})})]}),(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsx)(h.Badge,{variant:"outline",className:"text-xs",children:e.project?.name||"Unknown Project"})})]}),(0,s.jsxs)("div",{className:"flex flex-col items-end gap-1",children:[(0,s.jsx)(h.Badge,{className:(0,w.cn)("text-xs",d[e.status]||"bg-gray-500/10 text-gray-500 border-gray-500/20"),children:e.status.replace("_"," ")}),r&&(0,s.jsxs)(h.Badge,{variant:"secondary",className:"text-xs",children:[(0,s.jsx)(A.Target,{className:"h-3 w-3 mr-1"}),"Today"]}),n&&n[e.id]&&(0,s.jsx)("div",{className:"mt-1",children:(0,s.jsx)(R,{forecast:n[e.id],dueDate:e.dueDate,compact:!0})})]})]}),(0,s.jsxs)(c.CardContent,{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(h.Badge,{className:(0,w.cn)("text-xs",o[e.priority]||"bg-gray-500/10 text-gray-500 border-gray-500/20"),children:e.priority}),a&&(0,s.jsxs)(h.Badge,{variant:"destructive",className:"text-xs",children:[(0,s.jsx)(I.AlertCircle,{className:"h-3 w-3 mr-1"}),"Overdue"]})]}),e.assignees&&e.assignees.length>0?(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"flex -space-x-2",children:e.assignees.slice(0,3).map(e=>(0,s.jsxs)(C.Avatar,{className:"h-6 w-6 border-2 border-background",children:[(0,s.jsx)(C.AvatarImage,{src:e.avatarUrl||void 0}),(0,s.jsx)(C.AvatarFallback,{className:"text-xs",children:e.username.substring(0,2).toUpperCase()})]},e.id))}),e.assignees.length>3&&(0,s.jsxs)("span",{className:"text-xs text-muted-foreground",children:["+",e.assignees.length-3]})]}):(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Unassigned"}),e.dueDate&&(0,s.jsxs)("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[(0,s.jsx)(S.Calendar,{className:"h-3 w-3"}),(0,s.jsxs)("span",{className:(0,w.cn)(a&&"text-red-600 font-medium"),children:["Due: ",(0,D.format)(new Date(e.dueDate),"MMM d, yyyy")]})]})]})]})},e.id)})}),i>1&&(0,s.jsx)(O.Pagination,{children:(0,s.jsxs)(O.PaginationContent,{children:[(0,s.jsx)(O.PaginationItem,{children:(0,s.jsx)(O.PaginationPrevious,{onClick:()=>a>1&&l(a-1),className:1===a?"pointer-events-none opacity-50":"cursor-pointer"})}),Array.from({length:i},(e,s)=>s+1).map(e=>(0,s.jsx)(O.PaginationItem,{children:(0,s.jsx)(O.PaginationLink,{onClick:()=>l(e),isActive:e===a,className:"cursor-pointer",children:e})},e)),(0,s.jsx)(O.PaginationItem,{children:(0,s.jsx)(O.PaginationNext,{onClick:()=>a<i&&l(a+1),className:a===i?"pointer-events-none opacity-50":"cursor-pointer"})})]})})]})}var M=e.i(954871),$=e.i(402142),z=e.i(651001),V=e.i(712321);function _({tasks:e,total:a,page:r,limit:l,onPageChange:n,forecasts:d}){let[c,o]=(0,t.useState)(null),[x,g]=(0,t.useState)("asc"),m=[...e].sort((e,s)=>{let t,a;if(!c)return 0;switch(c){case"title":t=e.title.toLowerCase(),a=s.title.toLowerCase();break;case"project":t=e.project?.name?.toLowerCase()||"",a=s.project?.name?.toLowerCase()||"";break;case"status":t=e.status,a=s.status;break;case"priority":let r={urgent:4,high:3,normal:2,low:1};t=r[e.priority]||0,a=r[s.priority]||0;break;case"dueDate":t=e.dueDate?new Date(e.dueDate).getTime():0,a=s.dueDate?new Date(s.dueDate).getTime():0;break;case"assignee":t=e.assignees?.[0]?.username?.toLowerCase()||"",a=s.assignees?.[0]?.username?.toLowerCase()||"";break;default:return 0}return t<a?"asc"===x?-1:1:t>a?"asc"===x?1:-1:0}),u=Math.ceil(a/l),p={pending:"bg-yellow-500/10 text-yellow-500 border-yellow-500/20",in_progress:"bg-blue-500/10 text-blue-500 border-blue-500/20",review:"bg-purple-500/10 text-purple-500 border-purple-500/20",completed:"bg-green-500/10 text-green-500 border-green-500/20",waiting:"bg-orange-500/10 text-orange-500 border-orange-500/20"},j={urgent:"bg-red-500/10 text-red-500 border-red-500/20",high:"bg-orange-500/10 text-orange-500 border-orange-500/20",normal:"bg-blue-500/10 text-blue-500 border-blue-500/20",low:"bg-gray-500/10 text-gray-500 border-gray-500/20"},b=(e,t)=>(0,s.jsxs)(i.Button,{variant:"ghost",size:"sm",className:"h-8 data-[state=open]:bg-accent",onClick:()=>{c===e?g("asc"===x?"desc":"asc"):(o(e),g("asc"))},children:[t,c===e?"asc"===x?(0,s.jsx)(z.ArrowUp,{className:"ml-2 h-4 w-4"}):(0,s.jsx)(V.ArrowDown,{className:"ml-2 h-4 w-4"}):(0,s.jsx)($.ArrowUpDown,{className:"ml-2 h-4 w-4 opacity-50"})]});return 0===e.length?(0,s.jsxs)("div",{className:"flex min-h-[400px] flex-col items-center justify-center rounded-md border border-dashed p-8 text-center",children:[(0,s.jsx)("h3",{className:"mt-4 text-lg font-semibold",children:"No tasks found"}),(0,s.jsx)("p",{className:"mb-4 mt-2 text-sm text-muted-foreground max-w-sm",children:"Try adjusting your filters or create a new task."})]}):(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("div",{className:"rounded-md border",children:(0,s.jsxs)(M.Table,{children:[(0,s.jsx)(M.TableHeader,{children:(0,s.jsxs)(M.TableRow,{children:[(0,s.jsx)(M.TableHead,{children:b("title","Task Name")}),(0,s.jsx)(M.TableHead,{children:b("project","Project")}),(0,s.jsx)(M.TableHead,{children:b("assignee","Assignee")}),(0,s.jsx)(M.TableHead,{children:b("status","Status")}),(0,s.jsx)(M.TableHead,{children:b("priority","Priority")}),(0,s.jsx)(M.TableHead,{children:b("dueDate","Due Date")}),(0,s.jsx)(M.TableHead,{children:"Dependencies"}),(0,s.jsx)(M.TableHead,{children:"Forecast"}),(0,s.jsx)(M.TableHead,{children:"Today Task"})]})}),(0,s.jsx)(M.TableBody,{children:m.map(e=>{let t="waiting"===e.status||!!e.dependencies&&e.dependencies.length>0&&e.dependencies.some(e=>"completed"!==e.dependsOnTask.status),a=!!e.dueDate&&new Date(e.dueDate)<new Date&&"completed"!==e.status,r=(e=>{if(!e.plannedDate)return!1;let s=new Date;s.setHours(0,0,0,0);let t=new Date(e.plannedDate);return t.setHours(0,0,0,0),t.getTime()===s.getTime()&&"completed"!==e.status})(e);return(0,s.jsxs)(M.TableRow,{className:(0,w.cn)("cursor-pointer hover:bg-muted/50",t&&"bg-orange-50/50",a&&"bg-red-50/50",r&&"bg-blue-50/50"),children:[(0,s.jsx)(M.TableCell,{children:(0,s.jsxs)(T.default,{href:`/dashboard/projects/${e.projectId}/tasks/${e.id}`,className:"font-medium hover:underline flex items-center gap-2",children:[e.title,t&&(0,s.jsx)(U.TooltipProvider,{children:(0,s.jsxs)(U.Tooltip,{children:[(0,s.jsx)(U.TooltipTrigger,{children:(0,s.jsx)(P.Lock,{className:"h-4 w-4 text-orange-500"})}),(0,s.jsx)(U.TooltipContent,{children:(0,s.jsx)("p",{children:"Waiting on dependency"})})]})}),a&&(0,s.jsx)(I.AlertCircle,{className:"h-4 w-4 text-red-500"})]})}),(0,s.jsx)(M.TableCell,{children:(0,s.jsx)(h.Badge,{variant:"outline",className:"text-xs",children:e.project?.name||"Unknown"})}),(0,s.jsx)(M.TableCell,{children:e.assignees&&e.assignees.length>0?(0,s.jsx)("div",{className:"flex -space-x-2",children:e.assignees.slice(0,3).map(e=>(0,s.jsxs)(C.Avatar,{className:"h-6 w-6 border-2 border-background",children:[(0,s.jsx)(C.AvatarImage,{src:e.avatarUrl||void 0}),(0,s.jsx)(C.AvatarFallback,{className:"text-xs",children:e.username.substring(0,2).toUpperCase()})]},e.id))}):(0,s.jsx)("span",{className:"text-muted-foreground text-sm",children:"—"})}),(0,s.jsx)(M.TableCell,{children:(0,s.jsx)(h.Badge,{className:(0,w.cn)("text-xs",p[e.status]||"bg-gray-500/10 text-gray-500 border-gray-500/20"),children:e.status.replace("_"," ")})}),(0,s.jsx)(M.TableCell,{children:(0,s.jsx)(h.Badge,{className:(0,w.cn)("text-xs",j[e.priority]||"bg-gray-500/10 text-gray-500 border-gray-500/20"),children:e.priority})}),(0,s.jsx)(M.TableCell,{children:e.dueDate?(0,s.jsx)("span",{className:(0,w.cn)("text-sm",a&&"text-red-600 font-medium"),children:(0,D.format)(new Date(e.dueDate),"MMM d, yyyy")}):(0,s.jsx)("span",{className:"text-muted-foreground",children:"—"})}),(0,s.jsx)(M.TableCell,{children:t?(0,s.jsx)(U.TooltipProvider,{children:(0,s.jsxs)(U.Tooltip,{children:[(0,s.jsx)(U.TooltipTrigger,{children:(0,s.jsx)(P.Lock,{className:"h-4 w-4 text-orange-500"})}),(0,s.jsx)(U.TooltipContent,{children:(0,s.jsx)("p",{children:"Blocked by dependency"})})]})}):(0,s.jsx)("span",{className:"text-muted-foreground",children:"—"})}),(0,s.jsx)(M.TableCell,{children:d&&d[e.id]?(0,s.jsx)(R,{forecast:d[e.id],dueDate:e.dueDate,compact:!0}):(0,s.jsx)("span",{className:"text-muted-foreground",children:"—"})}),(0,s.jsx)(M.TableCell,{children:r?(0,s.jsxs)(h.Badge,{variant:"secondary",className:"text-xs",children:[(0,s.jsx)(A.Target,{className:"h-3 w-3 mr-1"}),"Today"]}):(0,s.jsx)("span",{className:"text-muted-foreground",children:"—"})})]},e.id)})})]})}),u>1&&(0,s.jsx)(O.Pagination,{children:(0,s.jsxs)(O.PaginationContent,{children:[(0,s.jsx)(O.PaginationItem,{children:(0,s.jsx)(O.PaginationPrevious,{onClick:()=>r>1&&n(r-1),className:1===r?"pointer-events-none opacity-50":"cursor-pointer"})}),Array.from({length:u},(e,s)=>s+1).map(e=>(0,s.jsx)(O.PaginationItem,{children:(0,s.jsx)(O.PaginationLink,{onClick:()=>n(e),isActive:e===r,className:"cursor-pointer",children:e})},e)),(0,s.jsx)(O.PaginationItem,{children:(0,s.jsx)(O.PaginationNext,{onClick:()=>r<u&&n(r+1),className:r===u?"pointer-events-none opacity-50":"cursor-pointer"})})]})})]})}var W=e.i(776574),E=e.i(799675),E=E,K=e.i(513363),X=e.i(292222),X=X,G=e.i(772202),G=G,q=e.i(640624),J=e.i(745999);let Q=(0,J.createServerReference)("403db43b4fa87e3c4395d96062ae591067c02e1975",J.callServer,void 0,J.findSourceMapURL,"getTasksWithFilters"),Y=(0,J.createServerReference)("4092a06687f1e4d6d11b97639f194f16619a7c015f",J.callServer,void 0,J.findSourceMapURL,"getTaskStats");var Z=e.i(946534);function ee({initialTasks:r,initialTotal:l,users:n,projects:i,currentUserId:c}){let o=(0,a.useRouter)(),x=(0,a.useSearchParams)(),[h,g]=(0,t.useTransition)(),[m,u]=(0,t.useState)(r),[p,j]=(0,t.useState)(l),[b,v]=(0,t.useState)(!1),[f,N]=(0,t.useState)(null),[w,T]=(0,t.useState)(!0),[C,D]=(0,t.useState)(null),[S,P]=(0,t.useState)(x.get("view")||"card"),[A,L]=(0,t.useState)({}),F=(0,t.useMemo)(()=>0===m.length?"":m.map(e=>e.id).sort().join(","),[m]);(0,t.useEffect)(()=>{F&&(async()=>{let{getForecastsForTasks:s}=await e.A(656924),t=m.map(e=>e.id),a=await s(t);a.success&&a.data&&L(e=>({...e,...a.data}))})()},[F,m]);let[U,R]=(0,t.useState)(x.get("search")||""),[O,M]=(0,t.useState)(x.get("project")?.split(",").filter(Boolean)||[]),[$,z]=(0,t.useState)(x.get("status")?.split(",").filter(Boolean)||[]),[V,J]=(0,t.useState)(x.get("priority")?.split(",").filter(Boolean)||[]),[ee,es]=(0,t.useState)(x.get("assignee")||"all"),[et,ea]=(0,t.useState)(x.get("dependencyState")||"all"),[er,el]=(0,t.useState)({start:x.get("startDate")?new Date(x.get("startDate")):void 0,end:x.get("endDate")?new Date(x.get("endDate")):void 0}),[en,ei]=(0,t.useState)(x.get("dateFilterType")||"dueDate"),[ed,ec]=(0,t.useState)(parseInt(x.get("page")||"1")),[eo]=(0,t.useState)(20);(0,t.useCallback)(()=>{let e=new URLSearchParams;U&&e.set("search",U),O.length>0&&e.set("project",O.join(",")),$.length>0&&e.set("status",$.join(",")),V.length>0&&e.set("priority",V.join(",")),"all"!==ee&&e.set("assignee",ee),"all"!==et&&e.set("dependencyState",et),er.start&&e.set("startDate",er.start.toISOString().split("T")[0]),er.end&&e.set("endDate",er.end.toISOString().split("T")[0]),"dueDate"!==en&&e.set("dateFilterType",en),"card"!==S&&e.set("view",S),ed>1&&e.set("page",ed.toString()),g(()=>{o.push(`/dashboard/tasks?${e.toString()}`,{scroll:!1})})},[U,O,$,V,ee,et,er,en,S,ed,o]),(0,t.useCallback)(()=>({search:U,projectId:O.length>0?O:void 0,statusId:$.length>0?$:void 0,status:$.length>0?$:void 0,priority:V.length>0?V:void 0,assigneeId:"all"!==ee?ee:void 0,dependencyState:"all"!==et?et:void 0,startDate:er.start?.toISOString(),endDate:er.end?.toISOString(),dateRange:er.start&&er.end?{from:er.start,to:er.end}:void 0,dateFilterType:en,page:ed,limit:eo}),[U,O,$,V,ee,et,er,en,ed,eo]),(0,t.useEffect)(()=>{let e=setTimeout(async()=>{v(!0),T(!0);try{let[e,s]=await Promise.all([Q({search:U,projectId:O.length>0?O:void 0,status:$.length>0?$:void 0,priority:V.length>0?V:void 0,assigneeId:"all"!==ee?ee:void 0,dependencyState:"all"!==et?et:void 0,startDate:er.start?.toISOString(),endDate:er.end?.toISOString(),dateFilterType:en,page:ed,limit:eo}),Y({search:U,projectId:O.length>0?O:void 0,statusId:$.length>0?$:void 0,priority:V.length>0?V:void 0,assigneeId:"all"!==ee?ee:void 0,dateRange:er.start&&er.end?{from:er.start,to:er.end}:void 0})]);e.success?(u(e.tasks||[]),j(e.total||0)):D(e.error||"Failed to load tasks"),s.success&&s.data&&N(s.data)}catch(e){D(e.message||"An error occurred")}finally{v(!1),T(!1)}},400*(U!==(x.get("search")||"")&&""!==U));return()=>clearTimeout(e)},[U,O,$,V,ee,et,er,en,ed,eo]),(0,t.useEffect)(()=>{let e=setTimeout(()=>{let e=new URLSearchParams;U&&e.set("search",U),O.length>0&&e.set("project",O.join(",")),$.length>0&&e.set("status",$.join(",")),V.length>0&&e.set("priority",V.join(",")),"all"!==ee&&e.set("assignee",ee),"all"!==et&&e.set("dependencyState",et),er.start&&e.set("startDate",er.start.toISOString().split("T")[0]),er.end&&e.set("endDate",er.end.toISOString().split("T")[0]),"dueDate"!==en&&e.set("dateFilterType",en),"card"!==S&&e.set("view",S),ed>1&&e.set("page",ed.toString()),g(()=>{o.push(`/dashboard/tasks?${e.toString()}`,{scroll:!1})})},100);return()=>clearTimeout(e)},[U,O,$,V,ee,et,er,en,S,ed,o]);let ex=()=>{R(""),M([]),z([]),J([]),es("all"),ea("all"),el({}),ei("dueDate"),ec(1)},eh=f?[{label:"Total Tasks",value:f.totalTasks,icon:(0,s.jsx)(E.default,{}),color:"default",onClick:ex},{label:"My Tasks",value:f.myTasks,icon:(0,s.jsx)(K.User,{}),color:"blue",onClick:()=>es(c.toString())},{label:"Today's Focus",value:f.todayTasks,icon:(0,s.jsx)(X.default,{}),color:"green",onClick:()=>{let e=new Date,s=new Date(e);s.setDate(s.getDate()+1),el({start:e,end:s}),ei("dueDate")}},{label:"Blocked",value:f.blockedTasks,icon:(0,s.jsx)(G.default,{}),color:f.blockedTasks>0?"red":"default",onClick:()=>ea("blocked")},{label:"Overdue",value:f.overdueTasks,icon:(0,s.jsx)(I.AlertCircle,{}),color:f.overdueTasks>0?"orange":"default",onClick:()=>{el({start:void 0,end:new Date}),ei("dueDate")}},{label:"Completed Today",value:f.completedToday,icon:(0,s.jsx)(B.CheckCircle2,{}),color:"default",onClick:()=>{let e=new Date,s=new Date(e);s.setDate(s.getDate()+1),el({start:e,end:s}),z(["completed"])}}]:[];return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-3xl font-bold tracking-tight",children:"All Tasks"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"View and manage tasks across all projects"})]}),(0,s.jsx)("div",{className:"flex items-center gap-3",children:(0,s.jsx)(k,{viewMode:S,onViewChange:e=>{P(e)}})})]}),(0,s.jsx)(Z.SummaryStatsCards,{cards:eh,isLoading:w}),(0,s.jsx)(d,{value:U,onChange:R,onClear:()=>{R(""),ex()}}),(0,s.jsx)(y,{projectFilter:O,onProjectChange:M,statusFilter:$,onStatusChange:z,priorityFilter:V,onPriorityChange:J,assigneeFilter:ee,onAssigneeChange:es,dependencyState:et,onDependencyStateChange:ea,dateRange:er,onDateRangeChange:el,dateFilterType:en,onDateFilterTypeChange:ei,projects:i,users:n,currentUserId:c,onClear:ex}),C&&(0,s.jsxs)(q.Alert,{variant:"destructive",children:[(0,s.jsx)(I.AlertCircle,{className:"h-4 w-4"}),(0,s.jsx)(q.AlertDescription,{children:C})]}),(0,s.jsx)("div",{className:b&&m.length>0?"opacity-50 pointer-events-none transition-opacity":"opacity-100 transition-opacity",children:0!==m.length||b?m.length>0?(0,s.jsx)(s.Fragment,{children:"card"===S?(0,s.jsx)(H,{tasks:m,total:p,page:ed,limit:eo,onPageChange:ec,forecasts:A}):(0,s.jsx)(_,{tasks:m,total:p,page:ed,limit:eo,onPageChange:ec,forecasts:A})}):(0,s.jsx)("div",{className:"space-y-4",children:[...Array(6)].map((e,t)=>(0,s.jsx)("div",{className:"h-24 bg-muted/50 rounded-lg animate-pulse"},t))}):(0,s.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,s.jsx)("p",{className:"text-muted-foreground",children:"No tasks found. Try adjusting your filters."})})}),b&&m.length>0&&(0,s.jsxs)("div",{className:"fixed bottom-6 right-6 flex items-center gap-2 bg-background border border-border rounded-lg px-4 py-2 shadow-lg z-50",children:[(0,s.jsx)(W.Loader2,{className:"h-4 w-4 animate-spin text-muted-foreground"}),(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"Updating..."})]})]})}e.s(["TasksDashboard",()=>ee],385008)}]);