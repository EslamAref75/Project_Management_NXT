(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,111011,e=>{"use strict";var t=e.i(186098);e.s(["GripVertical",()=>t.default])},139573,e=>{"use strict";var t=e.i(696009),s=e.i(181340),a=e.i(956569),l=e.i(813606),r=e.i(594652),i=e.i(991064),c=e.i(870609),n=e.i(954871),d=e.i(690905),o=e.i(238016),u=e.i(35490),x=e.i(588813),h=e.i(963904),j=e.i(237122),m=e.i(111011),p=e.i(776574),g=e.i(67693),v=e.i(745999);let f=(0,v.createServerReference)("409bfe17a6e18c6eefdf27cc2d63cd3af4ce1159fa",v.callServer,void 0,v.findSourceMapURL,"createProjectType"),b=(0,v.createServerReference)("60f8d1074cb6207c775a9d7a0e9294b9b201443e82",v.callServer,void 0,v.findSourceMapURL,"updateProjectType"),y=(0,v.createServerReference)("405efd76e418f6527f8db1a411a5ed99a6086e285e",v.callServer,void 0,v.findSourceMapURL,"deleteProjectType"),S=(0,v.createServerReference)("40a28f296d3c75f57ff9d1ea44e224268ca46fdd85",v.callServer,void 0,v.findSourceMapURL,"toggleProjectTypeStatus");var N=e.i(362987),T=e.i(479093);function C(){let[e,v]=(0,s.useState)([]),[C,D]=(0,s.useState)(!0),[k,w]=(0,s.useState)(!1),[A,F]=(0,s.useState)(!1),[B,I]=(0,s.useState)(null),[P,E]=(0,s.useState)(null),[L,R]=(0,s.useState)(!1),[H,O]=(0,s.useState)(!0),{toast:U}=(0,N.useToast)(),V=(0,T.useRouter)();(0,s.useEffect)(()=>{M()},[]);let M=async()=>{D(!0);let e=await (0,g.getProjectTypes)(!0,!0);D(!1),e.success?v(e.projectTypes||[]):U({title:"Error",description:e.error||"Failed to load project types",variant:"destructive"})},$=async e=>{e.preventDefault(),e.stopPropagation(),R(!0);try{let t=new FormData(e.currentTarget);t.set("isActive",H?"true":"false"),console.log("Form data:",{name:t.get("name"),description:t.get("description"),isActive:t.get("isActive"),displayOrder:t.get("displayOrder"),color:t.get("color"),icon:t.get("icon")});let s=B?await b(B.id,t):await f(t);if(console.log("Server result:",s),s.success)U({title:"Success",description:B?"Project type updated successfully":"Project type created successfully"}),w(!1),I(null),O(!0),M(),V.refresh();else{console.error("Error result:",s);let e=s.error||"Failed to save project type",t=s.details?`

Details: ${JSON.stringify(s.details)}`:"";U({title:"Error",description:e+t,variant:"destructive"})}}catch(e){console.error("Exception in handleSubmit:",e),U({title:"Error",description:e.message||"An unexpected error occurred",variant:"destructive"})}finally{R(!1)}},z=async()=>{if(!P)return;R(!0);let e=await y(P.id);R(!1),e.success?(U({title:"Success",description:"Project type deleted successfully"}),F(!1),E(null),M(),V.refresh()):U({title:"Error",description:e.error||"Failed to delete project type",variant:"destructive"})},G=async e=>{let t=await S(e.id);t.success?(U({title:"Success",description:`Project type ${e.isActive?"deactivated":"activated"}`}),M(),V.refresh()):U({title:"Error",description:t.error||"Failed to toggle status",variant:"destructive"})};return C?(0,t.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,t.jsx)(p.Loader2,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-medium",children:"Project Types"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Manage project types that can be assigned to projects"})]}),(0,t.jsxs)(d.Dialog,{open:k,onOpenChange:w,children:[(0,t.jsx)(d.DialogTrigger,{asChild:!0,children:(0,t.jsxs)(a.Button,{onClick:()=>{I(null),O(!0),w(!0)},children:[(0,t.jsx)(x.Plus,{className:"h-4 w-4 mr-2"}),"Add Project Type"]})}),(0,t.jsxs)(d.DialogContent,{className:"max-w-2xl",children:[(0,t.jsxs)(d.DialogHeader,{children:[(0,t.jsx)(d.DialogTitle,{children:B?"Edit Project Type":"Create Project Type"}),(0,t.jsx)(d.DialogDescription,{children:B?"Update the project type details":"Add a new project type to the system"})]}),(0,t.jsxs)("form",{onSubmit:$,children:[(0,t.jsxs)("div",{className:"space-y-4 py-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(r.Label,{htmlFor:"name",children:"Name *"}),(0,t.jsx)(l.Input,{id:"name",name:"name",defaultValue:B?.name||"",required:!0,maxLength:100})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(r.Label,{htmlFor:"description",children:"Description"}),(0,t.jsx)(i.Textarea,{id:"description",name:"description",defaultValue:B?.description||"",rows:3})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(r.Label,{htmlFor:"color",children:"Color (hex)"}),(0,t.jsx)(l.Input,{id:"color",name:"color",type:"color",defaultValue:B?.color||"#3b82f6"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(r.Label,{htmlFor:"icon",children:"Icon Name"}),(0,t.jsx)(l.Input,{id:"icon",name:"icon",defaultValue:B?.icon||"",placeholder:"e.g., Folder, Briefcase"})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(r.Label,{htmlFor:"displayOrder",children:"Display Order"}),(0,t.jsx)(l.Input,{id:"displayOrder",name:"displayOrder",type:"number",defaultValue:B?.displayOrder||0,min:0})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(c.Switch,{id:"isActive",checked:H,onCheckedChange:O}),(0,t.jsx)(r.Label,{htmlFor:"isActive",children:"Active"})]})]}),(0,t.jsxs)(d.DialogFooter,{children:[(0,t.jsx)(a.Button,{type:"button",variant:"outline",onClick:()=>{w(!1),I(null),O(!0)},disabled:L,children:"Cancel"}),(0,t.jsx)(a.Button,{type:"submit",disabled:L,children:L?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(p.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Saving..."]}):B?"Update":"Create"})]})]})]})]})]}),(0,t.jsx)("div",{className:"border rounded-lg",children:(0,t.jsxs)(n.Table,{children:[(0,t.jsx)(n.TableHeader,{children:(0,t.jsxs)(n.TableRow,{children:[(0,t.jsx)(n.TableHead,{className:"w-12"}),(0,t.jsx)(n.TableHead,{children:"Name"}),(0,t.jsx)(n.TableHead,{children:"Description"}),(0,t.jsx)(n.TableHead,{children:"Order"}),(0,t.jsx)(n.TableHead,{children:"Usage"}),(0,t.jsx)(n.TableHead,{children:"Status"}),(0,t.jsx)(n.TableHead,{className:"text-right",children:"Actions"})]})}),(0,t.jsx)(n.TableBody,{children:0===e.length?(0,t.jsx)(n.TableRow,{children:(0,t.jsx)(n.TableCell,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"No project types found. Create one to get started."})}):e.map(e=>(0,t.jsxs)(n.TableRow,{children:[(0,t.jsx)(n.TableCell,{children:(0,t.jsx)(m.GripVertical,{className:"h-4 w-4 text-muted-foreground"})}),(0,t.jsx)(n.TableCell,{children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[e.color&&(0,t.jsx)("div",{className:"h-4 w-4 rounded",style:{backgroundColor:e.color}}),(0,t.jsx)("span",{className:"font-medium",children:e.name})]})}),(0,t.jsx)(n.TableCell,{className:"max-w-md truncate",children:e.description||"-"}),(0,t.jsx)(n.TableCell,{children:e.displayOrder}),(0,t.jsx)(n.TableCell,{children:(0,t.jsxs)(u.Badge,{variant:"outline",children:[e.usageCount||0," project",1!==e.usageCount?"s":""]})}),(0,t.jsx)(n.TableCell,{children:(0,t.jsx)(u.Badge,{variant:e.isActive?"default":"secondary",children:e.isActive?"Active":"Inactive"})}),(0,t.jsx)(n.TableCell,{className:"text-right",children:(0,t.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,t.jsx)(c.Switch,{checked:e.isActive,onCheckedChange:()=>G(e)}),(0,t.jsx)(a.Button,{variant:"ghost",size:"icon",onClick:()=>{I(e),O(e.isActive),w(!0)},children:(0,t.jsx)(h.Edit,{className:"h-4 w-4"})}),(0,t.jsx)(a.Button,{variant:"ghost",size:"icon",onClick:()=>{E(e),F(!0)},children:(0,t.jsx)(j.Trash2,{className:"h-4 w-4 text-destructive"})})]})})]},e.id))})]})}),(0,t.jsx)(o.AlertDialog,{open:A,onOpenChange:F,children:(0,t.jsxs)(o.AlertDialogContent,{children:[(0,t.jsxs)(o.AlertDialogHeader,{children:[(0,t.jsx)(o.AlertDialogTitle,{children:"Delete Project Type"}),(0,t.jsxs)(o.AlertDialogDescription,{children:['Are you sure you want to delete "',P?.name,'"? This action cannot be undone.']})]}),(0,t.jsxs)(o.AlertDialogFooter,{children:[(0,t.jsx)(o.AlertDialogCancel,{disabled:L,children:"Cancel"}),(0,t.jsx)(o.AlertDialogAction,{onClick:z,disabled:L,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:L?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(p.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Deleting..."]}):"Delete"})]})]})})]})}e.s(["ProjectTypesPanel",()=>C],139573)},600105,e=>{"use strict";var t=e.i(696009),s=e.i(181340),a=e.i(956569),l=e.i(813606),r=e.i(594652),i=e.i(870609),c=e.i(954871),n=e.i(690905),d=e.i(238016),o=e.i(35490),u=e.i(588813),x=e.i(963904),h=e.i(237122),j=e.i(111011),m=e.i(776574),p=e.i(319341),g=e.i(745999);let v=(0,g.createServerReference)("40a74427d2644bccb6484ef387adfb75292463f76d",g.callServer,void 0,g.findSourceMapURL,"createProjectStatus"),f=(0,g.createServerReference)("604f6e533c8ca2a4912a1ac71147f742593e73c415",g.callServer,void 0,g.findSourceMapURL,"updateProjectStatus"),b=(0,g.createServerReference)("40ec2af0f521f12446e739887e5c43eaec70fae9f8",g.callServer,void 0,g.findSourceMapURL,"deleteProjectStatus"),y=(0,g.createServerReference)("40175cc470e34c2839ab0cca8512ab71fda5f72bb6",g.callServer,void 0,g.findSourceMapURL,"toggleProjectStatusActive");var S=e.i(362987),N=e.i(479093);function T(){let[e,g]=(0,s.useState)([]),[T,C]=(0,s.useState)(!0),[D,k]=(0,s.useState)(!1),[w,A]=(0,s.useState)(!1),[F,B]=(0,s.useState)(null),[I,P]=(0,s.useState)(null),[E,L]=(0,s.useState)(!1),[R,H]=(0,s.useState)(!1),[O,U]=(0,s.useState)(!1),[V,M]=(0,s.useState)(!0),{toast:$}=(0,S.useToast)(),z=(0,N.useRouter)();(0,s.useEffect)(()=>{G()},[]);let G=async()=>{C(!0);let e=await (0,p.getProjectStatuses)(!0);C(!1),e.success?g(e.projectStatuses||[]):$({title:"Error",description:e.error||"Failed to load project statuses",variant:"destructive"})},q=async e=>{e.preventDefault(),e.stopPropagation(),L(!0);try{let t=new FormData(e.currentTarget);t.set("isDefault",R?"true":"false"),t.set("isFinal",O?"true":"false"),t.set("isActive",V?"true":"false"),console.log("Form data:",{name:t.get("name"),color:t.get("color"),isDefault:t.get("isDefault"),isFinal:t.get("isFinal"),orderIndex:t.get("orderIndex"),isActive:t.get("isActive")});let s=F?await f(F.id,t):await v(t);if(console.log("Server result:",s),s.success)$({title:"Success",description:F?"Project status updated successfully":"Project status created successfully"}),k(!1),B(null),H(!1),U(!1),M(!0),G(),z.refresh();else{let e=s.error||"Failed to save project status",t=s.details?`

Details: ${JSON.stringify(s.details)}`:"";$({title:"Error",description:e+t,variant:"destructive"})}}catch(e){console.error("Exception in handleSubmit:",e),$({title:"Error",description:e.message||"An unexpected error occurred",variant:"destructive"})}finally{L(!1)}},J=async()=>{if(!I)return;L(!0);let e=await b(I.id);L(!1),e.success?($({title:"Success",description:"Project status deleted successfully"}),A(!1),P(null),G(),z.refresh()):$({title:"Error",description:e.error||"Failed to delete project status",variant:"destructive"})},K=async e=>{let t=await y(e.id);t.success?($({title:"Success",description:`Project status ${e.isActive?"deactivated":"activated"}`}),G(),z.refresh()):$({title:"Error",description:t.error||"Failed to toggle status",variant:"destructive"})};return T?(0,t.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,t.jsx)(m.Loader2,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-medium",children:"Project Statuses"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Manage project lifecycle states. Define workflow order and final states."})]}),(0,t.jsxs)(n.Dialog,{open:D,onOpenChange:k,children:[(0,t.jsx)(n.DialogTrigger,{asChild:!0,children:(0,t.jsxs)(a.Button,{onClick:()=>{B(null),H(!1),U(!1),M(!0),k(!0),setTimeout(()=>{let e="#6b7280",t=document.getElementById("colorPicker"),s=document.getElementById("colorText"),a=document.getElementById("color");t&&(t.value=e),s&&(s.value=e),a&&(a.value=e)},100)},children:[(0,t.jsx)(u.Plus,{className:"h-4 w-4 mr-2"}),"Add Project Status"]})}),(0,t.jsxs)(n.DialogContent,{className:"max-w-2xl",children:[(0,t.jsxs)(n.DialogHeader,{children:[(0,t.jsx)(n.DialogTitle,{children:F?"Edit Project Status":"Create Project Status"}),(0,t.jsx)(n.DialogDescription,{children:F?"Update the project status details":"Add a new project status to the system"})]}),(0,t.jsxs)("form",{onSubmit:q,children:[(0,t.jsxs)("div",{className:"space-y-4 py-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(r.Label,{htmlFor:"name",children:"Status Name *"}),(0,t.jsx)(l.Input,{id:"name",name:"name",defaultValue:F?.name||"",required:!0,maxLength:100})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(r.Label,{htmlFor:"color",children:"Color *"}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(l.Input,{id:"colorPicker",type:"color",defaultValue:F?.color||"#6b7280",className:"w-20 h-10",onChange:e=>{let t=document.getElementById("colorText"),s=document.getElementById("color");t&&(t.value=e.target.value),s&&(s.value=e.target.value)}}),(0,t.jsx)(l.Input,{id:"colorText",type:"text",defaultValue:F?.color||"#6b7280",placeholder:"#6b7280",pattern:"^#[0-9A-Fa-f]{6}$",className:"flex-1",onChange:e=>{let t=document.getElementById("colorPicker"),s=document.getElementById("color");t&&/^#[0-9A-Fa-f]{6}$/.test(e.target.value)&&(t.value=e.target.value),s&&(s.value=e.target.value)}}),(0,t.jsx)("input",{id:"color",name:"color",type:"hidden",defaultValue:F?.color||"#6b7280"})]})]}),(0,t.jsx)("div",{className:"grid grid-cols-2 gap-4",children:(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(r.Label,{htmlFor:"orderIndex",children:"Order Index"}),(0,t.jsx)(l.Input,{id:"orderIndex",name:"orderIndex",type:"number",defaultValue:F?.orderIndex||0,min:0})]})}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("input",{type:"hidden",name:"isDefault",value:R?"true":"false"}),(0,t.jsx)("input",{type:"hidden",name:"isFinal",value:O?"true":"false"}),(0,t.jsx)("input",{type:"hidden",name:"isActive",value:V?"true":"false"}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(i.Switch,{id:"isDefault",checked:R,onCheckedChange:H}),(0,t.jsx)(r.Label,{htmlFor:"isDefault",children:"Default Status"})]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground ml-8",children:"Only one status can be the default. Setting this will unset others."}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(i.Switch,{id:"isFinal",checked:O,onCheckedChange:U}),(0,t.jsx)(r.Label,{htmlFor:"isFinal",children:"Final Status"})]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground ml-8",children:"Final statuses prevent projects from moving to other statuses."}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(i.Switch,{id:"isActive",checked:V,onCheckedChange:M}),(0,t.jsx)(r.Label,{htmlFor:"isActive",children:"Active"})]})]})]}),(0,t.jsxs)(n.DialogFooter,{children:[(0,t.jsx)(a.Button,{type:"button",variant:"outline",onClick:()=>{k(!1),B(null),H(!1),U(!1),M(!0)},disabled:E,children:"Cancel"}),(0,t.jsx)(a.Button,{type:"submit",disabled:E,children:E?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Saving..."]}):F?"Update":"Create"})]})]})]})]})]}),(0,t.jsx)("div",{className:"border rounded-lg",children:(0,t.jsxs)(c.Table,{children:[(0,t.jsx)(c.TableHeader,{children:(0,t.jsxs)(c.TableRow,{children:[(0,t.jsx)(c.TableHead,{className:"w-12"}),(0,t.jsx)(c.TableHead,{children:"Name"}),(0,t.jsx)(c.TableHead,{children:"Color"}),(0,t.jsx)(c.TableHead,{children:"Order"}),(0,t.jsx)(c.TableHead,{children:"Default"}),(0,t.jsx)(c.TableHead,{children:"Final"}),(0,t.jsx)(c.TableHead,{children:"Status"}),(0,t.jsx)(c.TableHead,{className:"text-right",children:"Actions"})]})}),(0,t.jsx)(c.TableBody,{children:0===e.length?(0,t.jsx)(c.TableRow,{children:(0,t.jsx)(c.TableCell,{colSpan:8,className:"text-center py-8 text-muted-foreground",children:"No project statuses found. Create one to get started."})}):e.map(e=>(0,t.jsxs)(c.TableRow,{children:[(0,t.jsx)(c.TableCell,{children:(0,t.jsx)(j.GripVertical,{className:"h-4 w-4 text-muted-foreground"})}),(0,t.jsx)(c.TableCell,{children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"h-4 w-4 rounded",style:{backgroundColor:e.color}}),(0,t.jsx)("span",{className:"font-medium",children:e.name})]})}),(0,t.jsx)(c.TableCell,{children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"h-4 w-4 rounded",style:{backgroundColor:e.color}}),(0,t.jsx)("span",{className:"text-xs text-muted-foreground",children:e.color})]})}),(0,t.jsx)(c.TableCell,{children:e.orderIndex}),(0,t.jsx)(c.TableCell,{children:e.isDefault?(0,t.jsx)(o.Badge,{variant:"default",children:"Default"}):(0,t.jsx)("span",{className:"text-muted-foreground",children:"-"})}),(0,t.jsx)(c.TableCell,{children:e.isFinal?(0,t.jsx)(o.Badge,{variant:"secondary",children:"Final"}):(0,t.jsx)("span",{className:"text-muted-foreground",children:"-"})}),(0,t.jsx)(c.TableCell,{children:(0,t.jsx)(o.Badge,{variant:e.isActive?"default":"secondary",children:e.isActive?"Active":"Inactive"})}),(0,t.jsx)(c.TableCell,{className:"text-right",children:(0,t.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,t.jsx)(i.Switch,{checked:e.isActive,onCheckedChange:()=>K(e)}),(0,t.jsx)(a.Button,{variant:"ghost",size:"icon",onClick:()=>{B(e),H(e.isDefault),U(e.isFinal),M(e.isActive),k(!0),setTimeout(()=>{let t=e.color||"#6b7280",s=document.getElementById("colorPicker"),a=document.getElementById("colorText"),l=document.getElementById("color");s&&(s.value=t),a&&(a.value=t),l&&(l.value=t)},100)},children:(0,t.jsx)(x.Edit,{className:"h-4 w-4"})}),(0,t.jsx)(a.Button,{variant:"ghost",size:"icon",onClick:()=>{P(e),A(!0)},children:(0,t.jsx)(h.Trash2,{className:"h-4 w-4 text-destructive"})})]})})]},e.id))})]})}),(0,t.jsx)(d.AlertDialog,{open:w,onOpenChange:A,children:(0,t.jsxs)(d.AlertDialogContent,{children:[(0,t.jsxs)(d.AlertDialogHeader,{children:[(0,t.jsx)(d.AlertDialogTitle,{children:"Delete Project Status"}),(0,t.jsxs)(d.AlertDialogDescription,{children:['Are you sure you want to delete "',I?.name,'"? This action cannot be undone. If any projects are using this status, you must deactivate it instead of deleting.']})]}),(0,t.jsxs)(d.AlertDialogFooter,{children:[(0,t.jsx)(d.AlertDialogCancel,{disabled:E,children:"Cancel"}),(0,t.jsx)(d.AlertDialogAction,{onClick:J,disabled:E,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:E?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Deleting..."]}):"Delete"})]})]})})]})}e.s(["ProjectStatusesPanel",()=>T],600105)},612521,e=>{"use strict";var t=e.i(696009),s=e.i(181340),a=e.i(956569),l=e.i(813606),r=e.i(594652),i=e.i(870609),c=e.i(954871),n=e.i(690905),d=e.i(238016),o=e.i(35490),u=e.i(588813),x=e.i(963904),h=e.i(237122),j=e.i(111011),m=e.i(776574),p=e.i(579099),g=e.i(745999);let v=(0,g.createServerReference)("409ffaa16924c74c678cf301d6dd2c99296e10aaeb",g.callServer,void 0,g.findSourceMapURL,"createTaskStatus"),f=(0,g.createServerReference)("60f41f919904eb5c1356712769a66aa6e55829aaab",g.callServer,void 0,g.findSourceMapURL,"updateTaskStatus"),b=(0,g.createServerReference)("40fe576746d9067777bbe9321cc75cceccb9421471",g.callServer,void 0,g.findSourceMapURL,"deleteTaskStatus"),y=(0,g.createServerReference)("40efaf506c057383e8b5ff321991a6dfa7996990f0",g.callServer,void 0,g.findSourceMapURL,"toggleTaskStatusActive");var S=e.i(362987),N=e.i(479093);function T(){let[e,g]=(0,s.useState)([]),[T,C]=(0,s.useState)(!0),[D,k]=(0,s.useState)(!1),[w,A]=(0,s.useState)(!1),[F,B]=(0,s.useState)(null),[I,P]=(0,s.useState)(null),[E,L]=(0,s.useState)(!1),[R,H]=(0,s.useState)(!1),[O,U]=(0,s.useState)(!1),[V,M]=(0,s.useState)(!1),[$,z]=(0,s.useState)(!0),{toast:G}=(0,S.useToast)(),q=(0,N.useRouter)();(0,s.useEffect)(()=>{J()},[]);let J=async()=>{C(!0);let e=await (0,p.getTaskStatuses)(!0);C(!1),e.success?g(e.taskStatuses||[]):G({title:"Error",description:e.error||"Failed to load task statuses",variant:"destructive"})},K=async e=>{e.preventDefault(),e.stopPropagation(),L(!0);try{let t=new FormData(e.currentTarget);t.set("isDefault",R?"true":"false"),t.set("isFinal",O?"true":"false"),t.set("isBlocking",V?"true":"false"),t.set("isActive",$?"true":"false");let s=F?await f(F.id,t):await v(t);if(s.success)G({title:"Success",description:F?"Task status updated successfully":"Task status created successfully"}),k(!1),B(null),H(!1),U(!1),M(!1),z(!0),J(),q.refresh();else{let e=s.error||"Failed to save task status",t=s.details?`

Details: ${JSON.stringify(s.details)}`:"";G({title:"Error",description:e+t,variant:"destructive"})}}catch(e){G({title:"Error",description:e.message||"An unexpected error occurred",variant:"destructive"})}finally{L(!1)}},Q=async()=>{if(!I)return;let e=await b(I.id);e.success?(G({title:"Success",description:"Task status deleted successfully"}),J(),q.refresh()):G({title:"Error",description:e.error||"Failed to delete task status",variant:"destructive"}),A(!1),P(null)},W=async e=>{let t=await y(e.id);t.success?(G({title:"Success",description:`Task status ${t.taskStatus?.isActive?"activated":"deactivated"}`}),J(),q.refresh()):G({title:"Error",description:t.error||"Failed to toggle task status",variant:"destructive"})};return T?(0,t.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,t.jsx)(m.Loader2,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold",children:"Task Statuses"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Manage task workflow statuses. Define which statuses are final, blocking, or default."})]}),(0,t.jsxs)(n.Dialog,{open:D,onOpenChange:k,children:[(0,t.jsx)(n.DialogTrigger,{asChild:!0,children:(0,t.jsxs)(a.Button,{onClick:()=>{B(null),H(!1),U(!1),M(!1),z(!0),k(!0)},children:[(0,t.jsx)(u.Plus,{className:"h-4 w-4 mr-2"}),"Add Status"]})}),(0,t.jsxs)(n.DialogContent,{className:"sm:max-w-[500px] max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)(n.DialogHeader,{children:[(0,t.jsx)(n.DialogTitle,{children:F?"Edit Task Status":"Create Task Status"}),(0,t.jsx)(n.DialogDescription,{children:F?"Update the task status details.":"Add a new task status to the system."})]}),(0,t.jsxs)("form",{onSubmit:K,children:[(0,t.jsxs)("div",{className:"space-y-4 py-4",children:[(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(r.Label,{htmlFor:"name",children:"Status Name *"}),(0,t.jsx)(l.Input,{id:"name",name:"name",defaultValue:F?.name||"",placeholder:"e.g., In Progress",required:!0})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(r.Label,{htmlFor:"color",children:"Color *"}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(l.Input,{id:"colorPicker",type:"color",defaultValue:F?.color||"#6b7280",className:"w-20 h-10",onChange:e=>{let t=document.getElementById("colorText"),s=document.getElementById("color");t&&(t.value=e.target.value),s&&(s.value=e.target.value)}}),(0,t.jsx)(l.Input,{id:"colorText",type:"text",defaultValue:F?.color||"#6b7280",placeholder:"#6b7280",pattern:"^#[0-9A-Fa-f]{6}$",className:"flex-1",onChange:e=>{let t=document.getElementById("colorPicker"),s=document.getElementById("color");t&&/^#[0-9A-Fa-f]{6}$/.test(e.target.value)&&(t.value=e.target.value),s&&(s.value=e.target.value)}}),(0,t.jsx)("input",{id:"color",name:"color",type:"hidden",defaultValue:F?.color||"#6b7280"})]})]}),(0,t.jsx)("div",{className:"grid grid-cols-2 gap-4",children:(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(r.Label,{htmlFor:"orderIndex",children:"Order Index"}),(0,t.jsx)(l.Input,{id:"orderIndex",name:"orderIndex",type:"number",defaultValue:F?.orderIndex||0,min:0})]})}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("input",{type:"hidden",name:"isDefault",value:R?"true":"false"}),(0,t.jsx)("input",{type:"hidden",name:"isFinal",value:O?"true":"false"}),(0,t.jsx)("input",{type:"hidden",name:"isBlocking",value:V?"true":"false"}),(0,t.jsx)("input",{type:"hidden",name:"isActive",value:$?"true":"false"}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(i.Switch,{id:"isDefault",checked:R,onCheckedChange:H}),(0,t.jsx)(r.Label,{htmlFor:"isDefault",children:"Default Status"})]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground ml-8",children:"Only one status can be the default. Setting this will unset others."}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(i.Switch,{id:"isFinal",checked:O,onCheckedChange:U}),(0,t.jsx)(r.Label,{htmlFor:"isFinal",children:"Final Status"})]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground ml-8",children:"Tasks in final status cannot be edited."}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(i.Switch,{id:"isBlocking",checked:V,onCheckedChange:M}),(0,t.jsx)(r.Label,{htmlFor:"isBlocking",children:"Blocking Status"})]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground ml-8",children:"Tasks in blocking status prevent dependent tasks from starting."}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(i.Switch,{id:"isActive",checked:$,onCheckedChange:z}),(0,t.jsx)(r.Label,{htmlFor:"isActive",children:"Active"})]})]})]}),(0,t.jsxs)(n.DialogFooter,{children:[(0,t.jsx)(a.Button,{type:"button",variant:"outline",onClick:()=>{k(!1),B(null),H(!1),U(!1),M(!1),z(!0)},disabled:E,children:"Cancel"}),(0,t.jsx)(a.Button,{type:"submit",disabled:E,children:E?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Saving..."]}):F?"Update":"Create"})]})]})]})]})]}),(0,t.jsx)("div",{className:"border rounded-lg",children:(0,t.jsxs)(c.Table,{children:[(0,t.jsx)(c.TableHeader,{children:(0,t.jsxs)(c.TableRow,{children:[(0,t.jsx)(c.TableHead,{className:"w-12"}),(0,t.jsx)(c.TableHead,{children:"Name"}),(0,t.jsx)(c.TableHead,{children:"Color"}),(0,t.jsx)(c.TableHead,{children:"Order"}),(0,t.jsx)(c.TableHead,{children:"Default"}),(0,t.jsx)(c.TableHead,{children:"Final"}),(0,t.jsx)(c.TableHead,{children:"Blocking"}),(0,t.jsx)(c.TableHead,{children:"Status"}),(0,t.jsx)(c.TableHead,{className:"text-right",children:"Actions"})]})}),(0,t.jsx)(c.TableBody,{children:0===e.length?(0,t.jsx)(c.TableRow,{children:(0,t.jsx)(c.TableCell,{colSpan:9,className:"text-center py-8 text-muted-foreground",children:"No task statuses found. Create one to get started."})}):e.sort((e,t)=>e.orderIndex-t.orderIndex).map(e=>(0,t.jsxs)(c.TableRow,{children:[(0,t.jsx)(c.TableCell,{children:(0,t.jsx)(j.GripVertical,{className:"h-4 w-4 text-muted-foreground cursor-move"})}),(0,t.jsx)(c.TableCell,{className:"font-medium",children:e.name}),(0,t.jsx)(c.TableCell,{children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"h-4 w-4 rounded-full border",style:{backgroundColor:e.color}}),(0,t.jsx)("span",{className:"text-xs text-muted-foreground",children:e.color})]})}),(0,t.jsx)(c.TableCell,{children:e.orderIndex}),(0,t.jsx)(c.TableCell,{children:e.isDefault?(0,t.jsx)(o.Badge,{variant:"default",children:"Default"}):(0,t.jsx)("span",{className:"text-muted-foreground",children:"-"})}),(0,t.jsx)(c.TableCell,{children:e.isFinal?(0,t.jsx)(o.Badge,{variant:"secondary",children:"Final"}):(0,t.jsx)("span",{className:"text-muted-foreground",children:"-"})}),(0,t.jsx)(c.TableCell,{children:e.isBlocking?(0,t.jsx)(o.Badge,{variant:"destructive",children:"Blocking"}):(0,t.jsx)("span",{className:"text-muted-foreground",children:"-"})}),(0,t.jsx)(c.TableCell,{children:(0,t.jsx)(o.Badge,{variant:e.isActive?"default":"secondary",children:e.isActive?"Active":"Inactive"})}),(0,t.jsx)(c.TableCell,{className:"text-right",children:(0,t.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,t.jsx)(a.Button,{variant:"ghost",size:"sm",onClick:()=>{B(e),H(e.isDefault),U(e.isFinal),M(e.isBlocking),z(e.isActive),k(!0)},children:(0,t.jsx)(x.Edit,{className:"h-4 w-4"})}),(0,t.jsx)(a.Button,{variant:"ghost",size:"sm",onClick:()=>W(e),children:e.isActive?"Deactivate":"Activate"}),(0,t.jsx)(a.Button,{variant:"ghost",size:"sm",onClick:()=>{P(e),A(!0)},children:(0,t.jsx)(h.Trash2,{className:"h-4 w-4 text-destructive"})})]})})]},e.id))})]})}),(0,t.jsx)(d.AlertDialog,{open:w,onOpenChange:A,children:(0,t.jsxs)(d.AlertDialogContent,{children:[(0,t.jsxs)(d.AlertDialogHeader,{children:[(0,t.jsx)(d.AlertDialogTitle,{children:"Delete Task Status"}),(0,t.jsxs)(d.AlertDialogDescription,{children:['Are you sure you want to delete "',I?.name,'"? This action cannot be undone.',I&&(0,t.jsx)("span",{className:"block mt-2 text-sm text-muted-foreground",children:"Note: Statuses assigned to existing tasks cannot be deleted. Deactivate them instead."})]})]}),(0,t.jsxs)(d.AlertDialogFooter,{children:[(0,t.jsx)(d.AlertDialogCancel,{children:"Cancel"}),(0,t.jsx)(d.AlertDialogAction,{onClick:Q,className:"bg-destructive text-destructive-foreground",children:"Delete"})]})]})})]})}e.s(["TaskStatusesPanel",()=>T],612521)}]);