(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,812157,e=>{"use strict";var s=e.i(696009),t=e.i(304077),a=e.i(35490),r=e.i(501529),l=e.i(362395),i=e.i(989074);function n(e,s){let t=e.getFullYear()-s.getFullYear()||e.getMonth()-s.getMonth()||e.getDate()-s.getDate()||e.getHours()-s.getHours()||e.getMinutes()-s.getMinutes()||e.getSeconds()-s.getSeconds()||e.getMilliseconds()-s.getMilliseconds();return t<0?-1:t>0?1:t}var d=e.i(287975);function c({tasks:e,forecasts:c}){let o=e.filter(e=>"completed"!==e.status&&"cancelled"!==e.status&&c[e.id]&&e.dueDate).sort((e,s)=>{let t="high"===c[e.id].riskLevel?3:"medium"===c[e.id].riskLevel?2:1;return("high"===c[s.id].riskLevel?3:"medium"===c[s.id].riskLevel?2:1)-t||new Date(e.dueDate).getTime()-new Date(s.dueDate).getTime()}).slice(0,5);return 0===o.length?(0,s.jsxs)(t.Card,{children:[(0,s.jsxs)(t.CardHeader,{className:"pb-2",children:[(0,s.jsx)(t.CardTitle,{className:"text-lg",children:"Forecast Timeline"}),(0,s.jsx)(t.CardDescription,{children:"Predicted completion dates"})]}),(0,s.jsx)(t.CardContent,{children:(0,s.jsx)("div",{className:"text-center py-6 text-muted-foreground text-sm",children:"No active tasks with forecasts available."})})]}):(0,s.jsxs)(t.Card,{children:[(0,s.jsxs)(t.CardHeader,{className:"pb-2",children:[(0,s.jsx)(t.CardTitle,{className:"text-lg",children:"Forecast Timeline"}),(0,s.jsx)(t.CardDescription,{children:"Projected delays & risks"})]}),(0,s.jsx)(t.CardContent,{className:"space-y-6 pt-4",children:o.map(e=>{let t=c[e.id],o=new Date(e.dueDate),x=new Date(t.predictedDate),m=function(e,s,t){let[a,r]=(0,l.normalizeDates)(void 0,e,s),d=n(a,r),c=Math.abs((0,i.differenceInCalendarDays)(a,r));a.setDate(a.getDate()-d*c);let o=Number(n(a,r)===-d),x=d*(c-o);return 0===x?0:x}(x,o),h=m>0;return(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,s.jsx)("span",{className:"font-medium truncate max-w-[150px]",title:e.title,children:e.title}),(0,s.jsx)("div",{className:"flex items-center gap-2",children:h?(0,s.jsxs)(a.Badge,{variant:"destructive",className:"text-[10px] h-5 px-1.5",children:["+",m,"d Late"]}):(0,s.jsx)(a.Badge,{variant:"outline",className:"text-[10px] h-5 px-1.5 bg-green-500/10 text-green-600 border-green-200",children:"On Track"})})]}),(0,s.jsxs)("div",{className:"relative h-2 bg-muted rounded-full overflow-hidden w-full",children:[(0,s.jsx)("div",{className:"absolute left-0 top-0 bottom-0 w-full bg-muted"}),(0,s.jsx)(d.TooltipProvider,{children:(0,s.jsxs)(d.Tooltip,{children:[(0,s.jsx)(d.TooltipTrigger,{asChild:!0,children:(0,s.jsx)("div",{className:"absolute top-0 bottom-0 w-1 bg-black/30 z-10 cursor-help",style:{left:"60%"}})}),(0,s.jsx)(d.TooltipContent,{children:(0,s.jsxs)("p",{children:["Due: ",(0,r.format)(o,"MMM d")]})})]})}),(0,s.jsx)(d.TooltipProvider,{children:(0,s.jsxs)(d.Tooltip,{children:[(0,s.jsx)(d.TooltipTrigger,{asChild:!0,children:(0,s.jsx)("div",{className:`absolute top-0 bottom-0 w-full rounded-l-full transition-all ${h?"bg-red-500":"bg-green-500"}`,style:{width:h?"80%":"50%",opacity:.2}})}),(0,s.jsxs)(d.TooltipContent,{children:[(0,s.jsxs)("p",{children:["Predicted: ",(0,r.format)(x,"MMM d")]}),(0,s.jsx)("p",{className:"text-[10px] opacity-80",children:t.explanation})]})]})})]}),(0,s.jsxs)("div",{className:"flex justify-between text-[10px] text-muted-foreground",children:[(0,s.jsxs)("span",{children:["Due: ",(0,r.format)(o,"MMM d")]}),(0,s.jsxs)("span",{className:h?"text-red-600 font-medium":"text-green-600",children:["Pred: ",(0,r.format)(x,"MMM d")]})]})]},e.id)})})]})}e.s(["ForecastingTimeline",()=>c],812157)},481422,e=>{"use strict";var s=e.i(696009),t=e.i(35490),a=e.i(956569),r=e.i(374752),l=e.i(963904),i=e.i(588813),n=e.i(449165),d=e.i(968563),c=e.i(776827),o=e.i(846420),x=e.i(613205),m=e.i(799038),h=e.i(501529),u=e.i(924130),j=e.i(483287),g=e.i(21131),p=e.i(181340),f=e.i(791876),v=e.i(678892),N=e.i(925396),b=e.i(543857),y=e.i(617782),w=e.i(884145),C=e.i(438967),T=e.i(604208),k=e.i(479093);function S({projectId:r,isOpen:l=!0,onClose:i}){let[n,d]=(0,p.useState)([]),[c,o]=(0,p.useState)(!0),m=(0,k.useRouter)(),h=(0,p.useRef)(new Set),j=(0,p.useRef)(!1),g=async()=>{try{let{getProjectNotificationPreferences:s}=await e.A(781577),t=await s(r);if(t.success&&t.preferences&&!t.preferences.soundEnabled)return;let a=new(window.AudioContext||window.webkitAudioContext),l=a.sampleRate,i=.25*l,n=a.createBuffer(1,i,l),d=n.getChannelData(0);for(let e=0;e<i;e++){let s=e/l,t=800+200*s/.25,a=Math.min(1,s/.05),r=Math.min(1,(.25-s)/.05),i=a*r;d[e]=Math.sin(2*Math.PI*t*s)*i*.3}let c=a.createBufferSource();c.buffer=n,c.connect(a.destination),c.start(0)}catch(e){}};(0,p.useEffect)(()=>{if(!l)return void o(!1);let e=!0,s=null,t=async()=>{if(e&&"visible"===document.visibilityState){j.current||o(!0);try{let s=await (0,y.getProjectNotifications)(r,{limit:15,offset:0});if(!e)return;if(s.success&&s.notifications){let e=s.notifications.filter(e=>!e.isRead&&!h.current.has(e.id));e.length>0&&(e.some(e=>e.soundRequired||e.isUrgent)||e.length>0)&&g();let t=s.notifications.sort((e,s)=>e.isUrgent&&!s.isUrgent?-1:!e.isUrgent&&s.isUrgent?1:e.requiresAcknowledgment&&!s.requiresAcknowledgment?-1:!e.requiresAcknowledgment&&s.requiresAcknowledgment?1:new Date(s.createdAt).getTime()-new Date(e.createdAt).getTime());h.current=new Set(s.notifications.map(e=>e.id)),d(t)}}catch(e){console.error("[ProjectNotifications] Failed to load notifications:",e)}finally{j.current||(o(!1),j.current=!0)}}},a=()=>{e&&(s=setTimeout(async()=>{await t(),a()},15e3))},i=()=>{"visible"===document.visibilityState&&t()};return t(),a(),document.addEventListener("visibilitychange",i),()=>{e=!1,s&&clearTimeout(s),document.removeEventListener("visibilitychange",i)}},[r,l]);let f=async e=>{(await (0,w.markProjectNotificationAsRead)(r,e)).success&&(d(s=>s.map(s=>s.id===e?{...s,isRead:!0}:s)),m.refresh())};return(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("div",{className:"p-4 border-b",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h3",{className:"font-semibold",children:"Project Notifications (Debug)"}),(0,s.jsx)(u.default,{href:`/dashboard/projects/${r}/notifications`,onClick:i,children:(0,s.jsx)(a.Button,{variant:"ghost",size:"sm",children:"View All"})})]})}),(0,s.jsx)(b.ScrollArea,{className:"h-[400px]",children:c?(0,s.jsx)("div",{className:"p-4 text-center text-sm text-muted-foreground",children:"Loading..."}):0===n.length?(0,s.jsx)("div",{className:"p-4 text-center text-sm text-muted-foreground",children:"No notifications"}):(0,s.jsx)("div",{className:"divide-y",children:n.map(e=>{let l,n;return(0,s.jsx)("div",{className:`p-4 hover:bg-muted/50 transition-colors ${e.isUrgent?"bg-red-50 dark:bg-red-950/20 border-l-4 border-red-500":!e.isRead?"bg-blue-50/50":""}`,children:(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[e.isUrgent&&(0,s.jsx)(x.AlertTriangle,{className:"h-4 w-4 text-red-600 animate-pulse"}),(0,s.jsx)(t.Badge,{variant:e.isUrgent?"destructive":"outline",className:`text-xs ${e.isUrgent?"":(e=>{switch(e){case"task":return"bg-blue-100 text-blue-800";case"dependency":return"bg-orange-100 text-orange-800";case"today_task":return"bg-green-100 text-green-800";case"project_admin":return"bg-purple-100 text-purple-800";case"comment_mention":return"bg-indigo-100 text-indigo-800";default:return"bg-gray-100 text-gray-800"}})(e.type)}`,children:e.isUrgent?"ðŸš¨ URGENT":`${e.type} [${e.entityType}]`}),!e.isRead&&!e.isUrgent&&(0,s.jsx)("div",{className:"h-2 w-2 rounded-full bg-blue-500"}),e.requiresAcknowledgment&&!e.acknowledgedAt&&(0,s.jsx)(t.Badge,{variant:"outline",className:"text-xs border-yellow-500 text-yellow-700",children:"Requires Acknowledgment"})]}),(0,s.jsxs)("a",{href:(l="task"===e.entityType||"task"===e.type,n="comment_mention"===e.entityType||"comment_mention"===e.type,(l||n)&&e.entityId?`/dashboard/projects/${r}/tasks/${e.entityId}`:`/dashboard/projects/${r}/notifications`),onClick:()=>{e.isRead||f(e.id),i?.()},className:"block hover:bg-muted/50 rounded p-1",children:[(0,s.jsxs)("p",{className:"font-medium text-sm",children:[e.title," ",e.entityId?`(ID: ${e.entityId})`:"(No ID)"]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:e.message})]}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground mt-2",children:(0,C.formatDistanceToNow)(new Date(e.createdAt),{addSuffix:!0})})]}),!e.isRead&&!e.requiresAcknowledgment&&(0,s.jsx)(a.Button,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:s=>{s.stopPropagation(),f(e.id)},children:(0,s.jsx)(T.Check,{className:"h-4 w-4"})}),e.requiresAcknowledgment&&!e.acknowledgedAt&&(0,s.jsx)(t.Badge,{variant:"outline",className:"text-xs border-red-500 text-red-700",children:"Action Required"})]})},e.id)})})})]})}var D=e.i(142631);function A({projectId:e}){let[r,l]=(0,p.useState)(0),[i,n]=(0,p.useState)(!1),d=(0,p.useRef)(0);return(0,p.useEffect)(()=>{let s=!0,t=async()=>{if(!s||"visible"!==document.visibilityState)return;let t=await (0,N.getProjectUnreadNotificationCount)(e);s&&t.success&&void 0!==t.count&&(t.count>d.current&&(0,D.playNotificationSound)(),l(t.count),d.current=t.count)},a=()=>{"visible"===document.visibilityState&&t()};return t(),setInterval(t,5e3),()=>{s=!1,document.removeEventListener("visibilitychange",a)}},[e]),(0,s.jsxs)(v.Popover,{open:i,onOpenChange:n,children:[(0,s.jsx)(v.PopoverTrigger,{asChild:!0,children:(0,s.jsxs)(a.Button,{variant:"ghost",size:"icon",className:"relative",onClick:()=>n(!i),children:[(0,s.jsx)(f.Bell,{className:"h-5 w-5"}),r>0&&(0,s.jsx)(t.Badge,{variant:"destructive",className:"absolute -top-1 -right-1 h-5 w-5 flex items-center justify-center p-0 text-xs",children:r>99?"99+":r})]})}),(0,s.jsx)(v.PopoverContent,{className:"w-96 p-0",align:"end",children:(0,s.jsx)(S,{projectId:e,isOpen:i,onClose:()=>n(!1)})})]})}var M=e.i(453455),I=e.i(605350);function U({project:e,stats:f,canEdit:v,canMarkUrgent:N=!1}){let[b,y]=(0,p.useState)(!1);return(0,s.jsxs)("div",{className:"border-b pb-4 pt-4 space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:e.name}),(0,s.jsx)(t.Badge,{className:{planned:"bg-gray-100 text-gray-800",active:"bg-green-100 text-green-800",on_hold:"bg-yellow-100 text-yellow-800",completed:"bg-blue-100 text-blue-800",cancelled:"bg-red-100 text-red-800"}[e.status]||"bg-gray-100 text-gray-800",children:e.status}),"urgent"===e.priority&&(0,s.jsx)(t.Badge,{variant:"destructive",className:"animate-pulse",children:"ðŸš¨ URGENT"}),"high"===e.priority&&(0,s.jsx)(t.Badge,{variant:"outline",className:"border-orange-500 text-orange-700",children:"High Priority"})]}),e.description&&(0,s.jsx)("p",{className:"text-muted-foreground max-w-3xl",children:e.description})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(A,{projectId:e.id}),v&&(0,s.jsxs)(a.Button,{variant:"outline",size:"sm",onClick:()=>y(!0),children:[(0,s.jsx)(l.Edit,{className:"h-4 w-4 mr-2"}),"Edit"]}),(0,s.jsxs)(j.DropdownMenu,{children:[(0,s.jsx)(j.DropdownMenuTrigger,{asChild:!0,children:(0,s.jsx)(a.Button,{variant:"outline",size:"icon",children:(0,s.jsx)(d.MoreVertical,{className:"h-4 w-4"})})}),(0,s.jsxs)(j.DropdownMenuContent,{align:"end",children:[(0,s.jsx)(j.DropdownMenuItem,{asChild:!0,children:(0,s.jsxs)(u.default,{href:`/dashboard/projects/${e.id}/tasks/new`,children:[(0,s.jsx)(i.Plus,{className:"h-4 w-4 mr-2"}),"Add Task"]})}),(0,s.jsx)(j.DropdownMenuItem,{asChild:!0,children:(0,s.jsxs)(u.default,{href:`/dashboard/projects/${e.id}/activity`,children:[(0,s.jsx)(n.FileText,{className:"h-4 w-4 mr-2"}),"View Activity"]})}),(0,s.jsx)(j.DropdownMenuSeparator,{}),N&&"urgent"!==e.priority&&(0,s.jsx)(j.DropdownMenuItem,{asChild:!0,children:(0,s.jsx)(M.MarkUrgentDialog,{projectId:e.id,projectName:e.name,children:(0,s.jsxs)("div",{className:"flex items-center w-full",children:[(0,s.jsx)(x.AlertTriangle,{className:"h-4 w-4 mr-2"}),"Make Urgent"]})})}),N&&"urgent"===e.priority&&(0,s.jsx)(j.DropdownMenuItem,{asChild:!0,children:(0,s.jsx)(I.RemoveUrgentDialog,{projectId:e.id,projectName:e.name,children:(0,s.jsxs)("div",{className:"flex items-center w-full",children:[(0,s.jsx)(m.CheckCircle2,{className:"h-4 w-4 mr-2"}),"Remove Urgent"]})})}),(0,s.jsx)(j.DropdownMenuItem,{disabled:!0,children:"Archive Project"})]})]})]})]}),f.total>0&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Progress"}),(0,s.jsxs)("span",{className:"font-medium",children:[f.percentage,"%"]})]}),(0,s.jsx)(r.Progress,{value:f.percentage,className:"h-2"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-6 text-sm text-muted-foreground",children:[e.startDate&&(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(c.Calendar,{className:"h-4 w-4"}),(0,s.jsxs)("span",{children:[(0,h.format)(new Date(e.startDate),"MMM d, yyyy"),e.endDate&&` - ${(0,h.format)(new Date(e.endDate),"MMM d, yyyy")}`]})]}),e.projectManager&&(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(o.Users,{className:"h-4 w-4"}),(0,s.jsxs)("span",{children:["PM: ",e.projectManager.username]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("span",{children:[f.total," tasks"]}),(0,s.jsx)("span",{children:"â€¢"}),(0,s.jsxs)("span",{children:[f.totalComp," completed"]})]})]}),v&&(0,s.jsx)(g.ProjectEditDialog,{project:{id:e.id,name:e.name,type:e.type,projectTypeId:e.projectTypeId||null,projectStatusId:e.projectStatusId||null,description:e.description||"",scope:e.scope||"",status:e.status,startDate:e.startDate,endDate:e.endDate},open:b,onOpenChange:y})]})}e.s(["ProjectHeader",()=>U],481422)},420121,e=>{"use strict";var s=e.i(696009),t=e.i(512581),a=e.i(304077),r=e.i(690831),l=e.i(374752),i=e.i(799038),n=e.i(117807),d=e.i(782199),c=e.i(776827),o=e.i(846420),x=e.i(916928),m=e.i(501529),h=e.i(924130),u=e.i(181340),j=e.i(435666),g=e.i(776574);function p({projectId:e}){let[t,a]=(0,u.useState)([]),[r,l]=(0,u.useState)(!0);return((0,u.useEffect)(()=>{!async function(){try{let s=await (0,j.getActivityLogs)({projectId:e,limit:10});s.success&&a(s.logs||[])}catch(e){console.error("Failed to load activities:",e)}finally{l(!1)}}()},[e]),r)?(0,s.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,s.jsx)(g.Loader2,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):0===t.length?(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"No recent activity"}):(0,s.jsx)("div",{className:"space-y-3",children:t.map(e=>(0,s.jsx)("div",{className:"flex items-start gap-3 p-3 border rounded-lg",children:(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:e.actionSummary}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:[e.performedBy?.username||"Unknown"," â€¢"," ",(0,m.format)(new Date(e.createdAt),"MMM d, yyyy 'at' h:mm a")]})]})},e.id))})}var f=e.i(35490);function v({project:e,blockedTasks:t}){return 0===t.length?(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"No blocked tasks"}):(0,s.jsxs)("div",{className:"space-y-3",children:[t.slice(0,5).map(t=>{let a=t.dependencies?.filter(e=>"completed"!==e.dependsOnTask.status)||[];return(0,s.jsx)(h.default,{href:`/dashboard/projects/${e.id}/tasks/${t.id}`,className:"block p-3 border rounded-lg hover:bg-muted transition-colors",children:(0,s.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,s.jsx)(d.AlertCircle,{className:"h-4 w-4 text-yellow-600"}),(0,s.jsx)("span",{className:"font-medium",children:t.title})]}),a.length>0&&(0,s.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["Waiting for: ",a.map(e=>e.dependsOnTask.title).join(", ")]})]}),(0,s.jsx)(f.Badge,{variant:"outline",className:"text-yellow-600 border-yellow-600",children:"Blocked"})]})},t.id)}),t.length>5&&(0,s.jsxs)("p",{className:"text-xs text-muted-foreground text-center",children:["+",t.length-5," more blocked tasks"]})]})}function N({project:e,stats:t,users:u}){let j=e.tasks?.filter(e=>"waiting"===e.status||!!e.dependencies&&e.dependencies.length>0&&e.dependencies.some(e=>"completed"!==e.dependsOnTask.status))||[],g=e.tasks?.filter(e=>e.dueDate&&"completed"!==e.status).sort((e,s)=>new Date(e.dueDate).getTime()-new Date(s.dueDate).getTime()).slice(0,5)||[],f=new Map;return e.tasks?.forEach(e=>{e.assignees?.forEach(e=>{f.has(e.id)||f.set(e.id,e)})}),(0,s.jsxs)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:[(0,s.jsxs)(a.Card,{className:"md:col-span-2 lg:col-span-3",children:[(0,s.jsxs)(a.CardHeader,{children:[(0,s.jsx)(a.CardTitle,{children:"Project Summary"}),(0,s.jsx)(a.CardDescription,{children:"Overview of project status and progress"})]}),(0,s.jsxs)(a.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:t.total}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Total Tasks"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-green-600",children:t.totalComp}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Completed"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:t.totalInProgress}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"In Progress"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-yellow-600",children:j.length}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Blocked"})]})]}),t.total>0&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Overall Progress"}),(0,s.jsxs)("span",{className:"font-medium",children:[t.percentage,"%"]})]}),(0,s.jsx)(l.Progress,{value:t.percentage,className:"h-2"})]})]})]},"overview-project-summary"),(0,s.jsxs)(a.Card,{children:[(0,s.jsx)(a.CardHeader,{children:(0,s.jsxs)(a.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(x.TrendingUp,{className:"h-5 w-5"}),"Task Statistics"]})}),(0,s.jsx)(a.CardContent,{className:"space-y-4",children:(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(i.CheckCircle2,{className:"h-4 w-4 text-green-600"}),(0,s.jsx)("span",{className:"text-sm",children:"Completed"})]}),(0,s.jsx)("span",{className:"font-semibold",children:t.totalComp})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(n.Clock,{className:"h-4 w-4 text-blue-600"}),(0,s.jsx)("span",{className:"text-sm",children:"In Progress"})]}),(0,s.jsx)("span",{className:"font-semibold",children:t.totalInProgress})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(d.AlertCircle,{className:"h-4 w-4 text-yellow-600"}),(0,s.jsx)("span",{className:"text-sm",children:"Blocked"})]}),(0,s.jsx)("span",{className:"font-semibold",children:j.length})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(n.Clock,{className:"h-4 w-4 text-gray-600"}),(0,s.jsx)("span",{className:"text-sm",children:"Pending"})]}),(0,s.jsx)("span",{className:"font-semibold",children:t.totalPending})]})]})})]},"overview-task-stats"),(0,s.jsxs)(a.Card,{children:[(0,s.jsx)(a.CardHeader,{children:(0,s.jsxs)(a.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(c.Calendar,{className:"h-5 w-5"}),"Upcoming Deadlines"]})}),(0,s.jsx)(a.CardContent,{children:0===g.length?(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"No upcoming deadlines"}):(0,s.jsx)("div",{className:"space-y-3",children:g.map((t,a)=>(0,s.jsx)(h.default,{href:`/dashboard/projects/${e.id}/tasks/${t.id}`,className:"block p-2 border rounded hover:bg-muted transition-colors",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-sm font-medium truncate",children:t.title}),(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:(0,m.format)(new Date(t.dueDate),"MMM d")})]})},`deadline-${t.id}-${a}`))})})]},"overview-upcoming-deadlines"),(0,s.jsxs)(a.Card,{children:[(0,s.jsx)(a.CardHeader,{children:(0,s.jsxs)(a.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(o.Users,{className:"h-5 w-5"}),"Team Members"]})}),(0,s.jsx)(a.CardContent,{children:0===f.size?(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"No members assigned"}):(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:Array.from(f.values()).map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center gap-2 p-2 border rounded",children:[(0,s.jsxs)(r.Avatar,{className:"h-8 w-8",children:[(0,s.jsx)(r.AvatarImage,{src:e.avatarUrl||void 0}),(0,s.jsx)(r.AvatarFallback,{children:e.username.substring(0,2).toUpperCase()})]}),(0,s.jsx)("span",{className:"text-sm",children:e.username})]},`assignee-${e.id}-${t}`))})})]},"overview-assigned-members"),(0,s.jsxs)(a.Card,{className:"md:col-span-2",children:[(0,s.jsxs)(a.CardHeader,{children:[(0,s.jsxs)(a.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(d.AlertCircle,{className:"h-5 w-5 text-yellow-600"}),"Blocked Tasks"]}),(0,s.jsx)(a.CardDescription,{children:"Tasks waiting for dependencies"})]}),(0,s.jsx)(a.CardContent,{children:(0,s.jsx)(v,{project:e,blockedTasks:j})})]},"overview-blocked-tasks"),(0,s.jsxs)(a.Card,{className:"md:col-span-2 lg:col-span-3",children:[(0,s.jsxs)(a.CardHeader,{children:[(0,s.jsx)(a.CardTitle,{children:"Recent Activity"}),(0,s.jsx)(a.CardDescription,{children:"Last 10 actions in this project"})]}),(0,s.jsx)(a.CardContent,{children:(0,s.jsx)(p,{projectId:e.id})})]},"overview-recent-activity")]})}var b=e.i(479093),y=e.i(813606),w=e.i(936358),C=e.i(954871),T=e.i(620770),k=e.i(956569),S=e.i(690905),D=e.i(594652),A=e.i(991064),M=e.i(745999);let I=(0,M.createServerReference)("402d88094f0d43ffbbdb2cc55981130389e939c098",M.callServer,void 0,M.findSourceMapURL,"createTask");var U=e.i(588813);function B({projectId:e,users:t=[]}){let[a,r]=(0,u.useState)(!1),[l,i]=(0,u.useState)(!1),n=(0,u.useRef)(null),d=(0,b.useRouter)();async function c(s){if(s.preventDefault(),i(!0),!n.current)return;let t=new FormData(n.current);t.append("projectId",e.toString());let a=[];n.current.querySelectorAll('input[name="assigneeIds"]:checked').forEach(e=>{a.push(parseInt(e.value))}),t.set("assigneeIds",JSON.stringify(a));try{console.log("Creating task with data:",Object.fromEntries(t.entries()));let e=await I(t);console.log("Task creation result:",e),e?.success?(n.current?.reset(),r(!1),d.refresh()):(console.error("Task creation failed:",e?.error,e?.details),alert(e?.error||e?.details||"Failed to create task"))}catch(e){console.error("Task creation error:",e),alert(e?.message||"An unexpected error occurred")}finally{i(!1)}}return(0,s.jsxs)(S.Dialog,{open:a,onOpenChange:r,children:[(0,s.jsx)(S.DialogTrigger,{asChild:!0,children:(0,s.jsxs)(k.Button,{children:[(0,s.jsx)(U.Plus,{className:"mr-2 h-4 w-4"}),"Add Task"]})}),(0,s.jsxs)(S.DialogContent,{className:"sm:max-w-[500px]",children:[(0,s.jsxs)(S.DialogHeader,{children:[(0,s.jsx)(S.DialogTitle,{children:"Create Task"}),(0,s.jsx)(S.DialogDescription,{children:"Add a new task to this project."})]}),(0,s.jsxs)("form",{onSubmit:c,ref:n,children:[(0,s.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(D.Label,{htmlFor:"title",children:"Title"}),(0,s.jsx)(y.Input,{id:"title",name:"title",required:!0,placeholder:"Task title"})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(D.Label,{htmlFor:"description",children:"Description"}),(0,s.jsx)(A.Textarea,{id:"description",name:"description",placeholder:"Describe the task..."})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(D.Label,{htmlFor:"priority",children:"Priority"}),(0,s.jsxs)("select",{id:"priority",name:"priority",defaultValue:"normal",className:"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",children:[(0,s.jsx)("option",{value:"low",children:"Low"}),(0,s.jsx)("option",{value:"normal",children:"Normal"}),(0,s.jsx)("option",{value:"high",children:"High"}),(0,s.jsx)("option",{value:"urgent",children:"Urgent"})]})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(D.Label,{htmlFor:"dueDate",children:"Due Date"}),(0,s.jsx)(y.Input,{type:"date",id:"dueDate",name:"dueDate"})]})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(D.Label,{children:"Assignees"}),(0,s.jsx)("div",{className:"border rounded-md p-2 max-h-[150px] overflow-y-auto space-y-2",children:t.length>0?t.map(e=>(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("input",{type:"checkbox",id:`assignee-${e.id}`,name:"assigneeIds",value:e.id,className:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary",onChange:e=>{}}),(0,s.jsx)(D.Label,{htmlFor:`assignee-${e.id}`,className:"text-sm font-normal cursor-pointer",children:e.username})]},e.id)):(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"No users available"})})]})]}),(0,s.jsx)(S.DialogFooter,{children:(0,s.jsxs)(k.Button,{type:"submit",disabled:l,children:[l&&(0,s.jsx)(g.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Create Task"]})})]})]})]})}function P({project:e,users:t}){let l=(0,b.useSearchParams)(),[i,n]=(0,u.useState)(l.get("search")||""),[o,x]=(0,u.useState)(l.get("status")||"all"),[j,g]=(0,u.useState)(l.get("priority")||"all"),[p,v]=(0,u.useState)(l.get("assignee")||l.get("user")||"all");(0,u.useEffect)(()=>{let e=l.get("status"),s=l.get("priority"),t=l.get("assignee")||l.get("user");e&&x(e),s&&g(s),t&&v(t)},[l]);let N=e.tasks||[],k=N.filter(e=>(!i||!!e.title.toLowerCase().includes(i.toLowerCase()))&&("all"===o||e.status===o)&&("all"===j||e.priority===j)&&("all"===p||!!e.assignees?.some(e=>e.id===parseInt(p)))&&!0),S={pending:"bg-yellow-500/10 text-yellow-500 border-yellow-500/20",in_progress:"bg-blue-500/10 text-blue-500 border-blue-500/20",review:"bg-purple-500/10 text-purple-500 border-purple-500/20",completed:"bg-green-500/10 text-green-500 border-green-500/20",waiting:"bg-orange-500/10 text-orange-500 border-orange-500/20"},D={urgent:"bg-red-500/10 text-red-500 border-red-500/20",high:"bg-orange-500/10 text-orange-500 border-orange-500/20",normal:"bg-blue-500/10 text-blue-500 border-blue-500/20",low:"bg-gray-500/10 text-gray-500 border-gray-500/20"};return(0,s.jsxs)(a.Card,{children:[(0,s.jsx)(a.CardHeader,{children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(a.CardTitle,{children:"Tasks"}),(0,s.jsxs)(a.CardDescription,{children:[k.length," of ",N.length," tasks"]})]}),(0,s.jsx)(B,{projectId:e.id,users:t})]})}),(0,s.jsxs)(a.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex flex-wrap gap-4",children:[(0,s.jsx)("div",{className:"flex-1 min-w-[200px]",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(T.Search,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),(0,s.jsx)(y.Input,{placeholder:"Search tasks...",value:i,onChange:e=>n(e.target.value),className:"pl-8"})]})}),(0,s.jsx)("div",{children:(0,s.jsxs)(w.Select,{value:o,onValueChange:x,children:[(0,s.jsx)(w.SelectTrigger,{className:"w-[150px]",children:(0,s.jsx)(w.SelectValue,{placeholder:"Status"})}),(0,s.jsxs)(w.SelectContent,{children:[(0,s.jsx)(w.SelectItem,{value:"all",children:"All Status"}),(0,s.jsx)(w.SelectItem,{value:"pending",children:"Pending"}),(0,s.jsx)(w.SelectItem,{value:"in_progress",children:"In Progress"}),(0,s.jsx)(w.SelectItem,{value:"review",children:"Review"}),(0,s.jsx)(w.SelectItem,{value:"completed",children:"Completed"}),(0,s.jsx)(w.SelectItem,{value:"waiting",children:"Waiting"})]})]})}),(0,s.jsx)("div",{children:(0,s.jsxs)(w.Select,{value:j,onValueChange:g,children:[(0,s.jsx)(w.SelectTrigger,{className:"w-[150px]",children:(0,s.jsx)(w.SelectValue,{placeholder:"Priority"})}),(0,s.jsxs)(w.SelectContent,{children:[(0,s.jsx)(w.SelectItem,{value:"all",children:"All Priorities"}),(0,s.jsx)(w.SelectItem,{value:"urgent",children:"Urgent"}),(0,s.jsx)(w.SelectItem,{value:"high",children:"High"}),(0,s.jsx)(w.SelectItem,{value:"normal",children:"Normal"}),(0,s.jsx)(w.SelectItem,{value:"low",children:"Low"})]})]})}),(0,s.jsx)("div",{children:(0,s.jsxs)(w.Select,{value:p,onValueChange:v,children:[(0,s.jsx)(w.SelectTrigger,{className:"w-[150px]",children:(0,s.jsx)(w.SelectValue,{placeholder:"Assignee"})}),(0,s.jsxs)(w.SelectContent,{children:[(0,s.jsx)(w.SelectItem,{value:"all",children:"All Users"}),t.map(e=>(0,s.jsx)(w.SelectItem,{value:e.id.toString(),children:e.username},e.id))]})]})})]}),(0,s.jsx)("div",{className:"border rounded-lg",children:(0,s.jsxs)(C.Table,{children:[(0,s.jsx)(C.TableHeader,{children:(0,s.jsxs)(C.TableRow,{children:[(0,s.jsx)(C.TableHead,{children:"Task"}),(0,s.jsx)(C.TableHead,{children:"Assignee"}),(0,s.jsx)(C.TableHead,{children:"Status"}),(0,s.jsx)(C.TableHead,{children:"Priority"}),(0,s.jsx)(C.TableHead,{children:"Due Date"}),(0,s.jsx)(C.TableHead,{children:"Dependencies"})]})}),(0,s.jsx)(C.TableBody,{children:0===k.length?(0,s.jsx)(C.TableRow,{children:(0,s.jsx)(C.TableCell,{colSpan:6,className:"text-center py-8 text-muted-foreground",children:"No tasks found"})}):k.map(t=>{let a="waiting"===t.status||t.dependencies&&t.dependencies.some(e=>"completed"!==e.dependsOnTask.status);return(0,s.jsxs)(C.TableRow,{className:"cursor-pointer hover:bg-muted/50",children:[(0,s.jsx)(C.TableCell,{children:(0,s.jsx)(h.default,{href:`/dashboard/projects/${e.id}/tasks/${t.id}`,className:"font-medium hover:underline",children:t.title})}),(0,s.jsx)(C.TableCell,{children:(0,s.jsxs)("div",{className:"flex -space-x-2",children:[t.assignees&&Array.isArray(t.assignees)&&t.assignees.slice(0,3).map((e,a)=>(0,s.jsxs)(r.Avatar,{className:"h-6 w-6 border-2 border-background",children:[(0,s.jsx)(r.AvatarImage,{src:e.avatarUrl||void 0}),(0,s.jsx)(r.AvatarFallback,{className:"text-xs",children:e.username?.substring(0,2).toUpperCase()||"??"})]},`assignee-${t.id}-${e.id}-${a}`)),t.assignees&&Array.isArray(t.assignees)&&t.assignees.length>3&&(0,s.jsxs)("div",{className:"h-6 w-6 rounded-full bg-muted border-2 border-background flex items-center justify-center text-xs",children:["+",t.assignees.length-3]},`more-assignees-${t.id}`)]})}),(0,s.jsx)(C.TableCell,{children:(0,s.jsx)(f.Badge,{className:S[t.status]||"bg-gray-500/10 text-gray-500 border-gray-500/20",children:t.status})}),(0,s.jsx)(C.TableCell,{children:(0,s.jsx)(f.Badge,{className:D[t.priority]||"bg-gray-500/10 text-gray-500 border-gray-500/20",children:t.priority})}),(0,s.jsx)(C.TableCell,{children:t.dueDate?(0,s.jsxs)("div",{className:"flex items-center gap-1 text-sm",children:[(0,s.jsx)(c.Calendar,{className:"h-3 w-3"}),(0,m.format)(new Date(t.dueDate),"MMM d, yyyy")]}):(0,s.jsx)("span",{className:"text-muted-foreground text-sm",children:"â€”"})}),(0,s.jsx)(C.TableCell,{children:a?(0,s.jsx)(d.AlertCircle,{className:"h-4 w-4 text-yellow-600"}):(0,s.jsx)("span",{className:"text-muted-foreground",children:"â€”"})})]},t.id)})})]})})]})]})}let R=(0,e.i(845777).default)(()=>e.A(708344).then(e=>({default:e.ProjectKanbanBoard})),{loadableGenerated:{modules:[522012]},ssr:!1});function L({project:e,users:t}){return(0,s.jsxs)(a.Card,{children:[(0,s.jsx)(a.CardHeader,{children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(a.CardTitle,{children:"Kanban Board"}),(0,s.jsx)(a.CardDescription,{children:"Drag and drop tasks to update their status"})]}),(0,s.jsx)(k.Button,{asChild:!0,children:(0,s.jsxs)(h.default,{href:`/dashboard/projects/${e.id}/tasks/new`,children:[(0,s.jsx)(U.Plus,{className:"h-4 w-4 mr-2"}),"Add Task"]})})]})}),(0,s.jsx)(a.CardContent,{children:(0,s.jsx)(R,{project:e,users:t})})]})}function F({project:e,users:t}){let l=e.projectTeams||[],i=new Map;return l.forEach(e=>{e.team.teamLead&&i.set(e.team.teamLead.id,{...e.team.teamLead,role:"Team Lead",team:e.team.name}),e.team.members?.forEach(s=>{i.has(s.user.id)||i.set(s.user.id,{...s.user,role:s.role,team:e.team.name})})}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)(a.Card,{children:[(0,s.jsxs)(a.CardHeader,{children:[(0,s.jsxs)(a.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(o.Users,{className:"h-5 w-5"}),"Assigned Teams"]}),(0,s.jsx)(a.CardDescription,{children:"Teams working on this project"})]}),(0,s.jsx)(a.CardContent,{children:0===l.length?(0,s.jsxs)("div",{className:"text-center py-8 border border-dashed rounded-lg",children:[(0,s.jsx)(o.Users,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),(0,s.jsx)("p",{className:"text-muted-foreground mb-4",children:"No teams assigned"}),(0,s.jsxs)(k.Button,{variant:"outline",size:"sm",children:[(0,s.jsx)(U.Plus,{className:"h-4 w-4 mr-2"}),"Assign Team"]})]}):(0,s.jsx)("div",{className:"space-y-4",children:l.map(e=>(0,s.jsxs)("div",{className:"p-4 border rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-semibold",children:e.team.name}),e.team.description&&(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:e.team.description})]}),(0,s.jsxs)(f.Badge,{children:[e.team._count.members," members"]})]}),e.team.teamLead&&(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"Lead:"}),(0,s.jsxs)(r.Avatar,{className:"h-6 w-6",children:[(0,s.jsx)(r.AvatarImage,{src:e.team.teamLead.avatarUrl||void 0}),(0,s.jsx)(r.AvatarFallback,{className:"text-xs",children:e.team.teamLead.username.substring(0,2).toUpperCase()})]}),(0,s.jsx)("span",{className:"text-sm",children:e.team.teamLead.username})]})]},e.id))})})]}),(0,s.jsxs)(a.Card,{children:[(0,s.jsxs)(a.CardHeader,{children:[(0,s.jsx)(a.CardTitle,{children:"All Team Members"}),(0,s.jsx)(a.CardDescription,{children:"All members from assigned teams"})]}),(0,s.jsx)(a.CardContent,{children:0===i.size?(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"No team members"}):(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Array.from(i.values()).map(e=>(0,s.jsxs)("div",{className:"flex items-center gap-3 p-3 border rounded-lg",children:[(0,s.jsxs)(r.Avatar,{children:[(0,s.jsx)(r.AvatarImage,{src:e.avatarUrl||void 0}),(0,s.jsx)(r.AvatarFallback,{children:e.username.substring(0,2).toUpperCase()})]}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"font-medium",children:e.username}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:[e.role," â€¢ ",e.team]})]})]},e.id))})})]})]})}function $({project:e,users:t}){let[r,l]=(0,u.useState)("all"),[i,n]=(0,u.useState)([]),[d,o]=(0,u.useState)(!1);return(0,s.jsxs)(a.Card,{children:[(0,s.jsx)(a.CardHeader,{children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(a.CardTitle,{children:"Today's Tasks"}),(0,s.jsx)(a.CardDescription,{children:"Daily focus tasks for this project"})]}),(0,s.jsx)(k.Button,{asChild:!0,children:(0,s.jsxs)(h.default,{href:"/dashboard/today-tasks-assignment",children:[(0,s.jsx)(U.Plus,{className:"h-4 w-4 mr-2"}),"Manage Today's Tasks"]})})]})}),(0,s.jsxs)(a.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)(w.Select,{value:r,onValueChange:l,children:[(0,s.jsx)(w.SelectTrigger,{className:"w-[200px]",children:(0,s.jsx)(w.SelectValue,{placeholder:"Filter by user"})}),(0,s.jsxs)(w.SelectContent,{children:[(0,s.jsx)(w.SelectItem,{value:"all",children:"All Users"}),t.map(e=>(0,s.jsx)(w.SelectItem,{value:e.id.toString(),children:e.username},e.id))]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,s.jsx)(c.Calendar,{className:"h-4 w-4"}),(0,m.format)(new Date,"EEEE, MMMM d, yyyy")]})]}),(0,s.jsxs)("div",{className:"text-center py-12 border border-dashed rounded-lg",children:[(0,s.jsx)(c.Calendar,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Today's Tasks view for this project"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:'Use the "Manage Today\'s Tasks" button to assign tasks'})]})]})]})}var H=e.i(646965),E=e.i(918752),E=E,O=e.i(666661),z=e.i(237122);let V=(0,M.createServerReference)("40c036377622299eab7c3fedd2f88987461f8f0471",M.callServer,void 0,M.findSourceMapURL,"uploadProjectFile"),q=(0,M.createServerReference)("400d0b446f3a38c15d257fe7d9046d0aa056070e15",M.callServer,void 0,M.findSourceMapURL,"getProjectAttachments"),_=(0,M.createServerReference)("60c92747f45f0a848c5a9d51dc879510962f79e0b1",M.callServer,void 0,M.findSourceMapURL,"deleteAttachment");var K=e.i(512845);function G({project:e}){let{data:t}=(0,K.useSession)(),[l,i]=(0,u.useState)([]),[n,d]=(0,u.useState)(!0),[c,o]=(0,u.useState)(!1),[x,h]=(0,u.useState)(!1),j=(0,u.useRef)(null),p=(0,b.useRouter)(),v=async()=>{d(!0);let s=await q(e.id);s.success&&i(s.attachments||[]),d(!1)};(0,u.useEffect)(()=>{v()},[e.id]);let N=async s=>{let t=s.target.files?.[0];if(!t)return;o(!0);let a=new FormData;a.append("file",t),a.append("projectId",e.id.toString());let r=await V(a);o(!1),r.success?(h(!1),j.current&&(j.current.value=""),p.refresh(),v()):alert(r.error||"Failed to upload file")},w=async s=>{if(!confirm("Are you sure you want to delete this file?"))return;let t=await _(s,e.id);t.success?(p.refresh(),v()):alert(t.error||"Failed to delete file")};return n?(0,s.jsx)(a.Card,{children:(0,s.jsx)(a.CardContent,{className:"pt-6",children:(0,s.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,s.jsx)(g.Loader2,{className:"h-6 w-6 animate-spin text-muted-foreground"})})})}):(0,s.jsxs)(a.Card,{children:[(0,s.jsx)(a.CardHeader,{children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(a.CardTitle,{children:"Files & Attachments"}),(0,s.jsxs)(a.CardDescription,{children:[l.length," file(s) in this project"]})]}),(0,s.jsxs)(S.Dialog,{open:x,onOpenChange:h,children:[(0,s.jsx)(S.DialogTrigger,{asChild:!0,children:(0,s.jsxs)(k.Button,{variant:"outline",children:[(0,s.jsx)(H.Upload,{className:"h-4 w-4 mr-2"}),"Upload File"]})}),(0,s.jsxs)(S.DialogContent,{children:[(0,s.jsxs)(S.DialogHeader,{children:[(0,s.jsx)(S.DialogTitle,{children:"Upload File"}),(0,s.jsx)(S.DialogDescription,{children:"Upload a file to this project. Files can be attached to tasks or kept at the project level."})]}),(0,s.jsxs)("div",{className:"space-y-4 py-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-sm font-medium",children:"Select File"}),(0,s.jsx)(y.Input,{ref:j,type:"file",onChange:N,disabled:c,className:"cursor-pointer"})]}),c&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,s.jsx)(g.Loader2,{className:"h-4 w-4 animate-spin"}),"Uploading..."]})]})]})]})]})}),(0,s.jsx)(a.CardContent,{children:0===l.length?(0,s.jsxs)("div",{className:"text-center py-12 border border-dashed rounded-lg",children:[(0,s.jsx)(E.default,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"No files attached"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:"Upload files to share documents, images, and other resources"})]}):(0,s.jsx)("div",{className:"space-y-3",children:l.map(e=>{var a,l;return(0,s.jsxs)("div",{className:"flex items-center gap-3 p-4 border rounded-lg hover:bg-muted/50 transition-colors",children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:(a=e.fileType)?a.startsWith("image/")?(0,s.jsx)(E.default,{className:"h-5 w-5 text-blue-500"}):a.includes("pdf")?(0,s.jsx)(E.default,{className:"h-5 w-5 text-red-500"}):a.includes("word")||a.includes("document")?(0,s.jsx)(E.default,{className:"h-5 w-5 text-blue-600"}):(0,s.jsx)(E.default,{className:"h-5 w-5 text-muted-foreground"}):(0,s.jsx)(E.default,{className:"h-5 w-5 text-muted-foreground"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,s.jsx)("p",{className:"font-medium truncate",children:e.fileName}),e.task&&(0,s.jsxs)(f.Badge,{variant:"outline",className:"text-xs",children:["Task: ",e.task.title]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3 text-xs text-muted-foreground",children:[(0,s.jsx)("span",{children:(l=e.fileSize)?l<1024?`${l} B`:l<1048576?`${(l/1024).toFixed(1)} KB`:`${(l/1048576).toFixed(1)} MB`:"Unknown size"}),(0,s.jsx)("span",{children:"â€¢"}),(0,s.jsx)("span",{children:(0,m.format)(new Date(e.uploadedAt),"MMM d, yyyy")}),(0,s.jsx)("span",{children:"â€¢"}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsxs)(r.Avatar,{className:"h-4 w-4",children:[(0,s.jsx)(r.AvatarImage,{src:e.uploader?.avatarUrl||void 0}),(0,s.jsx)(r.AvatarFallback,{className:"text-[8px]",children:e.uploader?.username?.substring(0,2).toUpperCase()||"??"})]}),(0,s.jsx)("span",{children:e.uploader?.username||"Unknown"})]})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(k.Button,{variant:"ghost",size:"sm",asChild:!0,children:(0,s.jsxs)("a",{href:e.fileUrl,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1",children:[(0,s.jsx)(O.Download,{className:"h-4 w-4"}),"Download"]})}),(e.uploadedById===parseInt(t?.user?.id||"0")||t?.user?.role==="admin")&&(0,s.jsx)(k.Button,{variant:"ghost",size:"sm",onClick:()=>w(e.id),className:"text-destructive hover:text-destructive",children:(0,s.jsx)(z.Trash2,{className:"h-4 w-4"})})]})]},e.id)})})})]})}function W({project:e}){let{data:t}=(0,K.useSession)(),r=t?.user.role==="admin";return(0,s.jsxs)(a.Card,{children:[(0,s.jsx)(a.CardHeader,{children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(a.CardTitle,{children:"Activity Log"}),(0,s.jsx)(a.CardDescription,{children:"All actions and changes in this project"})]}),r&&(0,s.jsxs)(k.Button,{variant:"outline",size:"sm",disabled:!0,children:[(0,s.jsx)(O.Download,{className:"h-4 w-4 mr-2"}),"Export"]})]})}),(0,s.jsx)(a.CardContent,{children:(0,s.jsx)(p,{projectId:e.id})})]})}var J=e.i(21784);function Y({project:e,stats:t}){let r=(e.tasks||[]).filter(e=>"waiting"===e.status||!!e.dependencies&&e.dependencies.length>0&&e.dependencies.some(e=>"completed"!==e.dependsOnTask.status)),l=t.total>0?t.totalComp/t.total*100:0;return(0,s.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,s.jsxs)(a.Card,{children:[(0,s.jsx)(a.CardHeader,{children:(0,s.jsxs)(a.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(x.TrendingUp,{className:"h-5 w-5"}),"Task Completion Rate"]})}),(0,s.jsx)(a.CardContent,{children:(0,s.jsx)("div",{className:"space-y-4",children:(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"text-3xl font-bold",children:[l.toFixed(1),"%"]}),(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:[t.totalComp," of ",t.total," tasks completed"]})]})})})]}),(0,s.jsxs)(a.Card,{children:[(0,s.jsx)(a.CardHeader,{children:(0,s.jsxs)(a.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(n.Clock,{className:"h-5 w-5"}),"Blocked Time Analysis"]})}),(0,s.jsx)(a.CardContent,{children:(0,s.jsx)("div",{className:"space-y-4",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-3xl font-bold",children:r.length}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Tasks currently blocked by dependencies"})]})})})]}),(0,s.jsxs)(a.Card,{className:"md:col-span-2",children:[(0,s.jsxs)(a.CardHeader,{children:[(0,s.jsxs)(a.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(J.BarChart3,{className:"h-5 w-5"}),"Project Reports"]}),(0,s.jsx)(a.CardDescription,{children:"Detailed analytics and insights"})]}),(0,s.jsx)(a.CardContent,{children:(0,s.jsxs)("div",{className:"text-center py-12 border border-dashed rounded-lg",children:[(0,s.jsx)(J.BarChart3,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Advanced reports coming soon"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:"Burn-down charts, user productivity, and dependency impact analysis"})]})})]})]})}function Q({project:e,users:a,stats:r}){let l=(0,b.useSearchParams)(),i=(0,b.useRouter)(),n=l.get("tab")||"overview";return(0,s.jsxs)(t.Tabs,{value:n,onValueChange:e=>{let s=new URLSearchParams(l.toString());s.set("tab",e),i.push(`?${s.toString()}`,{scroll:!1})},className:"space-y-6",children:[(0,s.jsxs)(t.TabsList,{className:"grid w-full grid-cols-4 lg:grid-cols-9",children:[(0,s.jsx)(t.TabsTrigger,{value:"overview",children:"Overview"}),(0,s.jsx)(t.TabsTrigger,{value:"tasks",children:"Tasks"}),(0,s.jsx)(t.TabsTrigger,{value:"board",children:"Board"}),(0,s.jsx)(t.TabsTrigger,{value:"team",children:"Team"}),(0,s.jsx)(t.TabsTrigger,{value:"todays-tasks",children:"Today's Tasks"}),(0,s.jsx)(t.TabsTrigger,{value:"files",children:"Files"}),(0,s.jsx)(t.TabsTrigger,{value:"activity",children:"Activity"}),(0,s.jsx)(t.TabsTrigger,{value:"reports",children:"Reports"})]}),(0,s.jsx)(t.TabsContent,{value:"overview",className:"space-y-6",children:(0,s.jsx)(N,{project:e,stats:r,users:a})}),(0,s.jsx)(t.TabsContent,{value:"tasks",className:"space-y-6",children:(0,s.jsx)(P,{project:e,users:a})}),(0,s.jsx)(t.TabsContent,{value:"board",className:"space-y-6",children:(0,s.jsx)(L,{project:e,users:a})}),(0,s.jsx)(t.TabsContent,{value:"team",className:"space-y-6",children:(0,s.jsx)(F,{project:e,users:a})}),(0,s.jsx)(t.TabsContent,{value:"todays-tasks",className:"space-y-6",children:(0,s.jsx)($,{project:e,users:a})}),(0,s.jsx)(t.TabsContent,{value:"files",className:"space-y-6",children:(0,s.jsx)(G,{project:e})}),(0,s.jsx)(t.TabsContent,{value:"activity",className:"space-y-6",children:(0,s.jsx)(W,{project:e})}),(0,s.jsx)(t.TabsContent,{value:"reports",className:"space-y-6",children:(0,s.jsx)(Y,{project:e,stats:r})})]})}e.s(["ProjectTabs",()=>Q],420121)},524177,e=>{"use strict";var s=e.i(696009),t=e.i(613205),a=e.i(799038),r=e.i(35490),l=e.i(956569),i=e.i(304077),n=e.i(222598),d=e.i(745999);let c=(0,d.createServerReference)("406dc0bd8d7e9cdb49e1d05a07a97ade94458c58d0",d.callServer,void 0,d.findSourceMapURL,"hasAcknowledgedUrgent");var o=e.i(181340),x=e.i(479093),m=e.i(438967),h=e.i(776574);function u({project:e,userId:d}){let u=(0,x.useRouter)(),[j,g]=(0,o.useState)(!1),[p,f]=(0,o.useState)(!1),[v,N]=(0,o.useState)(!0);(0,o.useEffect)(()=>{!async function(){g(await c(e.id)),N(!1)}()},[e.id]);let b=async()=>{f(!0);try{let s=await (0,n.acknowledgeUrgentProject)(e.id);s.success?(g(!0),u.refresh()):alert(s.error||"Failed to acknowledge")}catch(e){console.error("Error acknowledging:",e),alert("Failed to acknowledge urgent project")}finally{f(!1)}};return"urgent"!==e.priority?null:v?(0,s.jsx)(i.Card,{className:"border-red-500 bg-red-50 dark:bg-red-950/20 mb-6",children:(0,s.jsxs)("div",{className:"p-4 flex items-center gap-3",children:[(0,s.jsx)(h.Loader2,{className:"h-5 w-5 animate-spin text-red-600"}),(0,s.jsx)("span",{className:"text-sm text-red-600",children:"Checking acknowledgment status..."})]})}):(0,s.jsx)(i.Card,{className:"border-red-500 bg-red-50 dark:bg-red-950/20 mb-6 animate-pulse",children:(0,s.jsx)("div",{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,s.jsxs)("div",{className:"flex items-start gap-3 flex-1",children:[(0,s.jsx)(t.AlertTriangle,{className:"h-6 w-6 text-red-600 dark:text-red-400 flex-shrink-0 mt-0.5"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,s.jsx)(r.Badge,{variant:"destructive",className:"text-sm font-bold",children:"ðŸš¨ URGENT PROJECT"}),e.urgentMarkedAt&&(0,s.jsxs)("span",{className:"text-xs text-muted-foreground",children:["Marked ",(0,m.formatDistanceToNow)(new Date(e.urgentMarkedAt),{addSuffix:!0})]})]}),(0,s.jsx)("p",{className:"text-sm font-medium text-red-900 dark:text-red-100 mb-1",children:e.name}),e.urgentReason&&(0,s.jsxs)("p",{className:"text-sm text-red-800 dark:text-red-200 mb-2",children:[(0,s.jsx)("strong",{children:"Reason:"})," ",e.urgentReason]}),e.urgentMarkedBy&&(0,s.jsxs)("p",{className:"text-xs text-red-700 dark:text-red-300",children:["Marked urgent by: ",e.urgentMarkedBy.username]})]})]}),!j&&(0,s.jsx)(l.Button,{onClick:b,disabled:p,variant:"default",className:"bg-red-600 hover:bg-red-700 text-white flex-shrink-0",children:p?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(h.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Acknowledging..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.CheckCircle2,{className:"h-4 w-4 mr-2"}),"Acknowledge"]})}),j&&(0,s.jsxs)(r.Badge,{variant:"outline",className:"bg-green-50 text-green-700 border-green-300",children:[(0,s.jsx)(a.CheckCircle2,{className:"h-3 w-3 mr-1"}),"Acknowledged"]})]})})})}e.s(["UrgentProjectBanner",()=>u],524177)}]);